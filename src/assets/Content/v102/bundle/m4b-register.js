require=function e(i,a,n){function t(r,s){if(!a[r]){if(!i[r]){var d="function"==typeof require&&require;if(!s&&d)return d(r,!0);if(o)return o(r,!0);var l=new Error("Cannot find module '"+r+"'");throw l.code="MODULE_NOT_FOUND",l}var u=a[r]={exports:{}};i[r][0].call(u.exports,function(e){var a=i[r][1][e];return t(a?a:e)},u,u.exports,e,i,a,n)}return a[r].exports}for(var o="function"==typeof require&&require,r=0;r<n.length;r++)t(n[r]);return t}({2229:[function(e,i,a){var n=e("backbone.marionette"),t=e("../component/millennium-for-business/m4b-register/view"),o=n.LayoutView.extend({template:!1,ui:{mainWrapper:".m4b-register"},onRender:function(){this.onDestroy(),this.ui.mainWrapper.length&&(this._mainView=new t({el:this.ui.mainWrapper.get(0)}).render())},onDestroy:function(){this._mainView&&(this._mainView.destroy(),this._mainView=null)}});new o({el:jQuery(".m4b").get(0)}).render()},{"../component/millennium-for-business/m4b-register/view":1348,"backbone.marionette":6}],1348:[function(e,i,a){var n=e("underscore"),t=(e("backbone"),e("backbone.marionette")),o=e("../../ui/password/view.js"),r=(e("../../ui/date3selects/view"),e("./m4b-register-verify/view")),s=e("./model"),d=e("../../ui/validator"),l=e("../../ui/util"),u=e("../../../../config/host"),c=e("../../../../config/host"),m=e("../../ui/newlook-dropdown/view"),p=(e("../m4b-add-member/m4b-tip-bar/view"),e("swiper"),!1),f=!1,g=!1,h=/sign\-up\-mobile/i.test(window.location.href);i.exports=t.ItemView.extend({template:!1,ui:{submitButton:".m4b-active-button",passwordContainer:".passwordContainer",businessName:"[data-bind='business_name']",componyCountry:"[data-bind='company_country']",nights:"[data-bind='nights']",companyCode:"[data-bind='company_code']",corporateEmail:"[data-bind='corporate_email']",firstName:"[data-bind='first_name']",lastName:"[data-bind='last_name']",email:"[data-bind='email']",year:"select[name='yyyy']",month:"select[name='mm']",day:"select[name='dd']",title:"[data-bind='title']",gender:"[data-bind='gender']",phone:"[data-bind='phone']",secondaryphone:"[data-bind='secondaryphone']",country:"[data-bind='country']",address:"[data-bind='address']",city:"[data-bind='city']",province:"[data-bind='province']",postalCode:"[data-bind='postal_code']",group:"[data-bind='group']",affiliates:"[data-bind='affiliates']",img:"[data-feedback='img']",voice:"[data-feedback='voice']",item_img:"[data-item='img']",verifyContainer:".m4b-login-verify-container",profileHeader:".m4b-profile-verify-header",signUpHeader:".m4b-sign-up-header",socialCheckbox:"[data-bind=FG]",socialDisabled:".m4b-third-party-login-disabled",social:".m4b-third-party-login",passwordContainer:".passwordContainer"},events:{"click @ui.submitButton":"submitForm","click @ui.img":function(){this.ui.item_img.attr("src",u.getURL("api","captcha/image?r="+Math.random()))},"click @ui.voice":function(){this.IF_CLICK_AUDIO&&this.autoPlay()},"change @ui.businessName":"hideCompanyTip","change @ui.componyCountry":"hideCompanyTip","change @ui.companyCode":"hideCompanyTip","click @ui.socialCheckbox":"selectSocial","change @ui.email":"verifyEmail"},initialize:function(){this.IF_CLICK_AUDIO=!0,this.audio=new Audio},onRender:function(){var e=this;e.model=new s({pc:l.queryparam("pc")}),e.formatDataForLoginUser(),e.ui.componyCountry.closest(".field").addClass("m4b-form-company-country"),e.ui.businessName.val()&&e.ui.componyCountry.val()&&e.hideCompanyTip(),e.ui.email.val()&&e.verifyEmail()},formatDataForLoginUser:function(){var e=this;jQuery.getJSON(u.getURL("api","account/profile")).then(function(i){var a=i;a&&a.id&&(f=!0,a.first_name&&e.ui.firstName.val(a.first_name).attr("disabled",!0),a.last_name&&e.ui.lastName.val(a.last_name).attr("disabled",!0),a.email&&e.ui.email.val(a.email).attr("disabled",!0),a.birthday&&e.recoverBirthdayValue(a.birthday,!0),e.ui.passwordContainer.remove(),e.ui.signUpHeader.remove(),e.model.set("Id",a.id),jQuery(".checkbox-field").get(0).remove(),jQuery(".m4b-third-party-header").remove(),jQuery(".m4b-login-verify-container").remove(),g=!0),f||(e.passwordView=new o({el:e.ui.passwordContainer,bind:{model:e.model,attribute:"password"}}).render(),e.verifyView=new r({el:e.ui.verifyContainer}).render(),e.verifyView.on("render:form",function(i){i.Id&&(e.model.set("Id",i.Id),e.IS_FROM_3RD=!1,e.renderPersonalForm(i)),i.socialid&&i.socialchannel&&(e.model.set("socialid",i.socialid),e.model.set("socialchannel",i.socialchannel),e.IS_FROM_3RD=!0,e.renderPersonalForm(i,!1,!0))})),d.bind(e),jQuery("select").each(function(){jQuery(this).parent().append('<div class="newlook-dropdown-container"></div>'),new m({el:jQuery(this).parent().find(".newlook-dropdown-container"),page:e}).render()})})},verifyEmail:n.debounce(function(){var e=this;setTimeout(function(){if(!e.ui.email.closest(".field").hasClass("input-error")){var i=new FormData;i.append("email",e.ui.email.val()),jQuery.ajax({type:"POST",url:u.getURL("api","business/account/GetEmailIsExist"),data:i,processData:!1,contentType:!1}).then(function(i){if(i.success){g=!1;var a=e.ui.email.closest(".field");i.msg?a.find(".exist").find("span").text(i.msg):a.find(".exist").find("span").text(i18n.t("form.email_registered")),a.addClass("input-error input-exist"),a.find(".exist").show()}else{g=!0;var a=e.ui.email.closest(".field");a.removeClass("input-error input-exist"),a.find(".exist").hide()}})}})},500),verifyEmail3rd:n.debounce(function(){var e=this;setTimeout(function(){if(!e.ui.email.closest(".field").hasClass("input-error")){var i=new FormData;i.append("verify_email",e.ui.email.val()),jQuery.ajax({type:"POST",url:u.getURL("api","business/Account/GetBusinessIsExist"),data:i,processData:!1,contentType:!1}).then(function(i){if(i.State){g=!0;var a=e.ui.email.closest(".field");a.removeClass("input-error input-exist"),a.find(".exist").hide(),e.ui.email.attr("disabled",!0)}else{g=!1;var a=e.ui.email.closest(".field");a.addClass("input-error input-exist"),a.find(".exist").show()}})}})},500),pcFunction:function(){var e=this,i=window.fastTrackForm,a=e.model.get("pc");i&&(i&&"elite"==i&&(a?(e.model.validation.secondaryphone={required:!h,pattern:/^(\(?\+?[0-9]*\)?)?[0-9_\- \(\)]*$/},e.model.set("pc","OCBCMHRELTALC")):e.model.set("pc","OCBCMHRELT")),i&&"premium"==i&&(a?(e.model.validation.secondaryphone={required:!h,pattern:/^(\(?\+?[0-9]*\)?)?[0-9_\- \(\)]*$/},e.model.set("pc","OCBCMHRPRMALC")):e.model.set("pc","OCBCMHRPRM")))},selectSocial:function(){var e=this.ui.socialCheckbox.hasClass("checked");e?(this.ui.socialDisabled.hide(),this.ui.social.show()):(this.ui.socialDisabled.show(),this.ui.social.hide())},autoPlay:function(){var e=this;e.IF_CLICK_AUDIO=!1,e.audio.setAttribute("src",u.getURL("api","captcha/voice?r="+Math.random())),e.audio.load(),e.audio.play(),e.audio.oncanplay=function(){e.audio.play()},e.audio.onended=function(){e.IF_CLICK_AUDIO=!0}},renderPersonalForm:function(e,i,a){var n=this;if(g=!0,a?(n.ui.signUpHeader.remove(),jQuery(".checkbox-field").get(0).remove(),jQuery(".m4b-third-party-header").remove(),jQuery(".m4b-login-verify-container").remove(),jQuery(".m4b-profile-second-header").remove()):(f=!0,n.ui.passwordContainer.remove(),n.ui.signUpHeader.remove(),jQuery(".checkbox-field").get(0).remove(),jQuery(".m4b-third-party-header").remove(),jQuery(".m4b-login-verify-container").remove(),jQuery(".m4b-profile-second-header").remove()),e.FirstName&&(/^[A-Za-z\d,_\u00C0-\u00ff\ \-\'\`]+$/.test(e.FirstName)?this.ui.firstName.val(e.FirstName).trigger("change").attr("disabled",!0):this.ui.firstName.val(e.FirstName).trigger("change")),e.LastName&&(/^[A-Za-z\d,_\u00C0-\u00ff\ \-\'\`]+$/.test(e.LastName)?this.ui.lastName.val(e.LastName).trigger("change").attr("disabled",!0):this.ui.lastName.val(e.LastName).trigger("change")),e.Birthday&&this.recoverBirthdayValue(e.Birthday),e.Email)if(a){var t=n.ui.email.closest(".field");this.ui.email.val(e.Email),this.verifyEmail3rd()}else{this.ui.email.val(e.Email).attr("disabled",!0);var t=n.ui.email.closest(".field");t.removeClass("input-error input-exist"),t.find(".exist").hide()}e.CommunicationPreference&&"true"==e.CommunicationPreference.split("|")[0]&&this.ui.group.addClass("checked"),e.CommunicationPreference&&"true"==e.CommunicationPreference.split("|")[1]&&this.ui.affiliates.addClass("checked"),i||jQuery("html,body").animate({scrollTop:n.ui.firstName.offset().top-150},500)},recoverBirthdayValue:function(e,i){var a=e.split(""),t=[],o=[],r=[];i?n.each(a,function(e,i){6!=i&&7!=i&&8!=i&&9!=i||t.push(e),3!=i&&4!=i||o.push(e),0!=i&&1!=i||r.push(e)}):n.each(a,function(e,i){0!=i&&1!=i&&2!=i&&3!=i||t.push(e),5!=i&&6!=i||o.push(e),8!=i&&9!=i||r.push(e)}),this.ui.year.val(t.join("")).trigger("change").attr("disabled",!0).show().siblings(".newlook-dropdown-container").hide(),this.ui.month.val(o.join("")).trigger("change").attr("disabled",!0).show().siblings(".newlook-dropdown-container").hide(),this.ui.day.val(r.join("")).trigger("change").attr("disabled",!0).show().siblings(".newlook-dropdown-container").hide()},recoverGender:function(e){var i=this;1!==e.Gender&&"Male"!==e.Gender||i.ui.gender.val("Male").trigger("change"),2!==e.Gender&&"Female"!==e.Gender||i.ui.gender.val("Female").trigger("change")},verifyCompanyInline:n.debounce(function(){var e=this;e.ui.businessName.val()&&e.ui.componyCountry.val()&&jQuery.post(u.getURL("api","business/Account/CheckBusiness"),{business_name:e.ui.businessName.val(),company_country:e.ui.componyCountry.val(),company_code:e.ui.companyCode.val()}).then(function(i){i.success||e.ui.businessName.closest(".field").find(".already").show()})},500),verifyCompany:function(){var e=this,i=e.ui.businessName.val(),a=e.ui.componyCountry.val();""!=i&&""!=a?l.loading({container:e.el,errortimeout:5e3,promise:jQuery.getJSON(u.getURL("api","business/account/getcompanyinfo"),{businessname:i,country:a}).then(function(i){i.exist?(i.data.nightsnumber&&e.ui.nights.val(i.data.nightsnumber).trigger("change"),i.data.companycode&&e.ui.companyCode.val(i.data.companycode),i.data.email&&e.ui.corporateEmail.val(i.data.email),e.ui.componyCountry.closest(".field").find(".already").show()):e.ui.componyCountry.closest(".field").find(".already").hide()})}):e.ui.componyCountry.closest(".field").find(".already").hide()},hideCompanyTip:function(){this.ui.businessName.closest(".field").find(".already").hide(),this.verifyCompanyInline()},submitForm:function(e){var i=this,a=jQuery(e.currentTarget);if(!a.hasClass("disabled")){f?i.model.set("password","1"):i.passwordView.validate(),i.trigger("save:form"),i.pcFunction();var n=i.model.isValid(!0);i.model.set("birthday",i.model.get("birthday").replace(/undefined/g,"01")),n&&g?(a.addClass("disabled"),i.model.unset("verify_email"),i.model.unset("verify_password"),i.IS_FROM_3RD?i.model.unset("Id"):(i.model.unset("socialid"),i.model.unset("socialchannel")),f?(i.model.unset("password"),i.model.validation.password.required=!1):(i.model.set("Id",""),i.model.unset("FG")),l.loading({container:i.el,errortimeout:5e3,forM4BInline:!1,promise:i.model.save({},{emulateJSON:!0,emulateForm:!0,success:function(e,n){if(h)i.googleTagTrack();else if(n&&n.code)i.ui.businessName.closest(".field").find(".already").show(),jQuery("html,body").animate({scrollTop:jQuery(".m4b-section-header").offset().top},600),a.removeClass("disabled"),i.model.validation.password.required=!0;else if(n.success){i.googleTagTrack();var t=l.queryparam();l.redirect(t.redirect||n.url||"/"+c.getLanguage()+"/business/")}else{var o=i18n.t("signup.email_registered_msg");n.message&&(o=n.message);var r="<p><span class='sg_msg'></span></p>";jQuery(".loading-error-block").html(r),jQuery(".sg_msg").html(o),a.removeClass("disabled"),i.model.validation.password.required=!0}},error:function(e,n){var t=i18n.t("signup.email_registered_msg");n.responseJSON[0]&&n.responseJSON[0].msg&&(t=n.responseJSON[0].msg);var o="<p><span class='sg_msg'></span></p>";jQuery(".loading-error-block").html(o),jQuery(".sg_msg").html(t),a.removeClass("disabled"),i.model.validation.password.required=!0}})})):jQuery(".input-error").length&&jQuery(".input-exist").length?jQuery("html,body").animate({scrollTop:Math.min(jQuery(".input-error").eq(0).offset().top,jQuery(".input-exist").eq(0).offset().top)-70},600):jQuery(".input-error").length&&!jQuery(".input-exist").length?jQuery("html,body").animate({scrollTop:jQuery(".input-error").eq(0).offset().top-70},600):!jQuery(".input-error").length&&jQuery(".input-exist").length&&jQuery("html,body").animate({scrollTop:jQuery(".input-exist").eq(0).offset().top-70},600)}},activesubmitButton:function(){var e=this;p||(e.ui.submitButton.removeClass("disabled"),p=!0)},googleTagTrack:function(){gtag("event","conversion",{allow_custom_scripts:!0,send_to:"DC-4867025/websi000/signu123+unique"})}})},{"../../../../config/host":45,"../../ui/date3selects/view":2071,"../../ui/newlook-dropdown/view":2100,"../../ui/password/view.js":2108,"../../ui/util":2122,"../../ui/validator":2123,"../m4b-add-member/m4b-tip-bar/view":1226,"./m4b-register-verify/view":1346,"./model":1347,backbone:8,"backbone.marionette":6,swiper:40,underscore:42}],1347:[function(e,i,a){var n=(e("underscore"),e("backbone")),t=e("../../../../config/host.js"),o=e("../../ui/validator"),r=o.latinRegex3,s=o.latinRegex4,d=o.latinRegex5,l=o.latinRegex6;o.patterns.keyboard,o.latinNumericsSymbols,o.alphaNumerics2,/sign\-up\-mobile/i.test(window.location.href),i.exports=n.Model.extend({url:t.getURL("api","business/account/companysignup"),defaults:{},initialize:function(){},validation:{business_name:{required:!0,pattern:l,maxLength:50},company_country:{required:!0},corporate_email:{required:!1,pattern:"email"},representative:{required:!1,pattern:l,maxLength:50},company_code:{required:!1,pattern:s},password:{required:!0},email:{required:!0,pattern:"email"},postal_code:{required:!1,pattern:d,maxLength:32},first_name:{required:!0,pattern:r,maxLength:254},last_name:{required:!0,pattern:r,maxLength:254},tick:{required:!0},birthday:function(e){return o.validators.date(e,18,!0)},pc:{required:!1},captcha:{required:!0}}})},{"../../../../config/host.js":45,"../../ui/validator":2123,backbone:8,underscore:42}],1346:[function(e,i,a){var n=(e("underscore"),e("backbone"),e("backbone.marionette")),t=e("../../../ui/password/view.js"),o=e("./model"),r=e("../../../ui/validator"),s=e("../../../ui/util"),d=e("../../../../../config/host");e("./mock.json"),i.exports=n.ItemView.extend({template:!1,ui:{verifyButton:".m4b-login-verify-button",verifyEmail:'[data-bind="verify_email"]',verifyPasswordContainer:".verifyPasswordContainer",inputField:"input",fbLoginButton:".m4b-fb-login",linkedinLoginButton:".m4b-linkedin-login"},events:{"click @ui.verifyButton":"verifyForm","click @ui.img":function(){this.ui.item_img.attr("src",d.getURL("api","captcha/image?r="+Math.random()))},"keyup @ui.inputField":"activeVerifyButton","click @ui.fbLoginButton":function(e){e.preventDefault(),this.googleTagTrack(),window.fblogin()},"click @ui.linkedinLoginButton":function(e){e.preventDefault(),this.googleTagTrack(),this.linkedInLogin()}},initialize:function(){this.IS_BUTTON_ACTIVE=!1},onRender:function(){var e=this;e.model=new o,e.passwordView=new t({el:e.ui.verifyPasswordContainer,bind:{model:e.model,attribute:"verify_password"}}).render(),r.bind(this),e.initGlobalFunction(),jQuery(".m4b-google-login").on("click",e.googleTagTrack),function(e,i,a){var n,t=e.getElementsByTagName(i)[0];e.getElementById(a)||(n=e.createElement(i),n.id=a,n.src="https://connect.facebook.net/en_US/sdk.js",t.parentNode.insertBefore(n,t))}(document,"script","facebook-jssdk"),function(i,a){var n,t=i.getElementsByTagName(a)[0];n=i.createElement(a),n.src="https://apis.google.com/js/api:client.js",n.onload=n.onreadystatechange=function(){this.readyState&&"loaded"!==this.readyState&&"complete"!==this.readyState||(e.startGoogleApp(),n.onload=n.onreadystatechange=null)},t.parentNode.insertBefore(n,t)}(document,"script")},activeVerifyButton:function(){var e=this,i=!0;e.IS_BUTTON_ACTIVE?(e.$el.find("input").each(function(e,a){""!=jQuery(a).val()&&(i=!1)}),i&&(e.ui.verifyButton.addClass("disabled"),e.IS_BUTTON_ACTIVE=!1)):e.$el.find("input").each(function(i,a){return""!=jQuery(a).val()?(e.ui.verifyButton.removeClass("disabled"),void(e.IS_BUTTON_ACTIVE=!0)):void 0})},verifyForm:function(e){var i=this,a=jQuery(e.currentTarget);if(!a.hasClass("disabled")){i.passwordView.validate(),i.trigger("save:form");var n=i.model.isValid(!0);n&&(a.addClass("disabled"),i.IS_BUTTON_ACTIVE=!1,s.loading({container:jQuery(".m4b-register"),errortimeout:5e3,forM4BInline:!0,promise:i.model.save({},{emulateJSON:!0,emulateForm:!0,success:function(e,n){n.success?(a.removeClass("disabled"),i.IS_BUTTON_ACTIVE=!0,i.trigger("render:form",n.profile)):(a.removeClass("disabled"),i.IS_BUTTON_ACTIVE=!0,jQuery(".m4b-login-verify-container").find(".field").addClass("input-error"),jQuery(".verifyPasswordContainer").find(".notice").show(),jQuery(".verifyPasswordContainer").find(".notice").find("span").text(n.Info))},error:function(e,n){a.removeClass("disabled"),i.IS_BUTTON_ACTIVE=!0}})}))}},initGlobalFunction:function(){var e=this;window.fblogin=function(){FB.login(window.fbstatusChangeCallback,{scope:"public_profile,email,user_likes,user_friends"})},window.fbstatusChangeCallback=function(i){"connected"==i.status&&FB.api("/me",{fields:"first_name,last_name,email,gender"},function(i){var a={FirstName:i.first_name||"",LastName:i.last_name||"",Email:i.email||"",Gender:i.gender||"",socialid:i.id||"",socialchannel:"facebook"};e.trigger("render:form",a)})},window.fbAsyncInit=function(){FB.init({appId:window.fbid||"",cookie:!0,xfbml:!0,version:"v2.12",status:!1}),FB.AppEvents.logPageView()},window.linkedInLoginaa=function(){IN.API.Raw("/people/~:(id,firstName,lastName,email-address,headline)?format=json").result(function(i){var a={FirstName:i.firstName||"",LastName:i.lastName||"",Email:i.emailAddress||"",socialid:i.id||"",socialchannel:"linkedin"};e.trigger("render:form",a)}).error(function(e){})}},startGoogleApp:function(){var e=this;window.gapi&&gapi.load("auth2",function(){auth2=gapi.auth2.init({client_id:window.googleid||"",cookiepolicy:"single_host_origin"}),e.googleattachSignin(document.getElementsByClassName("m4b-google-login")[0])})},googleattachSignin:function(e){var i=this;auth2.attachClickHandler(e,{},function(e){var a=e.getBasicProfile(),n={FirstName:a.getGivenName(),LastName:a.getFamilyName(),Email:a.getEmail(),socialid:a.getId(),socialchannel:"googleplus"};i.trigger("render:form",n)},function(e){})},linkedInLogin:function(){IN.User.authorize(window.linkedInLoginaa,{r_emailaddress:"email-address"})},googleTagTrack:function(){gtag("event","conversion",{allow_custom_scripts:!0,send_to:"DC-4867025/websi000/signu123+unique"})}})},{"../../../../../config/host":45,"../../../ui/password/view.js":2108,"../../../ui/util":2122,"../../../ui/validator":2123,"./mock.json":1344,"./model":1345,backbone:8,"backbone.marionette":6,underscore:42}],1345:[function(e,i,a){var n=(e("underscore"),e("backbone")),t=(e("../../../ui/validator.js"),e("../../../../../config/host"));i.exports=n.Model.extend({url:t.getURL("api","business/account/getuserinfo"),validation:{verify_email:{required:!0,pattern:"email"},verify_password:{required:!0}}})},{"../../../../../config/host":45,"../../../ui/validator.js":2123,backbone:8,underscore:42}],1344:[function(e,i,a){i.exports={success:!0,profile:{Id:"0a9bd273-d92b-487c-aca9-893c43ddeb39",HashPassword:null,Email:"zhangzhiweikkw@sina.com",Title:"Mr",FirstName:"zhang",LastName:"we",Phone:"18202899446",SecondaryPhone:"02345583026",Gender:1,Birthday:"1987-02-03T00:00:00",CountryResidence:"China",PostalCode:"100010",Province:null,City:"chongqi",Address:"fsajfkasfaks",FacebookAccount:null,GooglePlusAccount:null,DefaultPrimaryGuest:null,MembershipNo:"2018060700000001",AAMemberNo:null,CurrencyPreference:null,LanguagePreference:"en",CommunicationPreference:"111111",StayPreferce:"",Interests:"",Destinations:"",CreateDate:"2018-06-07T15:50:00.22",LastLoginTime:"2018-06-11T17:53:36.1",Tier:"Club",TotalPoints:0,ExpiredPoints:0,RedeemedPoints:0,PointsExpiringNext3Months:0,BasePoints:0,RoomNightsUpgrade:0,BonusPoints:0,TransferredPoints:0,PointsBalance:0,IsCompletedProfile:!1,DisplayDateFormat:null,AllowEmail:!1,LoginErrorTimes:null,LastErrorTime:null,Flag:0,HotelId:0}}},{}]},{},[2229]);