require=function e(t,n,o){function i(r,s){if(!n[r]){if(!t[r]){var l="function"==typeof require&&require;if(!s&&l)return l(r,!0);if(a)return a(r,!0);var c=new Error("Cannot find module '"+r+"'");throw c.code="MODULE_NOT_FOUND",c}var u=n[r]={exports:{}};t[r][0].call(u.exports,function(e){var n=t[r][1][e];return i(n?n:e)},u,u.exports,e,t,n,o)}return n[r].exports}for(var a="function"==typeof require&&require,r=0;r<o.length;r++)i(o[r]);return i}({2235:[function(e,t,n){function o(e){var t=r(B,F,e,"normal",{attr:!0,zoom:!0,exit:!0,mask:!y});t.on("exit:click",function(){B.empty(),V.empty(),i(e),U.tracker.trigger("change:scrolltop")})}function i(e){var t=r(V,I,e,"narrow",{card:!0,full:!0,mask:!y});t.on("full:click",function(){y=!0,B.empty(),V.empty(),U.ismobile()?a(e):(o(e),jQuery(window).scrollTop(F.offset().top))})}function a(e){var t=r(B,F,e,"mobile",{attr:!0,exit:!0,mask:!y});t.on("exit:click",function(){B.empty(),V.empty(),i(e)})}function r(e,t,n,o,a){var r=t.data("destinationid"),d=n.destinations.get(r);if(void 0!=d){var g,f=n.locations.get(d.get("locationid")),F=m(n,d,d),I=new p({map:!a.mask,blog:!0,card:a.card,attr:a.attr,zoom:a.zoom&&!a.mask,full:a.full,exit:a.exit,mask:a.mask,className:"mh-maps-section mh-maps-section-"+o}),x=n.destinations.children(f.id),B=d.getNeighborhood(),V=B.then(function(e){return I.mapView&&I.mapView.setRegion(e.getRegion())}),j=V.then(function(){return n.attractions.where({locationid:f.get("id")})}),T=j.then(function(e){return n.categories.figure(e.map(function(e){return e.get("category")}))}),E=j.then(function(e){return I.mapView&&I.mapView.pushMarker(e.map(F.createScenicMarkerOptions,F))});if(g="narrow"==o?E.then(function(){return I.mapView&&I.mapView.pushMarker([d].map(F.createTavernMarkerOptions,F))}):E.then(function(){return I.mapView&&I.mapView.pushMarker(x.map(F.createTavernMarkerOptions,F))}),jQuery.when(B,g).then(function(e){I.mapView&&I.mapView.setConst(d),I.mapView&&I.mapView.setActive(d);var t=e.getRegion();"narrow"!=o&&t.zoom?(I.mapView&&I.mapView.setCenter(t.center),I.mapView&&I.mapView.setZoom(t.zoom)):I.mapView&&I.mapView.fitBounds({center:t.center}),I.on("icon:hover",function(e){I.mapView&&I.mapView.setActive(e),I.mapView&&I.mapView.openWindow(F.createTavernWindowOptions(e))})}),I.cardView&&jQuery.when(j).then(function(e){var t=[d].concat(e);I.cardView.setCount(t.length),I.cardView.business(t[0]),I.cardView.on("card:change",function(e){I.mapView?(I.mapView.setActive(t[e]),I.cardView.business(t[e])):setTimeout(function(){y=!0,i(n)})}),I.cardView.once("ui:completed",function(){U.tracker.trigger("change:scrolltop")})}),I.attrView&&jQuery.when(B,T).then(function(e,t){"narrow"!=o&&I.attrView.showInfo(F.createNearbyView(e)),I.attrView.showArea(F.createAreaView(t)),I.on("info:close",function(){I.attrView.showInfo(F.createNearbyView(e))}),I.on("icon:click",function(e){I.attrView.showInfo(F.createTavernView(e))})}),I.fullView&&I.fullView.setLabel(i18n.t("normal"==o?"general.explore":"maps.view_map")),C&&(C.empty(),C.show(new b({HashTag:k.data("mediaid"),Layout:k.data("layout")}))),L&&(L.empty(),jQuery.when(j).then(function(e){var t=e.filter(function(e){return e.get("isevent")});if(t.length<2)return void jQuery(L.el).prev(".wgt-block-title").hide();var n=new u.Model;t=c.sortBy(t,function(e){return e.get("st_date")}),t.length>=3?(n.set("__ONE",t[0]),n.set("__TWO",t[1]),n.set("__THR",t[2])):(n.set("__TWO",t[0]),n.set("__THR",t[1])),n.set("__OS_ID",r),L.show(new h({model:n})),Q.autoCreate(),v.autoCreate()})),A&&(A.empty(),jQuery.when(V).then(function(e){return c.sortBy(n.destinations.filter(function(t){return e.contains({lat:t.get("lat"),lng:t.get("lng")})}),function(e){return d===e?0:l(e,d)+1})}).then(function(e){var t=new u.Model;e.length%2==1&&t.set("__ONE",e.shift());var n=[];if(e.length>=2)for(var o=0;o<e.length;o+=2)n.push([e[o],e[o+1]]);t.set("__SIM",n),A.show(new w({model:t})),Q.autoCreate(),v.autoCreate()})),M.length){var Z={},N=M.find(".hotel-lightup b,.hotel-lightup strong");c.extend(Z,u.Events),N.unbind("mouseenter").bind("mouseenter",function(e){var t=jQuery(e.currentTarget),o=t.parent(),i=o.find(".mh-maps-light-window");0==i.length&&(i=jQuery('<div class="mh-maps-light-window"></div>'),o.append(i));var a=n.destinations.get((t.data("destinationid")||"").toLowerCase());void 0!=a&&(clearTimeout(Z.timeout),Z.stopListening(),i.empty(),U.ismobile()||s(i,F,Z,a))}),N.unbind("mouseleave").bind("mouseleave",function(){Z.trigger("mouseleave")})}return e.show(I),I}}function s(e,t,n,o){var i=t.createBesideView(o);n.on("mouseleave",function(){clearTimeout(n.timeout),n.holding||(timeout=setTimeout(function(){i.destroy()},1e3))}),e.unbind("mouseenter").bind("mouseenter",function(){n.holding=!0,clearTimeout(n.timeout)}),e.unbind("mouseleave").bind("mouseleave",function(){n.holding=!1,clearTimeout(n.timeout),i.destroy()}),e.append(i.render().$el)}function l(e,t){return Math.sqrt(Math.pow(e.get("lat")-t.get("lat"),2)+Math.pow(e.get("lng")-t.get("lng"),2))}var c=e("underscore"),u=e("backbone"),d=e("backbone.marionette"),g=e("../component/maps/DAO"),m=e("../component/maps/options"),p=e("../component/maps/view"),h=e("../component/attraction/view"),w=e("../component/neighborhood/view"),f=e("../component/maps-blog/view"),Q=e("../component/ui/scratchpad-item/view"),v=e("../component/share-item/view"),U=e("../component/ui/util"),b=e("../component/instagram-module/carousel/view/view"),F=jQuery(".maps-shown-wrapper"),I=jQuery(".attr-detail-mypanel"),x=!(!F.length||!I.length);if(x)var B=new d.Region({el:F}),V=new d.Region({el:I});var y=!window.mapLazyLoadStaticImageUrl;e("sassify")(".maps-static-image-inlet{display:none;}");var C,L,A,M=jQuery(".attr-detail-details-section"),k=jQuery(".J-ins-carousel"),j=jQuery(".feature-content"),T=jQuery(".feature-content").attr("data-blog-id");j.length&&(f=new f({el:j,featureId:T}).render()),x?jQuery.when(g).then(function(e){k.length&&(C=new d.Region({el:k}));var t=jQuery(".attraction-event-module-panel");t.length&&(L=new d.Region({el:t}));var n=jQuery(".neighborhoods-hotels-wrapper");n.length&&(A=new d.Region({el:n}));var o=0;U.tracker.on("change:scrolltop",function(){var e=jQuery(".mh-maps-section-narrow"),t=jQuery(".tpl-attr-text-blogposting");if(!U.ismobile()&&0!=e.length&&0!=t.length){e.finish();var n=U.tracker.previous("scrolltop"),i=U.tracker.get("scrolltop"),a=i-n,r=jQuery(window).height(),s=e.height(),l=e.offset().top,c=t.offset().top,u=t.height()+c;r-187>s?(o=(r-187-s)/2+i-(l-o)+107,o=Math.max(0,Math.min(o,u-c-s)),e.animate({"margin-top":o+"px"},300)):a>0?r+i-100>l+s&&(o=r+i-100-s-(l-o),o=Math.max(0,Math.min(o,u-c-s)),e.animate({"margin-top":o+"px"},300)):l>i+127&&(o=i+127-(l-o),o=Math.max(0,Math.min(o,u-c-s)),e.animate({"margin-top":o+"px"},300))}});var a=-1;jQuery(window).resize(function(){clearTimeout(a),a=setTimeout(function(){U.tracker.trigger("change:scrolltop")},150)}),U.tracker.on("change:mobile",function(){B.empty(),V.empty(),i(e)}).trigger("change:mobile")}):k.length&&new d.Region({el:k}).show(new b({HashTag:k.data("mediaid"),Layout:k.data("layout")}))},{"../component/attraction/view":160,"../component/instagram-module/carousel/view/view":1068,"../component/maps-blog/view":1113,"../component/maps/DAO":1114,"../component/maps/options":1163,"../component/maps/view":1169,"../component/neighborhood/view":1405,"../component/share-item/view":1940,"../component/ui/scratchpad-item/view":2113,"../component/ui/util":2122,backbone:8,"backbone.marionette":6,sassify:36,underscore:42}],1113:[function(e,t,n){var o=(e("underscore"),e("backbone.marionette")),i=e("backbone"),a=e("./template.hbs"),r=e("./modle");e("./style.sass"),t.exports=o.LayoutView.extend({ui:{loadMore:".loadMore",list:".list"},events:{"click .loadMore span":"loadMore"},template:function(e){return Handlebars.compile(a)(e)},initialize:function(e){var t=this;t.index=0,t.allData=new r({id:e.featureId}),t.isLoad=!0,t.$el.hide(),t.allData.fetch().then(function(e){t.data=e,t.$el.show();var n=!1;if(e.length>2)var o=e.slice(t.index,t.index+2);else{var o=e;switch(t.isLoad=!1,e.length){case 1:o[0].isone=!0,n=!0;break;case 0:t.remove()}}t.model=new i.Model({data:o,onlyOne:n}),t.render()})},onRender:function(){this.isLoad||this.ui.loadMore.hide()},loadMore:function(){var e=this;e.index+=2;var t=e.data.slice(e.index,e.index+2);1==t.length?(t[0].isone=!0,e.isLoad=!1):e.index+2==e.data.length&&(e.isLoad=!1),e.model.set("data",e.model.get("data").concat(t)),e.render()}})},{"./modle":1110,"./style.sass":1111,"./template.hbs":1112,backbone:8,"backbone.marionette":6,underscore:42}],1112:[function(e,t,n){t.exports='<div class="wgt-block-title"><h3>{{#if onlyOne}}{{local "Blogs.featured_hotel"}}{{else}}{{local "Blogs.featured_hotels"}}{{/if}}</h3></div>\r\n<div class="list">\r\n{{#each data}}\r\n    <div style="background-image: url(\'{{bgImage}}\')" class="tpl-half-scratchpad clearfix {{#if isone}}tpl-one-half-scratchpad{{/if}}">\r\n        <div class="tpl-content">\r\n            <div class="wgt-icon">\r\n                <span class="icon-icon_B002"></span>\r\n                <label>{{local "scratchpad.hotels"}}</label>\r\n            </div>\r\n            <div class="tpl-text">\r\n                <h3>{{name}}</h3>\r\n            </div>\r\n            <div class="tpl-cta">\r\n                <a class="wgt-sqbutton" href="{{url}}"> {{local "general.explore"}} </a>\r\n            </div>\r\n        </div>\r\n        <div class="tpl-holder"></div>\r\n    </div>\r\n{{/each}}\r\n</div>\r\n<div class="loadMore"><span>{{local "Blogs.Load_More"}}</span></div>'},{}],1111:[function(e,t,n){t.exports=e("sassify")(".list {   font-size: 0; }  .tpl-one-half-scratchpad {   width: 100% !important; }   .tpl-one-half-scratchpad .tpl-holder {     margin-top: 31% !important; }  div.loadMore {   height: 11.6rem;   line-height: 11.6rem;   width: 100%;   background-color: #E7E7E7;   text-align: center; }   div.loadMore span {     display: inline-block;     color: #363636;     font-size: 1.4rem;     width: 22.6rem;     text-align: center;     height: 5rem;     line-height: 5rem;     border: 2px solid #363636;     cursor: pointer;     text-transform: uppercase; }     div.loadMore span:hover {       background: #363636;       color: #ffffff; }  ")},{sassify:36}],1110:[function(e,t,n){var o=e("backbone"),i=e("../../../config/host.js");t.exports=o.Model.extend({url:function(){var e=i.getURL("api","blog/BlogFeaturedHotels");return e+="/?blogid="+this.get("id")}})},{"../../../config/host.js":45,backbone:8}]},{},[2235]);