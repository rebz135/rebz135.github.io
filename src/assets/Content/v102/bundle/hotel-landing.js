require=function e(i,t,n){function o(r,s){if(!t[r]){if(!i[r]){var c="function"==typeof require&&require;if(!s&&c)return c(r,!0);if(a)return a(r,!0);var l=new Error("Cannot find module '"+r+"'");throw l.code="MODULE_NOT_FOUND",l}var u=t[r]={exports:{}};i[r][0].call(u.exports,function(e){var t=i[r][1][e];return o(t?t:e)},u,u.exports,e,i,t,n)}return t[r].exports}for(var a="function"==typeof require&&require,r=0;r<n.length;r++)o(n[r]);return o}({2202:[function(e,i,t){var n=e("../component/layout/default-page-layout.js"),o=e("../component/destination/list/view"),a=e("../component/destination/models/DAO"),r=e("../component/ui/util"),s=e("../component/ui/grayscale"),c=e("underscore");DesktopPage=n.extend({ui:{listView:".list-view",listContainer:".list-container",searchContent:"#search",regionTap:".region-tap li .item",regionCheck:".region-tap li",selectBox:".select-box"},events:{"keyup #search":"searchHotel","click @ui.regionTap":"searchTap","change @ui.selectBox":"searchTap"},initialize:function(){this.regionName=""},__searchHotel:function(){var i=this,t=i.ui.searchContent.val();if(""==t&&"all"==i.regionName||""==t&&""==i.regionName)return this.onRender(),!1;if(t&&"all"!=i.regionName){var n=i.ui.regionTap.first();i.regionName=n.attr("data-regionName"),i.ui.regionTap.removeClass("selected"),n.addClass("selected")}i.listView=new o({template:Handlebars.compile(e("../component/destination/list/searchTemplate.hbs")),el:this.ui.listView,search:!0,searchMsg:t,regionName:i.regionName}),r.loading({container:i.ui.listView,promise:i.listView.model.fetch().then(function(e){var t=e.data;c.each(t.citys,function(e){var i=[];c.each(t.hotels,function(t){t.parentid==e.id&&i.push(t)}),e.hotel=i}),c.each(t.contrys,function(e){var i=[];if("singapore"===e.key?(c.each(t.hotels,function(t){t.parentid==e.id&&i.push(t)}),e.city=[],e.city[0]={},e.city[0].hotel=i):(c.each(t.citys,function(t){t.parentid==e.id&&i.push(t)}),e.city=i),"china"===e.key){var n=c.findIndex(i,function(e){return"hong-kong"===e.key});n>0&&i.push(i.splice(n,1)[0])}if("china"===e.key){var o=c.findIndex(i,function(e){return"taichung"===e.key});o>0&&i.push(i.splice(o,1)[0])}if("china"===e.key){var a=c.findIndex(i,function(e){return"hualien"===e.key});a>0&&i.push(i.splice(a,1)[0])}}),i.listView.model.set("country",t.contrys),i.listView.render()})})},searchHotel:c.debounce(function(){var e=this;e.__searchHotel()},500),onRender:function(){var e=this;e.listView=new o({el:this.ui.listView,isForHotels:!1,isTop:!0}),jQuery(".subview-container").find(".loading-container").remove(),a.promise.then(function(){e.listView.model.setValue(a.locations,a.destinations),e.listView.model.set("showButton",!1),e.listView.model.set("forHotelsPage",!1),e.ui.listView.show(),e.listView.render(),e.search_location=a.locations,e.search_destinations=a.destinations,r.ismobile()?e.regionName=e.ui.selectBox.children("option:selected").attr("data-regionName"):e.regionName=e.ui.regionCheck.find(".selected").attr("data-regionName"),"all"!=e.regionName&&e.__searchHotel(e.regionName)}),s.grayscale(jQuery(".grayimg")),jQuery(window).resize(function(){s.grayscale(jQuery(".grayimg"))})},searchTap:function(e){var i=this;if(r.ismobile())i.regionName=i.ui.selectBox.children("option:selected").attr("data-regionName");else{var t=jQuery(e.target);i.regionName=t.attr("data-regionName"),i.ui.regionTap.removeClass("selected"),t.addClass("selected");var n=i.ui.searchContent.val();n&&"all"!=i.regionName&&i.ui.searchContent.val("")}""==i.regionName&&i.ui.searchContent.val(""),i.__searchHotel(i.regionName)}}),new DesktopPage({el:jQuery(".global-wrapper")}).render()},{"../component/destination/list/searchTemplate.hbs":792,"../component/destination/list/view":794,"../component/destination/models/DAO":809,"../component/layout/default-page-layout.js":1082,"../component/ui/grayscale":2092,"../component/ui/util":2122,underscore:42}]},{},[2202]);