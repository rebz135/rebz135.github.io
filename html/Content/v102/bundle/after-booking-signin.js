require=function e(r,t,o){function n(a,u){if(!t[a]){if(!r[a]){var c="function"==typeof require&&require;if(!u&&c)return c(a,!0);if(i)return i(a,!0);var s=new Error("Cannot find module '"+a+"'");throw s.code="MODULE_NOT_FOUND",s}var d=t[a]={exports:{}};r[a][0].call(d.exports,function(e){var t=r[a][1][e];return n(t?t:e)},d,d.exports,e,r,t,o)}return t[a].exports}for(var i="function"==typeof require&&require,a=0;a<o.length;a++)n(o[a]);return n}({2165:[function(e,r,t){var o=e("underscore"),n=(e("backbone.marionette"),e("../component/ui/validator.js")),i=(e("../component/ui/password/view.js"),e("../component/after-booking/user.js")),a=e("../../config/host.js"),u=e("../component/ui/util"),c=e("../component/layout/default-page-layout.js"),s=c.extend({events:{"click .after-booking-sign":"onSubmitClicked","focus [data-bind]":"onInputBlur","click @ui.img":function(){var e=a.getURL("api","captcha/image?r="+Math.random());jQuery(".code-bottom .captcha-img").each(function(r,t){jQuery(t).attr("src",e)})},"click @ui.voice":function(){this.IF_CLICK_AUDIO&&this.autoPlay()}},ui:{mainWrapper:".main-wrapper",errorResponse:"span.error-msg",afterBookingSign:".after-booking-sign",img:"[data-feedback='img']",voice:"[data-feedback='voice']",item_img:"[data-item='img']"},initialize:function(e){var r=this;r.model=new i,r.IF_CLICK_AUDIO=!0,r.audio=new Audio,r.model.set("number",r.getQueryParam("number")),r.model.set("ve",r.getQueryParam("ve")),r.model.set("user",r.getQueryParam("user")),n.bind(r)},autoPlay:function(){var e=this;e.IF_CLICK_AUDIO=!1,e.audio.setAttribute("src",a.getURL("api","captcha/voice?r="+Math.random())),e.audio.load(),e.audio.play(),e.audio.oncanplay=function(){e.audio.play()},e.audio.onended=function(){e.IF_CLICK_AUDIO=!0}},getQueryParam:function(e){var r=window.location.search.substr(1).split("&"),t=o.find(r,function(r){return r.split(e+"=").length>1});return t&&t.split(e+"=")[1]},onInputBlur:function(){this.ui.errorResponse.html("")},onSubmitClicked:function(){var e=this;return e.ui.afterBookingSign.hasClass("disabled")?!1:(e.trigger("save:form"),e.model.isValid(!0)?void u.loading({errortimeout:3e3,container:e.el,promise:e.model.save({},{emulateForm:!0,emulateJSON:!0,success:function(r,t){var o=t.other&&t.other.url?t.other.url:null,n=i18n.t("login.re_activate_account").replace("{0}",o);if(t.success){var i=e.getQueryParam("returnUrl")?decodeURIComponent(e.getQueryParam("returnUrl")):a.getURL("/");u.redirect(t.data.url||i)}else{3==t.status?(e.ui.errorResponse.html(n),e.ui.afterBookingSign.addClass("disabled")):(e.ui.errorResponse.html(t.message),e.ui.afterBookingSign.removeClass("disabled"));var c=a.getURL("api","captcha/image?r="+Math.random());jQuery(".code-bottom .captcha-img").each(function(e,r){jQuery(r).attr("src",c)})}},error:function(r,t){e.ui.errorResponse.html(o.pluck(t.responseJSON,"msg").join("<hr>"));var n=a.getURL("api","captcha/image?r="+Math.random());jQuery(".code-bottom .captcha-img").each(function(e,r){jQuery(r).attr("src",n)})}})}):!1)}});!function(e){var r=new s({el:e("div.after-booking-sg")});r.render()}(jQuery)},{"../../config/host.js":45,"../component/after-booking/user.js":158,"../component/layout/default-page-layout.js":1082,"../component/ui/password/view.js":2108,"../component/ui/util":2122,"../component/ui/validator.js":2123,"backbone.marionette":6,underscore:42}],158:[function(e,r,t){var o=(e("underscore"),e("backbone")),n=e("../../../config/host.js").host,i=e("../ui/validator.js");i.latinRegex2,r.exports=o.Model.extend({url:function(){return n+"/mapi/account/login"},defaults:{},validation:{email:{pattern:"email",required:!0},password:{required:!0},captcha:{required:!0}},initialize:function(e){},parse:function(e,r){return e}})},{"../../../config/host.js":45,"../ui/validator.js":2123,backbone:8,underscore:42}]},{},[2165]);