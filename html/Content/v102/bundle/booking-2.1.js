require=function e(i,a,t){function r(o,s){if(!a[o]){if(!i[o]){var l="function"==typeof require&&require;if(!s&&l)return l(o,!0);if(n)return n(o,!0);var c=new Error("Cannot find module '"+o+"'");throw c.code="MODULE_NOT_FOUND",c}var d=a[o]={exports:{}};i[o][0].call(d.exports,function(e){var a=i[o][1][e];return r(a?a:e)},d,d.exports,e,i,a,t)}return a[o].exports}for(var n="function"==typeof require&&require,o=0;o<t.length;o++)r(t[o]);return r}({2169:[function(e,i,a){"scrollRestoration"in history&&(history.scrollRestoration="manual"),e("sassify")(".usabilla_live_button_container{display:none!important;}"),e("../component/booking-2.1/handle").render(),jQuery(function(){if(jQuery(".navbar").css("position","absolute"),window.BookingFlowNotice&&1===window.BookingFlowNotice.tag){var e=BookingFlowNotice.interval?1e3*parseInt(BookingFlowNotice.interval):3e4;setTimeout(function(){var e=jQuery(".tpl-full-screen-mask-crs"),i=document.getElementsByClassName("tpl-full-screen-mask-crs")[0];i&&e.length>0&&(i.querySelector(".tip-title").textContent=BookingFlowNotice.title,i.querySelector(".tip-copy").textContent=BookingFlowNotice.copy,i.querySelector(".tip-button").textContent=BookingFlowNotice.button,i.querySelector(".content-error-tips").style.backgroundImage=BookingFlowNotice.background?"url("+BookingFlowNotice.background+")":"",i.style.display="block",i.querySelector(".wgt-sqbutton-black.tip-button").href=BookingFlowNotice.link)},e)}})},{"../component/booking-2.1/handle":351,sassify:36}],351:[function(e,i,a){function t(e){return n.isArray(e)?n.map(e,function(e){return n.clone(e)}):n.clone(e)}function r(e){setTimeout(function(){if(e.isCalendar){var i=jQuery(".rc-container").offset();i&&jQuery("html,body").animate({scrollTop:i.top-86},500)}else{var i=jQuery("[data-id='"+e+"']").offset(),a=jQuery("[data-item='sales']:visible");if(m.isStyle(m.VIEW_STYLES.HOTEL_BY_ALL)){var t=m.getParam().defaultRoomInAll;if(t){var r=jQuery("[data-id='"+t+"']").next(),n=r.find(".book2-stay-child-arar").length;n||(r.find("[data-region='stay']").html(""),r.find(".book2-short-block-arar").find(".x-level").height(170))}}i?jQuery("html,body").animate({scrollTop:i.top-(89+(a.length?a.prop("clientHeight")+13||0:0))},500,function(){setTimeout(function(){m.trigger("showUpgradeTip")})}):m.trigger("showUpgradeTip")}})}var n=e("underscore"),o=e("backbone"),s=e("backbone.marionette"),l=e("../ui/util"),c=e("./common/input"),d=e("./common/popup"),p=e("./stores"),m=e("./states"),x=e("./view"),f=e("../usp-bar/usp-bar"),u=e("../checkout-2.0/storage/login"),h={};i.exports=n.extend({render:function(){var e=jQuery.proxy(this.__render,this);window.history&&window.history.pushState&&(window.onpopstate=e),e(),l.tracker.on("change:scrolltop",function(){d.delPopupTip()})},__render:function(){var e=jQuery.Deferred(),i=jQuery.Deferred();p.getBookingCart().then(function(i){m.setBookingCart(i),e.resolve()},function(){e.resolve()}),l.getUser().fetchPromise.always(function(){i.resolve()}),jQuery.when(e,i).then(jQuery.proxy(this.__initializeInlet,this))},__initializeInlet:function(){p.delCache(),m.delCache(),m.setStyle(null),this.stopListening(m),this.__initializeParam(),this.__initializeEvent(),this.__initializeView(),this.__initializeData()},__initializeParam:function(){m.setParam(p.getSearchParam())},__initializeEvent:function(){this.listenTo(m,"registerPayment",this.__registerPayment),this.listenTo(m,"resetLoyaltyTip",this.__resetLoyaltyTip),this.listenTo(m,"resetQueryParam",this.__resetQueryParam),this.listenTo(m,"planGalleryData",this.__planGalleryData),this.listenTo(m,"addShoppingCart",this.__addShoppingCart),this.listenTo(m,"loadDataByVille",this.__loadDataByVille),this.listenTo(m,"loadDataByHotel",this.__loadDataByHotel),this.listenTo(m,"loadHotelByRoom",this.__loadHotelByRoom),this.listenTo(m,"loadHotelByRate",this.__loadHotelByRate),this.listenTo(m,"loadHotelByRateCalendar",this.__loadHotelByRateCalendar),this.listenTo(m,"loadHotelByAll",this.__loadHotelByAll),this.listenTo(m,"loadRatesByRoom",this.__loadRatesByRoom),this.listenTo(m,"loadStaysInAll",this.__loadStaysInAll),this.listenTo(m,"loadRatesByCode",this.__loadRatesByCode),this.listenTo(m,"loadStaysByRate",this.__loadStaysByRate),this.listenTo(m,"loadUpgradeRate",this.__loadUpgradeRate),this.listenTo(m,"loadIGVouchers",this.__loadIGVouchers),this.listenTo(m,"changeViewStyle",this.__changeViewStyle),this.listenTo(m,"changeViewTrade",this.__changeViewTrade),this.listenTo(m,"updateAllahRate",this.__updateAllahRate),this.listenTo(m,"showVilleByCity",this.__showVilleByCity),this.listenTo(m,"showVilleByMaps",this.__showVilleByMaps),this.listenTo(m,"showHotelByRoom",this.__showHotelByRoom),this.listenTo(m,"showHotelByRate",this.__showHotelByRate),this.listenTo(m,"showHotelByAll",this.__showHotelByAll),this.listenTo(m,"showHotelByRateCalendar",this.__showHotelByRateCalendar),this.listenTo(m,"showViewNoValid",this.__showViewNoValid),this.listenTo(m,"showUpgradeView",this.__showUpgradeView),this.listenTo(m,"showUpgradeFailedView",this.__showUpgradeFailedView),this.listenTo(m,"expandChildView",this.__expandChildView),this.listenTo(m,"changeSearchKey",this.__changeSearchKey),this.listenTo(m,"changeDiscoCode",this.__changeDiscoCode),this.listenTo(m,"changeGroupCode",this.__changeGroupCode),this.listenTo(m,"changePromoCode",this.__changePromoCode),this.listenTo(m,"sign:in",this.__signIn),this.listenTo(m,"sign:up",this.__signUp)},__initializeView:function(){this.__uspBar||(this.__uspBar=new f);var e=m.getParam();if(e.type===p.VIEW_TYPE.HOTEL&&(this.__uspBar.model.url=this.__uspBar.model.get("baseUrl")+"?hotelcode="+e.code,this.__uspBar.model.fetch()),e.type===p.VIEW_TYPE.GROUP&&(this.__uspBar.model.url=this.__uspBar.model.get("baseUrl")+"?group="+e.code,this.__uspBar.model.fetch()),e.type===p.VIEW_TYPE.VILLE&&(this.__uspBar.model.url=this.__uspBar.model.get("baseUrl")+"?city="+e.code,this.__uspBar.model.fetch()),this.__mainRect)this.__mainRect.empty();else{var i=jQuery(".book2-wrapper");this.__mainRect=new s.Region({el:i.get(0)}),c.autoCreate(i,{target:".x-input",reminders:".x-water"}),d.autoCreate(i,{target:".x-popup",container:".x-popup-wrap",substance:".x-popup-body"})}this.__mainRect.show(new x({rootState:m})),m.trigger("showArticleView"),m.trigger("showSectionView")},__initializeData:function(){switch(m.getParam().type){case p.VIEW_TYPE.VILLE:case p.VIEW_TYPE.GROUP:m.trigger("loadDataByVille");break;case p.VIEW_TYPE.HOTEL:m.trigger("loadDataByHotel");break;default:m.trigger("showViewNoValid")}},__registerPayment:function(){m.trigger("showLampBoxSignInOrSignUp")},__resetLoyaltyTip:function(e){l.getUser().set("discountRate",e)},__resetQueryParam:function(e){var i=!0,a=m.getParam();(n.has(e,"code")&&a.code!==e.code||n.has(e,"type")&&a.type!==e.type)&&(i=!1),m.setParam(e),p.setSearchParam(m.getParam(),i).then(jQuery.proxy(this.__initializeInlet,this),function(e){location.href=e})},__planGalleryData:function(e){var i={};if(i._gbw_is_many_days=m.isManyDays(),(m.isStyle(m.VIEW_STYLES.HOTEL_BY_ROOM)||m.isStyle(m.VIEW_STYLES.HOTEL_BY_ALL))&&(n.has(e,"hotelid")&&(i.allah=t(m.getHotel()),i.array=[i.allah],i._gbw_hotel_gallery=!0,i._gbw_hide_button=!0),n.has(e,"categoryid")&&(i.array=t(m.getRooms()),i.allah=n.findWhere(i.array,{id:e.categoryid}),i._gbw_room_gallery=!0)),m.isStyle(m.VIEW_STYLES.HOTEL_BY_RATE)&&(n.has(e,"hotelid")&&(i.allah=t(m.getHotel()),i.array=[i.allah],i._gbw_hotel_gallery=!0,i._gbw_hide_button=!0),n.has(e,"ratecode"))){var a=t(m.getRooms()),r=m.getRates({ratecode:e.ratecode});i.array=n.filter(a,function(e){return n.findWhere(r,{categoryid:e.id})}),i.allah=n.findWhere(i.array,{id:e.categoryid}),i._gbw_room_gallery=!0,i.ratecode=e.ratecode}m.isStyle(m.VIEW_STYLES.HOTEL_BY_CALENDAR)&&n.has(e,"hotelid")&&(i.allah=t(m.getHotel()),i.array=[i.allah],i._gbw_hotel_gallery=!0,i._gbw_hide_button=!0),m.isStyle(m.VIEW_STYLES.VILLE_BY_CITY)&&n.has(e,"hotelid")&&(i.array=t(m.getVille().hotels||[]),i.allah=n.findWhere(i.array,{hotelid:e.hotelid}),i._gbw_hotel_gallery=!0),i.array&&i.array.length&&i.allah&&m.trigger("showGalleryView",i)},__addShoppingCart:function(e,i){if(n.isArray(e)&&(e=e[0],i&&(e.voucherusage=!1)),e){var a=null,t=0,r=[],o=p.getIGVouchersList();if(e.voucherusage){var s=m.getUpgradeRateByRate({categoryid:e.categoryid,roomtypecode:e.roomtypecode,ratecode:e.ratecode,roomid:e.roomid});s&&(a=s.roomrate,t=s.upgradeddifference.rebuildpricedays)}o.length&&n.each(o,function(e){e.checked&&r.push(e.id)}),m.trigger("showLoadingView"),p.toShoppingCart({currency:m.getCurrency(),currencymark:m.getCurrencyMark(),isusesignup:m.getComplete(),services:m.getValidStays({categoryid:a&&a.categoryid||e.categoryid,roomtypecode:a&&a.roomtypecode||e.roomtypecode,ratecode:a&&a.ratecode||e.ratecode,roomid:a&&a.roomid||e.roomid}),upgraderate:a,pointsupgraderebuilddays:t,redeemrewards:i?[]:r,fromrate:m.isStyle(m.VIEW_STYLES.HOTEL_BY_RATE),param:m.getParam(),value:e}).then(function(e){var i=l.getUser().attributes,a=i.points&&i.points.balance;!m.getIGViewed()&&m.isLogin()&&a>=3e3&&m.getHotel().hasbookingrewards&&jQuery.cookie("IGPopupShow","1",{path:"/"}),location.href=e},function(e){m.trigger("hideLoadingView"),101==e.status?m.trigger("showLampBoxUpgradeByPointFailed",{isToCartError:!0}):(l.error({el:jQuery("body"),screenCenter:!0,error:i18n.t("form_error.system_is_busy_please_try_again_later")}),setTimeout(function(){window.location.reload()},5e3))})}},__loadDataByVille:function(){m.setFinal(!1),m.trigger("showLoadingView"),p.getSimpleVille({param:m.getParam()}).then(function(e){m.setParam({name:e.cityname,isAmerican:e.isAmerican,AccessibleRoom:e.accessibleroom}),m.setVille(e),m.trigger("hideLoadingView"),m.trigger("resetLoyaltyTip",i18n.t("booking.up_to_10_percent")),m.trigger("showInquireView"),m.trigger("showVilleByCity"),document.title=e.citytitle,p.getIntactVille({param:m.getParam()}).then(function(e){m.setFinal(!0),m.setVille(e),m.trigger("showVilleByCity")})})},__loadDataByHotel:function(){m.trigger("showLoadingView"),m.setFinal(!1);var e=[],i=m.getParam();i.promocode&&e.push(p.validatePromo(i).then(function(e){e.valid||m.setParam({promocode:""}),m.setFirstValidRes("promocode",e)})),i.groupcode&&e.push(p.validateGroup(i).then(function(e){e.valid||m.setParam({groupcode:""}),m.setFirstValidRes("groupcode",e)})),i.discountcode&&e.push(p.validateDisco(i).then(function(e){e.valid||m.setParam({discountcode:""}),m.setFirstValidRes("discountcode",e)})),jQuery.when.apply(jQuery,e).then(function(){return p.getHotelDetail({param:m.getParam()})}).then(function(e){if(m.setParam({name:e.name,isAmerican:e.isAmerican,AccessibleRoom:e.accessibleroom,hasRateCalendar:e.enableratecalendar}),m.setFinal(!0),m.setHotel(e),m.trigger("showInquireView"),document.title=e.name,!n.has(h,e.hotelid)){var i=m.getParam().viewrates;i||m.setParam({viewrates:i=e.showRatePlanTab}),h[e.hotelid]=i}e.disablereservation?h[e.hotelid]?(m.trigger("hideLoadingView"),m.trigger("showHotelByRoom"),m.trigger("showInquireView")):(m.trigger("hideLoadingView"),m.trigger("showHotelByRate"),m.trigger("showInquireView")):"Rates"===h[e.hotelid]?m.trigger("loadHotelByRate"):"Rooms"===h[e.hotelid]?m.trigger("loadHotelByRoom"):"All"===h[e.hotelid]&&m.trigger("loadHotelByAll")})},__loadHotelByRoom:function(){var e=m.getParam().calendarFirst;m.setFinal(!1),m.trigger("showLoadingView"),e?(m.setLastStyle(2),m.setFinal(!0),m.isFinal()&&(m.trigger("changeViewStyle",m.VIEW_STYLES.HOTEL_BY_CALENDAR),m.trigger("hideSummaryView"),m.getParam().calendarFirst=!1)):p.getSimpleRooms({param:m.getParam()}).then(function(e){m.setChild(e),m.trigger("hideLoadingView"),m.trigger("showHotelByRoom"),m.trigger("showInquireView"),p.getIntactRooms({param:m.getParam()}).then(function(e){m.setFinal(!0),m.setChild(e),m.trigger("showHotelByRoom")})})},__loadHotelByRate:function(){var e=m.getParam().calendarFirst;m.setFinal(!1),m.trigger("showLoadingView"),e?(m.setLastStyle(3),m.setFinal(!0),m.isFinal()&&(m.trigger("changeViewStyle",m.VIEW_STYLES.HOTEL_BY_CALENDAR),m.trigger("hideSummaryView"),m.getParam().calendarFirst=!1)):p.getEntireRates({param:m.getParam()}).then(function(e){m.setFinal(!0),m.setChild(e),m.trigger("hideLoadingView"),m.trigger("showHotelByRate"),m.trigger("showInquireView")})},__loadHotelByAll:function(){var e=m.getParam().calendarFirst;m.setFinal(!1),m.trigger("showLoadingView"),e?(m.setLastStyle(5),m.setFinal(!0),m.isFinal()&&(m.trigger("changeViewStyle",m.VIEW_STYLES.HOTEL_BY_CALENDAR),m.trigger("hideSummaryView"),m.getParam().calendarFirst=!1)):p.getAllRoomsAllRates({param:m.getParam()}).then(function(e){m.setFinal(!0),m.setChild(e,!0),m.trigger("hideLoadingView"),m.trigger("showHotelByAll"),m.trigger("showInquireView")})},__loadHotelByRateCalendar:function(){m.setFinal(!1),m.trigger("showLoadingView"),p.getRateCalendar({param:m.getParam()}).then(function(e){m.setFinal(!0),m.setCalendarRate(e),m.trigger("hideLoadingView"),m.trigger("showHotelByRateCalendar"),m.trigger("showInquireView"),m.trigger("expandChildView")})},__loadRatesByRoom:function(e){m.trigger("showLoadingView"),p.getRatesByRoom({value:e,param:m.getParam()}).then(function(i){m.setChild(i);var a=m.getAllah(e);a?m.trigger("loadStaysByRate",a):(m.trigger("hideLoadingView"),m.trigger("expandChildView",e))})},__loadStaysInAll:function(e){m.trigger("showLoadingView");var i=m.getAllah(e);i?m.trigger("loadStaysByRate",i):(m.trigger("hideLoadingView"),m.trigger("expandChildView",e))},__loadRatesByCode:function(e){m.trigger("showLoadingView"),p.getRatesByCode({value:e,param:m.getParam()}).then(function(i){m.setChild(i);var a=m.getAllah(e);a?m.trigger("loadStaysByRate",a):(m.trigger("hideLoadingView"),m.trigger("expandChildView",e))})},__loadStaysByRate:function(e,i){m.trigger("showLoadingView"),p.getEntireStays({value:e,param:m.getParam()}).then(function(a){m.setStays(n.assign(a,{categoryid:e.categoryid})),m.trigger("hideLoadingView"),m.trigger("expandChildView",e,i)})},__loadUpgradeRate:function(e){var i=m.getIGPoints();m.trigger("showLoadingView"),p.getUpgradeRate({value:e,param:m.getParam(),pointsupgrademinuspoints:i}).then(function(a){m.setUpgradeRateByRate({categoryid:e.categoryid,roomtypecode:e.roomtypecode,ratecode:e.ratecode,roomid:e.roomid},a,i),m.trigger("hideLoadingView"),m.trigger("showUpgradeView",e)},function(e){m.trigger("hideLoadingView"),m.trigger("showLampBoxUpgradeByPointFailed")})},__loadIGVouchers:function(e){m.trigger("showLoadingView"),p.getIGVouchers().then(function(i){p.setIGVouchersList(i),m.trigger("hideLoadingView"),m.trigger("showLampBoxInstantRewards",e),m.setIGViewed(!0),m.trigger("lightBoxAnimate",jQuery('[data-item="instant"]').offset())},function(e){m.trigger("hideLoadingView")})},__changeViewStyle:function(e){switch(m.trigger("hideSummaryView"),e){case m.VIEW_STYLES.VILLE_BY_CITY:m.trigger("showVilleByCity");break;case m.VIEW_STYLES.VILLE_BY_MAPS:m.trigger("showVilleByMaps");break;case m.VIEW_STYLES.HOTEL_BY_ROOM:h[m.getHotel().hotelid]=!1,m.trigger("loadHotelByRoom"),m.setParam({viewrates:"Rooms"}),p.setSearchParam(m.getParam(),!0);break;case m.VIEW_STYLES.HOTEL_BY_RATE:h[m.getHotel().hotelid]=!0,m.trigger("loadHotelByRate"),m.setParam({viewrates:"Rates"}),p.setSearchParam(m.getParam(),!0);break;case m.VIEW_STYLES.HOTEL_BY_ALL:h[m.getHotel().hotelid]=!1,m.trigger("loadHotelByAll"),m.setParam({viewrates:"All"}),p.setSearchParam(m.getParam(),!0);break;case m.VIEW_STYLES.HOTEL_BY_CALENDAR:m.trigger("loadHotelByRateCalendar")}},__changeViewTrade:function(e){m.setTrade(e),m.trigger("showToolbarView"),m.trigger("redrawViewChild")},__updateAllahRate:function(e){m.trigger("showLoadingView"),m.isStyle(m.VIEW_STYLES.HOTEL_BY_ROOM)&&p.getRatesByRoom({value:e,param:m.getParam()},!0).then(function(i){var a=n.findWhere(i.roomrates,{categoryid:e.categoryid,roomtypecode:e.roomtypecode,ratecode:e.ratecode,roomid:e.roomid});a?(a.adults=e.adults,a.children=e.children,m.setChild({roomrates:[a]}),m.trigger("loadStaysByRate",a)):(m.trigger("hideLoadingView"),m.trigger("promptOccupancy",e))}),m.isStyle(m.VIEW_STYLES.HOTEL_BY_RATE)&&p.getRatesByCode({value:e,param:m.getParam()},!0).then(function(i){var a=n.findWhere(i.roomrates,{categoryid:e.categoryid,roomtypecode:e.roomtypecode,ratecode:e.ratecode,roomid:e.roomid});a?(a.adults=e.adults,a.children=e.children,m.setChild({roomrates:[a]}),m.trigger("loadStaysByRate",a)):(m.trigger("hideLoadingView"),m.trigger("promptOccupancy",e))})},__expandChildView:function(e,i){if(m.isStyle(m.VIEW_STYLES.HOTEL_BY_ROOM)&&(m.setParam({defaultRoom:e.categoryid}),m.trigger("showSummaryView"),m.trigger("expandSelfView",e),r(e.categoryid)),m.isStyle(m.VIEW_STYLES.HOTEL_BY_RATE)&&(m.setParam({defaultRate:e.ratecode}),m.trigger("showSummaryView"),m.trigger("expandSelfView",e),r(e.ratecode)),m.isStyle(m.VIEW_STYLES.HOTEL_BY_ALL)&&(i?(m.trigger("showSummaryView"),m.trigger("expandSelfView",e,i)):(m.setParam({defaultRoomInAll:e.categoryid}),m.trigger("showSummaryView"),m.trigger("expandSelfView",e,i),r(e.categoryid))),m.isStyle(m.VIEW_STYLES.HOTEL_BY_CALENDAR)){var e={};e.isCalendar=!0,r(e)}},__showVilleByCity:function(){m.setStyle(m.VIEW_STYLES.VILLE_BY_CITY),m.trigger("showCaptionView"),m.trigger("showToolbarView"),m.trigger("showContentCity")},__showVilleByMaps:function(){m.setStyle(m.VIEW_STYLES.VILLE_BY_MAPS),m.trigger("showCaptionView"),m.trigger("showToolbarView"),m.trigger("showContentMaps")},__showHotelByRoom:function(){m.setStyle(m.VIEW_STYLES.HOTEL_BY_ROOM),m.trigger("showCaptionView"),m.trigger("showToolbarView"),m.trigger("showContentRoom"),this.__handleMakkahHotel()},__showHotelByRate:function(){m.setStyle(m.VIEW_STYLES.HOTEL_BY_RATE),m.trigger("showCaptionView"),m.trigger("showToolbarView"),m.trigger("showContentRate"),this.__handleMakkahHotel()},__showHotelByAll:function(){m.setStyle(m.VIEW_STYLES.HOTEL_BY_ALL),m.trigger("showCaptionView"),m.trigger("showToolbarView"),m.trigger("showContentAll"),this.__handleMakkahHotel()},__showHotelByRateCalendar:function(){m.setStyle(m.VIEW_STYLES.HOTEL_BY_CALENDAR),m.trigger("showCaptionView"),m.trigger("showToolbarView"),m.trigger("showContentRateCalendar"),this.__handleMakkahHotel()},__showViewNoValid:function(){m.setFinal(!0),m.trigger("showInquireView"),m.trigger("showInvalidView")},__showUpgradeView:function(e){var i=m.getUpgradeRateByRate({categoryid:e.categoryid,roomtypecode:e.roomtypecode,ratecode:e.ratecode,roomid:e.roomid});return i.upgradeddifference?void jQuery.when(!!i).then(function(a){if(a&&i.upgradeddifference){var t=jQuery.Deferred();return m.trigger("showLampBoxUpgradeByPoint",{promise:t,upgrade:e}),t.promise()}return a}).then(function(a){var t=i&&i.roomrate||e;a?(m.trigger("showLoadingView"),p.getEntireStays({value:t,param:m.getParam()}).then(function(i){m.trigger("turnUpgradeRate",{categoryid:e.categoryid,roomtypecode:e.roomtypecode,ratecode:e.ratecode,roomid:e.roomid,voucherusage:a}),m.setStays(n.assign(i,{categoryid:t.categoryid})),m.trigger("hideLoadingView"),m.isStyle(m.VIEW_STYLES.HOTEL_BY_ALL)?m.trigger("expandChildView",e,!0):m.trigger("expandChildView",e)})):m.trigger("turnUpgradeRate",{categoryid:e.categoryid,roomtypecode:e.roomtypecode,ratecode:e.ratecode,roomid:e.roomid,voucherusage:a})}):void m.trigger("showLampBoxUpgradeByPointFailed")},__changeSearchKey:n.throttle(function(e){p.retrieveByKey(e).then(function(e){m.trigger("expandQueryView",e)})},500),__changeDiscoCode:n.debounce(function(e){p.validateDisco(e).then(function(e){m.trigger("revealDiscoCode",e)})},500),__changeGroupCode:n.debounce(function(e){p.validateGroup(e).then(function(e){m.trigger("revealGroupCode",e)})},500),__changePromoCode:n.debounce(function(e){p.validatePromo(e).then(function(e){m.trigger("revealPromoCode",e)})},500),__signIn:function(e){m.trigger("showLoadingView"),u.store(e).then(function(e){if(e.success)location.reload();else{var i=e.other&&e.other.url?e.other.url:null;m.trigger("hideLoadingView"),m.trigger("user:error",e.message,i,e.status)}},function(e){m.trigger("hideLoadingView"),m.trigger("user:error",e)})},__signUp:function(e){m.trigger("showLoadingView"),u.newly(e).then(function(e){e.success?location.reload():(m.trigger("hideLoadingView"),m.trigger("user:error",e.message))},function(e){m.trigger("hideLoadingView"),m.trigger("user:error",e)})},__handleMakkahHotel:function(){if(15098==window.makkahHotelId||15099==window.makkahHotelId){jQuery(".book2-content-section").html('<div><div class="x-fs-20 x-lh-12 x-al-c" style="padding: 4em">Please refer to the announcement regarding this hotel</div></div>'),jQuery('[data-item="room"]').attr("data-item","").addClass("x-makkah-disabled"),jQuery('[data-item="rate"]').attr("data-item","").addClass("x-makkah-disabled"),jQuery('[data-item="all"]').attr("data-item","").addClass("x-makkah-disabled");var e=jQuery(".tpl-full-screen-mask-crs");e.find(".tip-title").hide(),e.find(".tip-copy").addClass("x-makkah-copy").html("<p>ANNOUNCEMENT</p>It is with regret that Millennium and Copthorne must announce that on 13 June 2019 the owner of Makkah Millennium Hotel and Towers had unlawfully, and contrary to the terms of the operating and management agreement, interfered with the exclusive rights of Millennium in the management and operation of the hotel and towers. Millennium disagrees with the owner’s acts and had commenced proceedings to remove this interference and confirm Millennium’s exclusive rights to manage and operate the hotel and towers without interference from the owner or others. Millennium regrets any inconvenience this situation has caused or may continue to cause to its guests. Millennium is pursuing all available legal courses of action inside the Kingdom of Saudi Arabia, and is confident of the Saudi judiciary system in the protection of rights and imposing of justice."),e.find(".tip-copy").siblings(".clearfix").addClass("x-makkah-close"),e.find(".tip-button").addClass("icon-icon_B017"),e.find(".x-makkah-close").on("click",function(){e.hide()}),e.show()}}},o.Events)},{"../checkout-2.0/storage/login":553,"../ui/util":2122,"../usp-bar/usp-bar":2142,"./common/input":347,"./common/popup":348,"./states":352,"./stores":356,"./view":358,backbone:8,"backbone.marionette":6,underscore:42}],358:[function(e,i,a){var t=e("backbone"),r=e("backbone.marionette"),n=e("./01-article/view"),o=e("./02-section/view"),s=e("./03-gallery/view"),l=e("./04-lampbox/01-rate/view"),c=e("./04-lampbox/01-room/view"),d=e("./04-lampbox/02-stay/view"),p=e("./05-loading/view"),m=e("./04-lampbox/04-upgrade/01-exceeds/view"),x=e("./04-lampbox/04-upgrade/02-special/view"),f=e("./04-lampbox/04-upgrade/03-bypoint/view"),u=e("./04-lampbox/04-upgrade/04-failed/view"),h=e("./04-lampbox/05-login/view"),g=e("./04-lampbox/06-instant/view");i.exports=r.LayoutView.extend({template:Handlebars.compile(e("./template.hbs")),regions:{article:".book2-article",section:".book2-section",gallery:".book2-gallery",lampbox:".book2-lampbox",loading:".book2-loading"},initialize:function(){var e=this.options.rootState;this.__renderDeferred=jQuery.Deferred(),this.listenTo(e,"showArticleView",this.showArticleView),this.listenTo(e,"showSectionView",this.showSectionView),this.listenTo(e,"showGalleryView",this.showGalleryView),this.listenTo(e,"showLampBoxRate",this.showLampBoxRate),this.listenTo(e,"showLampBoxRoom",this.showLampBoxRoom),this.listenTo(e,"showLampBoxStay",this.showLampBoxStay),this.listenTo(e,"showLoadingView",this.showLoadingView),this.listenTo(e,"hideGalleryView",this.hideGalleryView),this.listenTo(e,"hideLampBoxView",this.hideLampBoxView),this.listenTo(e,"hideLoadingView",this.hideLoadingView),this.listenTo(e,"showLampBoxUpgradeExceeds",this.showLampBoxUpgradeExceeds),this.listenTo(e,"showLampBoxUpgradeSpecial",this.showLampBoxUpgradeSpecial),this.listenTo(e,"showLampBoxUpgradeByPoint",this.showLampBoxUpgradeByPoint),this.listenTo(e,"showLampBoxSignInOrSignUp",this.showLampBoxSignInOrSignUp),this.listenTo(e,"showLampBoxInstantRewards",this.showLampBoxInstantRewards),this.listenTo(e,"showLampBoxUpgradeByPointFailed",this.showLampBoxUpgradeByPointFailed)},onRender:function(){this.__renderDeferred.resolve()},showArticleView:function(e){return this.__renderDeferred.then(jQuery.proxy(this.__showArticleView,this,e))},showSectionView:function(e){return this.__renderDeferred.then(jQuery.proxy(this.__showSectionView,this,e))},showGalleryView:function(e){return this.__renderDeferred.then(jQuery.proxy(this.__showGalleryView,this,e))},showLampBoxRate:function(e){return this.__renderDeferred.then(jQuery.proxy(this.__showLampBoxRate,this,e))},showLampBoxRoom:function(e){return this.__renderDeferred.then(jQuery.proxy(this.__showLampBoxRoom,this,e))},showLampBoxStay:function(e){return this.__renderDeferred.then(jQuery.proxy(this.__showLampBoxStay,this,e))},showLoadingView:function(e){return this.__renderDeferred.then(jQuery.proxy(this.__showLoadingView,this,e))},hideGalleryView:function(e){return this.__renderDeferred.then(jQuery.proxy(this.__hideGalleryView,this,e))},hideLampBoxView:function(e){return this.__renderDeferred.then(jQuery.proxy(this.__hideLampBoxView,this,e))},hideLoadingView:function(e){return this.__renderDeferred.then(jQuery.proxy(this.__hideLoadingView,this,e))},showLampBoxUpgradeExceeds:function(e){return this.__renderDeferred.then(jQuery.proxy(this.__showLampBoxUpgradeExceeds,this,e))},showLampBoxUpgradeSpecial:function(e){return this.__renderDeferred.then(jQuery.proxy(this.__showLampBoxUpgradeSpecial,this,e))},showLampBoxUpgradeByPoint:function(e){return this.__renderDeferred.then(jQuery.proxy(this.__showLampBoxUpgradeByPoint,this,e))},showLampBoxSignInOrSignUp:function(e){return this.__renderDeferred.then(jQuery.proxy(this.__showLampBoxSignInOrSignUp,this,e))},showLampBoxInstantRewards:function(e){return this.__renderDeferred.then(jQuery.proxy(this.__showLampBoxInstantRewards,this,e))},showLampBoxUpgradeByPointFailed:function(e){return this.__renderDeferred.then(jQuery.proxy(this.__showLampBoxUpgradeByPointFailed,this,e))},__showArticleView:function(){this.getRegion("article").show(new n({rootState:this.options.rootState}))},__showSectionView:function(){this.getRegion("section").show(new o({rootState:this.options.rootState}))},__showGalleryView:function(e){this.getRegion("gallery").show(new s({model:new t.Model(e),rootState:this.options.rootState}))},__showLampBoxRate:function(e){this.getRegion("lampbox").show(new l({model:new t.Model(e),rootState:this.options.rootState}))},__showLampBoxRoom:function(e){this.getRegion("lampbox").show(new c({model:new t.Model(e),rootState:this.options.rootState}))},__showLampBoxStay:function(e){this.getRegion("lampbox").show(new d({model:new t.Model(e),rootState:this.options.rootState}))},__showLoadingView:function(){this.getRegion("loading").hasView()||this.getRegion("loading").show(new p({rootState:this.options.rootState}))},__hideGalleryView:function(){this.getRegion("gallery").empty()},__hideLampBoxView:function(){this.getRegion("lampbox").empty()},__hideLoadingView:function(){this.getRegion("loading").empty()},__showLampBoxUpgradeExceeds:function(e){this.getRegion("lampbox").show(new m({model:new t.Model(e.upgrade),rootState:this.options.rootState}).on("confirm:result",function(i){e.promise.resolve(i)}))},__showLampBoxUpgradeSpecial:function(e){this.getRegion("lampbox").show(new x({model:new t.Model(e.upgrade),rootState:this.options.rootState}).on("confirm:result",function(i){e.promise.resolve(i)}))},__showLampBoxUpgradeByPoint:function(e){this.getRegion("lampbox").show(new f({model:new t.Model(e.upgrade),rootState:this.options.rootState}).on("confirm:result",function(i){e.promise.resolve(i)}))},__showLampBoxUpgradeByPointFailed:function(e){this.getRegion("lampbox").show(new u({model:new t.Model(e),rootState:this.options.rootState}))},__showLampBoxSignInOrSignUp:function(e){this.getRegion("lampbox").show(new h({rootState:this.options.rootState}))},__showLampBoxInstantRewards:function(e){this.getRegion("lampbox").show(new g({model:new t.Model(e),rootState:this.options.rootState}))}})},{"./01-article/view":237,"./02-section/view":306,"./03-gallery/view":308,"./04-lampbox/01-rate/view":311,"./04-lampbox/01-room/view":314,"./04-lampbox/02-stay/view":316,"./04-lampbox/04-upgrade/01-exceeds/view":318,"./04-lampbox/04-upgrade/02-special/view":320,"./04-lampbox/04-upgrade/03-bypoint/view":322,"./04-lampbox/04-upgrade/04-failed/view":324,"./04-lampbox/05-login/view":331,"./04-lampbox/06-instant/view":333,"./05-loading/view":335,"./template.hbs":357,backbone:8,"backbone.marionette":6}],357:[function(e,i,a){i.exports='<div class="book2-article"></div>\r\n<div class="book2-section"></div>\r\n<div class="book2-gallery"></div>\r\n<div class="book2-lampbox"></div>\r\n<div class="book2-loading"></div>'},{}],347:[function(e,i,a){i.exports={autoCreate:function(e,i){jQuery(e).on("input",i.target,function(e){var a=jQuery(e.currentTarget),t=a.prev(i.reminders);a.val()?t.css("display","none"):t.css("display","inline-block")})}}},{}],333:[function(e,i,a){var t=(e("backbone"),e("backbone.marionette")),r=e("underscore"),n=e("../../common/scroll"),o=(e("../../common/short"),e("../../stores")),s=e("../../../ui/util"),l=[],c=0;i.exports=t.CompositeView.extend({template:Handlebars.compile(e("./template.hbs")),ui:{cancel:"[data-item='cancel']",confirm:"[data-item='confirm']",close:"[data-item='close']",lampbox:".book2-lampbox-container",check:"[data-item='check']",list:".mm2-ig-list"},events:{"click @ui.cancel":function(e){e.stopPropagation(),this.__closeLightBox()},"click @ui.confirm":function(e){var i=this.options.rootState;e.stopPropagation(),o.setIGVouchersList(l),i.setIGPoints(c),i.trigger("updateIGState"),this.__closeLightBox(),i.trigger("redrawForIGConfirm")},click:function(e){this.ui.lampbox.has(e.target).length||this.__closeLightBox()},"click @ui.check":function(e){var i=e.target.getAttribute("data-id");this.refreshItem(e.target,i)},mousewheel:function(e){e.preventDefault()},DOMMouseScroll:function(e){e.preventDefault()}},childViewOptions:function(e){return{model:e,rootState:this.options.rootState}},initialize:function(){var e=this,i=e.options.rootState,a=e.model.toJSON(),t=a.voucherusage,r=s.getUser().attributes;e.userPoints=r.points&&r.points.balance,e.upgradePoints=0,t&&(upgradeObject=i.getUpgradeRateByRate({categoryid:a.categoryid,roomtypecode:a.roomtypecode,ratecode:a.ratecode,roomid:a.roomid}),e.upgradePoints=upgradeObject.upgradeddifference&&upgradeObject.upgradeddifference.totalUpgradePoints),l=JSON.parse(JSON.stringify(o.getIGVouchersList())),c=i.getIGPoints(),e.__renderDeferred=jQuery.Deferred(),e.listenTo(i,"lightBoxAnimate",e.lightBoxAnimate),n.autoCreate(this,{lock:!0})},serializeData:function(){var e=this;return r.each(l,function(i){i.checked||(i.disabled=!!(i.requiredPoints>e.getBalancePoints()))}),{items:l,balancePoints:e.getBalancePoints()}},onRender:function(){this.__renderDeferred.resolve()},getBalancePoints:function(){var e=this;return parseInt(e.userPoints-e.upgradePoints-c)},lightBoxAnimate:function(e){return this.__renderDeferred.then(jQuery.proxy(this.__lightBoxAnimate,this,e))},refreshItem:function(e,i){var a=this,t=r.find(l,function(e){return e.id==i});t.disabled||(t.checked?(jQuery(e).removeClass("checked"),c-=t.requiredPoints,r.each(l,function(e){e.id==i?e.checked=!1:!e.checked&&e.requiredPoints>a.getBalancePoints()?(e.disabled=!0,a.$el.find(jQuery("[data-id="+e.id+"]")).closest(".mm2-ig-item").addClass("disabled")):(e.disabled=!1,a.$el.find(jQuery("[data-id="+e.id+"]")).closest(".mm2-ig-item").removeClass("disabled"))})):(jQuery(e).addClass("checked"),c+=t.requiredPoints,r.each(l,function(e){e.id==i?e.checked=!0:!e.checked&&e.requiredPoints>a.getBalancePoints()?(e.disabled=!0,a.$el.find(jQuery("[data-id="+e.id+"]")).closest(".mm2-ig-item").addClass("disabled")):(e.disabled=!1,a.$el.find(jQuery("[data-id="+e.id+"]")).closest(".mm2-ig-item").removeClass("disabled"))})))},__lightBoxAnimate:function(e){if(e){var i=this,a=i.ui.lampbox.width(),t=i.ui.lampbox.height(),r=i.ui.lampbox.offset(),n=jQuery(window).scrollTop(),o=e.top-n,s=e.left,l=r.top-n,c=r.left;i.__prevAnimateObj={
position:"absolute",left:s,top:o,opacity:0,height:0,width:0},i.__nextAnimateObj={position:"absolute",left:c,top:l,opacity:1,height:t,width:a},i.ui.lampbox.css(i.__prevAnimateObj).animate(i.__nextAnimateObj,300,function(){i.ui.lampbox.removeAttr("style")})}},__closeLightBox:function(e){var i=this;i.__prevAnimateObj&&i.__nextAnimateObj?i.ui.lampbox.css(i.__nextAnimateObj).animate(i.__prevAnimateObj,300,function(){e&&e.resolve(),i.destroy()}):(e&&e.resolve(),i.destroy())}})},{"../../../ui/util":2122,"../../common/scroll":349,"../../common/short":350,"../../stores":356,"./template.hbs":332,backbone:8,"backbone.marionette":6,underscore:42}],331:[function(e,i,a){var t=e("backbone.marionette"),r=e("./01-signin/view"),n=e("./02-signup/view"),o=e("./model"),s=e("../../common/scroll"),l=new o({select_preferences:!0,remember_me:!1});i.exports=t.LayoutView.extend({template:Handlebars.compile(e("./template.hbs")),ui:{signin:"[data-item='signin']",signup:"[data-item='signup']",lampbox:".book2-lampbox-container"},events:{"click @ui.signin":function(e){e.stopPropagation(),this.__showSignInView()},"click @ui.signup":function(e){e.stopPropagation(),this.__showSignUpView()},click:function(e){this.ui.lampbox.has(e.target).length||this.destroy()},mousewheel:function(e){e.preventDefault()},DOMMouseScroll:function(e){e.preventDefault()}},regions:{body:"[data-region='body']"},initialize:function(){this.model=l,s.autoCreate(this,{lock:!0})},onRender:function(){this.__showSignInView()},__showSignInView:function(){this.ui.signin.addClass("active"),this.ui.signup.removeClass("active"),this.getRegion("body").show(new r({model:this.model,rootState:this.options.rootState}))},__showSignUpView:function(){this.ui.signup.addClass("active"),this.ui.signin.removeClass("active"),this.getRegion("body").show(new n({model:this.model,rootState:this.options.rootState}))}})},{"../../common/scroll":349,"./01-signin/view":326,"./02-signup/view":328,"./model":329,"./template.hbs":330,"backbone.marionette":6}],330:[function(e,i,a){i.exports='<div class="x-mask x-mask-black">\r\n    <div class="x-al-c x-nowrap book2-vertical">\r\n        <div class="book2-lampbox-container book2-lampbox-login x-al-l x-normal">\r\n            <div class="book2-lampbox-head">\r\n                <div class="x-flex">\r\n                    <div class="book2-reg-sign x-cell x-fs-18 x-lh-18 x-ff-wm x-al-c x-pointer" data-item="signin">Sign in to view special member rates</div>\r\n                    <div class="book2-reg-sign x-cell x-fs-18 x-lh-18 x-ff-wm x-al-c x-pointer" data-item="signup">Sign up to unlock member rates</div>\r\n                </div>\r\n            </div>\r\n            <div class="book2-lampbox-body">\r\n                <div class="x-scroll">\r\n                    <div class="x-scroll-body">\r\n                        <div data-region="body"></div>\r\n                    </div>\r\n                </div>\r\n                <div class="x-runner">\r\n                    <div class="x-slider"></div>\r\n                </div>\r\n            </div>\r\n        </div>\r\n    </div>\r\n</div>'},{}],329:[function(e,i,a){i.exports=e("../../../checkout-2.0/models/user")},{"../../../checkout-2.0/models/user":545}],328:[function(e,i,a){var t=e("underscore"),r=e("backbone.marionette"),n=e("../../../../ui/validator"),o=e("../../../../ui/date3selects/view"),s=e("../../../../../../config/host"),l=e("../../../../ui/password/model"),c=["first_name","last_name","email","new_password","new_birthday","tick","captcha"],d=!1,p=i18n.t("form.communications_statement4").replace("{0}",window.policyurl).replace("{1}",window.termsurl);i.exports=r.ItemView.extend({template:Handlebars.compile(e("./template.hbs")),ui:{dobbinder:"[data-bind-to='new_birthday']",password:"[data-bind='new_password']",selected:"[data-item='selected']",descript:".password-description",strength:".password-status span",submit:".wgt-sqbutton-black",error:".error-msg",voice:"[data-feedback='voice']",img:"[data-feedback='img']",item_img:"[data-item='img']"},events:{"click @ui.selected":function(e){e.stopPropagation(),e.preventDefault(),(d=!d)?(this.ui.password.prop("type","text"),this.ui.descript.html(i18n.t("general.hide"))):(this.ui.password.prop("type","password"),this.ui.descript.html(i18n.t("general.show")))},"click @ui.submit":function(e){e.stopPropagation(),e.preventDefault(),this.__submit()},"input @ui.password":function(){this.__strength()},"click @ui.img":function(){var e=s.getURL("api","captcha/image?r="+Math.random());jQuery(".code-bottom .captcha-img").each(function(i,a){jQuery(a).attr("src",e)})},"click @ui.voice":function(){this.IF_CLICK_AUDIO&&this.autoPlay()}},initialize:function(){var e=this.options.rootState;this.listenTo(e,"user:error",this.__userError),this.IF_CLICK_AUDIO=!0,this.audio=new Audio},onRender:function(){this.__rendered=!0;var e=s.getURL("api","captcha/image?r="+Math.random());this.ui.item_img.attr("src",e),this.model.validation.captcha={required:!0},jQuery(".code-bottom .captcha-img").each(function(i,a){jQuery(a).attr("src",e)}),o.autoCreate(this.ui.dobbinder),n.bind(this)},autoPlay:function(){var e=this;e.IF_CLICK_AUDIO=!1,e.audio.setAttribute("src",s.getURL("api","captcha/voice?r="+Math.random())),e.audio.load(),e.audio.play(),e.audio.oncanplay=function(){e.audio.play()},e.audio.onended=function(){e.IF_CLICK_AUDIO=!0}},serializeData:function(){var e=this.model.toJSON();return{first_name:e.first_name,last_name:e.last_name,email:e.email,new_password:e.new_password,new_birthday:e.new_birthday,select_preferences:e.select_preferences,selected:d,communications:p,group:e.group,affiliates:e.affiliates,tick:e.tick}},__submit:function(){var e=this,i=e.options.rootState;e.model.isValid(c)&&i.trigger("sign:up",{first_name:e.model.get("first_name"),last_name:e.model.get("last_name"),email:e.model.get("email"),password:e.model.get("new_password"),birthday:e.model.get("new_birthday").replace(/undefined/g,"01"),select_preferences:e.model.get("select_preferences"),group:e.model.get("group"),affiliates:e.model.get("affiliates"),tick:e.model.get("tick"),captcha:e.model.get("captcha"),ischeckcaptacha:!0}),e.ui.error.hide()},__userError:function(e){this.__rendered&&this.ui.error.html(e&&e.message).show();var i=s.getURL("api","captcha/image?r="+Math.random());jQuery(".code-bottom .captcha-img").each(function(e,a){jQuery(a).attr("src",i)})},__strength:t.debounce(function(){var e="",i=!1,a=this.ui.password.val();a&&(i=l.isStrongPassword(a),e=i18n.t("form_error.password_"+(i?"strong":"weak"))),this.ui.strength.html(e)[i?"removeClass":"addClass"]("password-weak")},1e3)})},{"../../../../../../config/host":45,"../../../../ui/date3selects/view":2071,"../../../../ui/password/model":2106,"../../../../ui/validator":2123,"./template.hbs":327,"backbone.marionette":6,underscore:42}],327:[function(e,i,a){i.exports='<div class="book2-reg-body">\r\n    <div class="login-input">\r\n        <div class="form" style="display: block">\r\n            <div class="field field-half">\r\n                <label class="x-ff-sm">{{local \'form.first_name\'}}</label>\r\n                <div class="input-box">\r\n                    <input type="text" data-bind="first_name"\r\n                           placeholder="{{local \'signup.first_name_placeholder\'}}" value="{{first_name}}">\r\n                    <span class="error-tip null"> {{local "form_error.cannot_be_empty"}} </span>\r\n                    <span class="error-tip not-null"> {{local "form_error.only_accepts_latin"}} </span>\r\n                </div>\r\n            </div>\r\n            <div class="field field-half field-half-right">\r\n                <label class="x-ff-sm">{{local \'form.last_name\'}}</label>\r\n                <div class="input-box">\r\n                    <input type="text" data-bind="last_name"\r\n                           placeholder="{{local \'signup.last_name_placeholder\'}}" value="{{last_name}}">\r\n                    <span class="error-tip null"> {{local "form_error.cannot_be_empty"}} </span>\r\n                    <span class="error-tip not-null"> {{local "form_error.only_accepts_latin"}} </span>\r\n                </div>\r\n            </div>\r\n            <div class="field">\r\n                <label class="x-ff-sm">{{local "signup.email_label"}}</label>\r\n                <div class="input-box">\r\n                    <input name="username" type="text" data-bind="email" value="{{email}}" placeholder="{{local "form.email"}}" maxlength="254">\r\n                </div>\r\n                <span class="error-tip null"> {{local "form_error.email_empty"}} </span>\r\n                <span class="error-tip not-null"> {{local "form_error.email_invalid"}} </span>\r\n            </div>\r\n            <div class="field">\r\n                <div class="clearfix password-status">\r\n                    <p>{{local "form.password_status"}} <span></span></p>\r\n                    <label class="x-ff-sm">{{local "form.password"}}</label>\r\n                </div>\r\n                <div class="input-box">\r\n                    {{#if selected}}\r\n                        <input type="text" placeholder="{{local "signup.enter_pwd_tip"}}" data-bind="new_password"\r\n                               value="{{new_password}}" maxlength="50" autocomplete="off">\r\n                        <a class="input-show" data-item="selected">\r\n                            <span class="show icon-icon_K002 password-icon"></span>\r\n                            <span class="show description password-description">{{local \'general.hide\'}}</span>\r\n                        </a>\r\n                    {{else}}\r\n                        <input type="password" placeholder="{{local "signup.enter_pwd_tip"}}" data-bind="new_password"\r\n                               value="{{new_password}}" maxlength="50" autocomplete="off">\r\n                        <a class="input-show" data-item="selected">\r\n                            <span class="show icon-icon_K003 password-icon"></span>\r\n                            <span class="show description password-description">{{local \'general.show\'}}</span>\r\n                        </a>\r\n                    {{/if}}\r\n                </div>\r\n                <span class="error-tip null"> {{local "form_error.password_empty"}}</span>\r\n                <span class="error-tip not-null"> {{local "form_error.password_invalid"}}</span>\r\n            </div>\r\n            <div class="field field-third">\r\n                <label class="x-ff-sm">{{local "form.date_of_birth"}}</label>\r\n                <div data-value="{{new_birthday}}" data-component="date3selects"\r\n                     data-bind-to="new_birthday" data-parent-container="true" data-allow-incomplete="true"></div>\r\n                    <span class="error-tip null">{{local\r\n                    "form_error.cannot_be_empty"}}</span>\r\n                    <span data-content-key-prefix="error_birthdate_"\r\n                          class="error-tip not-null"> </span>\r\n            </div>\r\n            <p class="birth-des des">{{local "form.birth_description"}}</p>\r\n            <p class="des">{{local "form.send_email_statement"}}</p>\r\n            <h2>{{local "form.communications_title"}}</h2>\r\n            <p class="des">{{local "form.communications_statement1"}}</p>\r\n            <p class="des">{{local "form.communications_statement2"}}</p>\r\n            <div class="checkboxs field"><i data-bind="group" class="checkbox"></i>\r\n                <div class="content">{{local "form.the_mhr_group"}}</div>\r\n            </div>\r\n            <div class="checkboxs field"><i data-bind="affiliates" class="checkbox"></i>\r\n                <div class="content">{{local "form.the_mhr_group_third"}}</div>\r\n            </div>\r\n            <p>{{local "form.communications_statement3"}}</p>\r\n            <div class="checkboxs field"><i data-bind="tick" class="checkbox"></i>\r\n                <div class="content">{{{communications}}}</div><span class="error-tip null">{{local "form_error.confirm_policy_empty"}}</span>\r\n            </div>\r\n            <div class="field">\r\n                <label>{{local "form.captcha"}}</label>\r\n                <div class="input-box">\r\n                    <input name="captcha" data-bind="captcha" placeholder="{{local "form.type_captcha"}}" type="text"/>\r\n                </div>\r\n                <span class="error-tip null"> {{local "form_error.cannot_be_empty"}}</span>\r\n                <span class="error-tip not-null"> {{local "form_error.cannot_be_empty"}}</span>\r\n            </div>\r\n            <div class="code-bottom">\r\n                <img src="" alt="" class="captcha-img" data-item="img">\r\n                <div class="captcha-icons" style="display:inline-block">\r\n                    <div class="captcha-icon captcha-click" data-feedback="img">\r\n                        <span class="voice-icon icon-icon_B078"></span>\r\n                        <span>{{local "form.new_captcha"}}</span>\r\n                    </div>\r\n                    <div class="captcha-icon captcha-voice" data-feedback="voice">\r\n                        <span class="voice-icon icon-icon_K009"></span>\r\n                        <span>{{local "form.captcha_vision_mpaired"}}</span>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n            <div class="field">\r\n                <div class="x-pt-05">\r\n                    <a class="wgt-sqbutton-black signin">{{ local "form.sign_up_now" }}</a>\r\n                </div>\r\n            </div>\r\n            <div>\r\n                <p class="error-msg"></p>\r\n            </div>\r\n            <!--<div class="field">-->\r\n                <!--<div class="x-di x-di-v-t checkbox-container">-->\r\n                    <!--{{#if select_preferences}}-->\r\n                        <!--<i class="checkbox checked" data-bind="select_preferences"></i>-->\r\n                    <!--{{else}}-->\r\n                        <!--<i class="checkbox" data-bind="select_preferences"></i>-->\r\n                    <!--{{/if}}-->\r\n                <!--</div>-->\r\n                <!--<div class="x-di x-di-v-t book2-reg-pref">-->\r\n                    <!--<div class="book2-reg-pref-transform">-->\r\n                        <!--<div>{{ local "signup.select_preferences" }}</div>-->\r\n                        <!--<div class="x-mt-16">{{ local "signup.terms_policy_tip" }}</div>-->\r\n                    <!--</div>-->\r\n                <!--</div>-->\r\n            <!--</div>-->\r\n        </div>\r\n    </div>\r\n</div>'},{}],326:[function(e,i,a){var t=e("backbone.marionette"),r=e("../../../../ui/validator"),n=e("../../../../../../config/host"),o=["email","new_password","captcha"];i.exports=t.ItemView.extend({template:Handlebars.compile(e("./template.hbs")),ui:{submit:".wgt-sqbutton-black",error:".error-msg",img:"[data-feedback='img']",voice:"[data-feedback='voice']",item_img:"[data-item='img']"},events:{"click @ui.submit":function(e){e.stopPropagation(),e.preventDefault(),this.__submit()},"click @ui.img":function(){var e=n.getURL("api","captcha/image?r="+Math.random());jQuery(".code-bottom .captcha-img").each(function(i,a){jQuery(a).attr("src",e)})},"click @ui.voice":function(){this.IF_CLICK_AUDIO&&this.autoPlay()}},initialize:function(){var e=this.options.rootState;this.listenTo(e,"user:error",this.__userError),this.IF_CLICK_AUDIO=!0,this.audio=new Audio},autoPlay:function(){var e=this;e.IF_CLICK_AUDIO=!1,e.audio.setAttribute("src",n.getURL("api","captcha/voice?r="+Math.random())),e.audio.load(),e.audio.play(),e.audio.oncanplay=function(){e.audio.play()},e.audio.onended=function(){e.IF_CLICK_AUDIO=!0}},onRender:function(){this.__rendered=!0;var e=n.getURL("api","captcha/image?r="+Math.random());this.ui.item_img.attr("src",e),this.model.validation.captcha={required:!0},jQuery(".code-bottom .captcha-img").each(function(i,a){jQuery(a).attr("src",e)}),r.bind(this)},serializeData:function(){return{email:this.model.get("email"),new_password:this.model.get("new_password"),remember_me:this.model.get("remember_me"),forget_pwd:n.getURL("forget_pwd")}},__submit:function(){var e=this,i=e.options.rootState;e.model.isValid(o)&&i.trigger("sign:in",{email:e.model.get("email"),password:e.model.get("new_password"),captcha:e.model.get("captcha"),remember_me:e.model.get("remember_me")}),e.ui.error.hide()},__userError:function(e,i,a){var t=i18n.t("login.re_activate_account").replace("{0}",i);this.__rendered&&(this.ui.error.html(e).show(),3==a?this.ui.error.html(t).show():this.ui.error.html(e).show());var r=n.getURL("api","captcha/image?r="+Math.random());jQuery(".code-bottom .captcha-img").each(function(e,i){jQuery(i).attr("src",r)})}})},{"../../../../../../config/host":45,"../../../../ui/validator":2123,"./template.hbs":325,"backbone.marionette":6}],325:[function(e,i,a){i.exports='<div class="book2-reg-body">\r\n    <div class="login-input">\r\n        <div class="form" style="display: block">\r\n            <div class="field">\r\n                <a class="wgt-sqbutton-facebook" href="/mapi/account/login/facebook">\r\n                    <span class="icon-icon_B028"></span>\r\n                    <span>{{ local "signup.sign_fb_link" }}</span>\r\n                </a>\r\n            </div>\r\n            <div class="field">\r\n                <a class="wgt-sqbutton-google" href="/mapi/account/login/google-plus">\r\n                    <span class="icon-icon_B048"></span>\r\n                    <span>{{ local "signup.sign_google_link" }}</span>\r\n                </a>\r\n            </div>\r\n            <div class="field">\r\n                <a class="wgt-sqbutton-linkedin" href="/mapi/account/login/linkedin">\r\n                    <span class="icon-icon_B034"></span>\r\n                    <span>{{ local "login.sign_linkedin_btn" }}</span>\r\n                </a>\r\n            </div>\r\n            <div class="field">\r\n                <div class="x-fs-14 x-al-c">{{ local "login.or" }}</div>\r\n            </div>\r\n            <div class="field">\r\n                <label class="x-ff-sm">{{local "signup.email_label"}}</label>\r\n                <div class="input-box">\r\n                    <input name="username" type="text" data-bind="email" value="{{email}}" placeholder="{{local "form.email"}}" maxlength="254">\r\n                </div>\r\n                <span class="error-tip null"> {{local "form_error.email_empty"}} </span>\r\n                <span class="error-tip not-null"> {{local "form_error.email_invalid"}} </span>\r\n            </div>\r\n            <div class="field">\r\n                <label class="x-ff-sm">{{local "form.password"}}</label>\r\n                <div class="input-box">\r\n                    <input name="password" data-bind="new_password" value="{{new_password}}" placeholder="{{local "form.password"}}" type="password"/>\r\n                </div>\r\n                <span class="error-tip null"> {{local "form_error.password_empty"}}</span>\r\n                <span class="error-tip not-null"> {{local "form_error.password_invalid"}}</span>\r\n            </div>\r\n            <div class="field">\r\n                <label>{{local "form.captcha"}}</label>\r\n                <div class="input-box">\r\n                    <input name="captcha" data-bind="captcha" placeholder="{{local "form.type_captcha"}}" type="text"/>\r\n                </div>\r\n                <span class="error-tip null"> {{local "form_error.cannot_be_empty"}}</span>\r\n                <span class="error-tip not-null"> {{local "form_error.cannot_be_empty"}}</span>\r\n            </div>\r\n            <div class="code-bottom">\r\n                <img src="" alt="" class="captcha-img" data-item="img">\r\n                <div class="captcha-icons" style="display:inline-block">\r\n                    <div class="captcha-icon captcha-click" data-feedback="img">\r\n                        <span class="voice-icon icon-icon_B078"></span>\r\n                        <span>{{local "form.new_captcha"}}</span>\r\n                    </div>\r\n                    <div class="captcha-icon captcha-voice" data-feedback="voice">\r\n                        <span class="voice-icon icon-icon_K009"></span>\r\n                        <span>{{local "form.captcha_vision_mpaired"}}</span>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n            <div class="field">\r\n                <div class="x-pt-05">\r\n                    <a class="wgt-sqbutton-black signin">{{local "form.sign_in"}}</a>\r\n                </div>\r\n            </div>\r\n            <div class="field">\r\n                <div class="checkbox-container">\r\n                    {{#if remember_me}}\r\n                        <i class="checkbox checked" data-bind="remember_me"></i>\r\n                    {{else}}\r\n                        <i class="checkbox" data-bind="remember_me"></i>\r\n                    {{/if}}\r\n                    <span>{{local "login.remember_me"}}</span>\r\n                </div>\r\n                <a class="forget-pssd" href="{{forget_pwd}}">{{local "login.forgot_pwd"}}</a>\r\n            </div>\r\n            <div>\r\n                <p class="error-msg"></p>\r\n            </div>\r\n            <div class="field">\r\n                <div class="x-top-line"></div>\r\n            </div>\r\n            <div class="field">\r\n                <div class="x-pb-36 x-fs-12 x-al-c">\r\n                    Page will refresh to reflect updated prices for members\r\n                </div>\r\n            </div>\r\n        </div>\r\n    </div>\r\n</div>'},{}],324:[function(e,i,a){var t=e("backbone.marionette");i.exports=t.ItemView.extend({template:Handlebars.compile(e("./template.hbs")),ui:{confirm:"[data-item='confirm']",cancel:"[data-item='cancel']",lampbox:".book2-lampbox-container"},events:{"click @ui.cancel":function(e){window.location.reload(),e.stopPropagation(),this.destroy()},"click @ui.confirm":function(e){var i=this;if(i.model.get("isToCartError")){var a=i.options.rootState;a.trigger("addShoppingCart",a.getSummary(),!0),e.stopPropagation(),i.destroy()}else e.stopPropagation(),this.destroy()},mousewheel:function(e){e.preventDefault()},DOMMouseScroll:function(e){e.preventDefault()}},serializeData:function(){var e=this;return{isToCartError:e.model.get("isToCartError")}},initialize:function(){},onDestroy:function(){}})},{"./template.hbs":323,"backbone.marionette":6}],323:[function(e,i,a){i.exports='<div class="x-mask x-mask-black">\r\n    <div class="x-al-c x-nowrap book2-vertical">\r\n        <div class="book2-lampbox-container x-al-l x-normal" style="width: 40vw">\r\n            <div class="mm2-rup-header-container">\r\n                <h3 class="mm2-rup-header">{{local \'rup.insufficient_points\'}}</h3>\r\n            </div>\r\n            <div class="mm2-rup-content-container">\r\n                <div class="mm2-rup-content">\r\n                    {{#if isToCartError}}\r\n                        <p class="mm2-rup-content-caption">{{local \'rup.you_have_insufficient\'}}</p>\r\n                    {{else}}\r\n                        <p class="mm2-rup-content-caption">{{local \'rup.you_do_not_have_enough_points\'}}</p>\r\n                    {{/if}}\r\n                </div>\r\n            </div>\r\n            <div class="mm2-rup-content-bottom-container">\r\n                {{#if isToCartError}}\r\n                    <span class="mm2-rup-content-bottom-link" data-item="cancel">{{local \'rup.amend_room\'}}</span>\r\n                {{/if}}\r\n                {{#if isToCartError}}\r\n                    <span class="mm2-gold-button" data-item="confirm">{{local \'general.proceed\'}}</span>\r\n                {{else}}\r\n                    <span class="mm2-gold-button" data-item="confirm">{{local \'general.okay\'}}</span>\r\n                {{/if}}\r\n\r\n            </div>\r\n        </div>\r\n    </div>\r\n</div>'},{}],322:[function(e,i,a){var t=e("backbone.marionette"),r=e("../../../common/scroll");i.exports=t.ItemView.extend({template:Handlebars.compile(e("./template.hbs")),ui:{cancel:"[data-item='cancel']",confirm:"[data-item='confirm']",lampbox:".book2-lampbox-container"},events:{"click @ui.cancel":function(e){e.stopPropagation(),this.__confirmResult=!1,this.destroy()},"click @ui.confirm":function(e){e.stopPropagation(),this.__confirmResult=!0,this.destroy()},click:function(e){this.ui.lampbox.has(e.target).length||this.destroy()},mousewheel:function(e){e.preventDefault()},DOMMouseScroll:function(e){e.preventDefault()}},serializeData:function(){var e=this,i=e.model.toJSON(),a=e.options.rootState,t=i,r=null,n=null,o=null,s=a.getRooms({id:i.categoryid});s.length&&(n=s[0]);var l,c=a.getUpgradeRateByRate({categoryid:i.categoryid,roomtypecode:i.roomtypecode,ratecode:i.ratecode,roomid:i.roomid});r=c&&c.roomrate||t,o=c&&c.roomtype||n,l=c&&c.upgradeddifference;var d=l.days==l.rebuildpricedays,p=l.days>l.rebuildpricedays,m=l.avgtopprice.showwithtax,x=a.isManyDays();return{isManyDays:x,isUseMoney:a.isTrade(a.VIEW_TRADES.USE_MONEY),isUsePoint:a.isTrade(a.VIEW_TRADES.USE_POINT),currency:a.getCurrency(),showWithTax:m,isgeneralupgrade:l.isgeneralupgrade,rebuildpricedays:l.rebuildpricedays,isType1:d,isType2:p,roomName:o&&o.type,bedtype1:t&&t.bedtype,bedtype2:r&&r.bedtype,bedtypeicon1:t&&t.bedtypeicon,bedtypeicon2:r&&r.bedtypeicon,image:o&&(o.imageurl||o.imageurl3),nightContent:d?x?l.rebuildpricedays+" "+i18n.t("general.nights"):l.rebuildpricedays+" "+i18n.t("general.night"):l.rebuildpricedays>1?i18n.t("booking.first_nights").replace("{0}",l.rebuildpricedays):i18n.t("booking.first_night").replace("{0}",l.rebuildpricedays),rateBefore:m?l.avgtopprice.originalavgtopaftertax:l.avgtopprice.originalavgtopbeforetax,rateAfter:m?l.avgtopprice.avgtopaftertax:l.avgtopprice.avgtopbeforetax,rateRemain:m?l.avgtopprice.avglastaftertax:l.avgtopprice.avglastbeforetax,upgradePoints:l.avgtopprice.avgtoppoints,pointsBefore:m?l.avgtoppoints.originalavgtopaftertax:l.avgtoppoints.originalavgtopbeforetax,pointsAfter:m?l.avgtoppoints.avgtopaftertax:l.avgtoppoints.avgtopbeforetax,pointsRemain:m?l.avgtoppoints.avglastaftertax:l.avgtoppoints.avglastbeforetax,upgradedroomadvantage:c.upgradedroomadvantage}},initialize:function(){this.__confirmResult=!1,r.autoCreate(this,{lock:!0})},onDestroy:function(){this.trigger("confirm:result",this.__confirmResult)}})},{"../../../common/scroll":349,"./template.hbs":321,"backbone.marionette":6}],321:[function(e,i,a){i.exports='<div class="x-mask x-mask-black">\r\n    <div class="x-al-c x-nowrap book2-vertical">\r\n        <div class="book2-lampbox-container x-al-l x-normal">\r\n            <div class="mm2-rup-header-container">\r\n                <h3 class="mm2-rup-header">{{local \'rup.use_points_to_upgrade\'}}</h3>\r\n                <span class="icon-icon_B017" data-item="cancel"></span>\r\n            </div>\r\n            <div class="mm2-rup-content-container">\r\n                <div class="x-scroll">\r\n                    <div class="x-scroll-body" style="width: 100%">\r\n                        <div class="mm2-rup-content">\r\n                            <p class="mm2-rup-content-caption">\r\n                                {{#if isgeneralupgrade}}\r\n                                    {{#if isType1}}\r\n                                        {{local \'rup.upgrade_caption_1\'}}\r\n                                    {{/if}}\r\n                                    {{#if isType2}}\r\n                                        {{#ifCond rebuildpricedays \'>\' 1}}\r\n                                            {{local \'rup.upgrade_caption_2\' rebuildpricedays roomName}}\r\n                                        {{else}}\r\n                                            {{local \'rup.upgrade_caption_3\' rebuildpricedays roomName}}\r\n                                        {{/ifCond}}\r\n                                    {{/if}}\r\n                                {{else}}\r\n                                    {{#if isType1}}\r\n                                        {{local \'rup.upgrade_caption_4\' bedtype1 bedtype2}}\r\n                                    {{/if}}\r\n                                    {{#if isType2}}\r\n                                        {{#ifCond rebuildpricedays \'>\' 1}}\r\n                                            {{local \'rup.upgrade_caption_5\' bedtype1 bedtype2 rebuildpricedays roomName}}\r\n                                        {{else}}\r\n                                            {{local \'rup.upgrade_caption_6\' bedtype1 bedtype2 rebuildpricedays roomName}}\r\n                                        {{/ifCond}}\r\n\r\n                                    {{/if}}\r\n                                {{/if}}\r\n                            </p>\r\n                            <div class="mm2-rup-room-content">\r\n                                <div class="mm2-rup-room-content-img" style="background-image: url(\'{{image}}\')">\r\n                                    <div class="mm2-rup-room-content-img-tag">\r\n                                        <span class="icon-icon_R022"></span>\r\n                                        <span>{{local \'checkout.upgraded\'}}</span>\r\n                                    </div>\r\n                                </div>\r\n                                <div class="mm2-rup-room-content-message">\r\n                                    <h4 class="mm2-rup-room-content-message-header">{{roomName}}</h4>\r\n                                    <div class="mm2-rup-room-content-message-bedtype">\r\n                                        <span class="{{bedtypeicon2}}"></span>\r\n                                        <span>{{bedtype2}}</span>\r\n                                        {{#unless isgeneralupgrade}}\r\n                                            <span class="mm2-bedtype-disabled">({{local \'rup.room_unavailable\' bedtype1}})</span>\r\n                                        {{/unless}}\r\n                                    </div>\r\n                                    {{#if upgradedroomadvantage}}\r\n                                        <div class="mm2-rup-room-content-message-bedtype-caption">\r\n                                            {{upgradedroomadvantage}}\r\n                                        </div>\r\n                                    {{/if}}\r\n                                    {{#if isType1}}\r\n                                        <div class="mm2-rup-room-content-message-points-type1">\r\n                                            <p class="mm2-rup-room-content-message-points-title">{{nightContent}}</p>\r\n                                            <div class="mm2-rup-room-content-message-points-compare">\r\n                                                <div class="mm2-rup-room-content-message-points-compare-block">\r\n                                                    {{#if isUseMoney}}\r\n                                                        <div class="mm2-rup-room-content-message-points-compare-block-before">{{currency}} {{price-format rateBefore}}</div>\r\n                                                    {{/if}}\r\n                                                    {{#if isUsePoint}}\r\n                                                        <div class="mm2-rup-room-content-message-points-compare-block-before">{{num-format pointsBefore}}</div>\r\n                                                    {{/if}}\r\n                                                    <div class="mm2-rup-room-content-message-points-compare-block-before-caption">{{local \'rup.per_room_per_night\'}}</div>\r\n                                                </div>\r\n                                                <div class="mm2-rup-room-content-message-points-compare-block">\r\n                                                    {{#if isUseMoney}}\r\n                                                        <div class="mm2-rup-room-content-message-points-compare-block-after">\r\n                                                            {{currency}} {{price-format rateAfter}}<span> + {{num-format upgradePoints}} pts</span>\r\n                                                        </div>\r\n                                                    {{/if}}\r\n                                                    {{#if isUsePoint}}\r\n                                                        <div class="mm2-rup-room-content-message-points-compare-block-after">\r\n                                                            {{num-format pointsAfter}}<span> + {{num-format upgradePoints}} pts</span>\r\n                                                        </div>\r\n                                                    {{/if}}\r\n                                                    <div class="mm2-rup-room-content-message-points-compare-block-after-caption">{{local \'rup.per_room_per_night\'}}</div>\r\n                                                </div>\r\n                                            </div>\r\n                                        </div>\r\n                                    {{/if}}\r\n                                    {{#if isType2}}\r\n                                        <div class="mm2-rup-room-content-message-points-type2">\r\n                                            <div class="mm2-rup-room-content-message-points-type2-left">\r\n                                                <p class="mm2-rup-room-content-message-points-title">{{nightContent}}</p>\r\n                                                <div class="mm2-rup-room-content-message-points-compare">\r\n                                                    <div class="mm2-rup-room-content-message-points-compare-block">\r\n                                                        {{#if isUseMoney}}\r\n                                                            <div class="mm2-rup-room-content-message-points-compare-block-before">{{currency}} {{price-format rateBefore}}</div>\r\n                                                        {{/if}}\r\n                                                        {{#if isUsePoint}}\r\n                                                            <div class="mm2-rup-room-content-message-points-compare-block-before">{{num-format pointsBefore}}</div>\r\n                                                        {{/if}}\r\n                                                        <div class="mm2-rup-room-content-message-points-compare-block-before-caption">{{local \'rup.per_room_per_night\'}}</div>\r\n                                                    </div>\r\n\r\n                                                </div>\r\n                                                <div class="mm2-rup-room-content-message-points-compare">\r\n                                                    <div class="mm2-rup-room-content-message-points-compare-block">\r\n                                                        {{#if isUseMoney}}\r\n                                                            <div class="mm2-rup-room-content-message-points-compare-block-after">\r\n                                                                {{currency}} {{price-format rateAfter}}<span> + {{num-format upgradePoints}} pts</span>\r\n                                                            </div>\r\n                                                        {{/if}}\r\n                                                        {{#if isUsePoint}}\r\n                                                            <div class="mm2-rup-room-content-message-points-compare-block-after">\r\n                                                                {{num-format pointsAfter}}<span> + {{num-format upgradePoints}} pts</span>\r\n                                                            </div>\r\n                                                        {{/if}}\r\n                                                        <div class="mm2-rup-room-content-message-points-compare-block-after-caption">{{local \'rup.per_room_per_night\'}}</div>\r\n                                                    </div>\r\n                                                </div>\r\n                                            </div>\r\n                                            <div class="mm2-rup-room-content-message-points-type2-right">\r\n                                                <p class="mm2-rup-room-content-message-points-title">{{local \'rup.remaining_night\'}}</p>\r\n                                                <div class="mm2-rup-room-content-message-points-compare-block">\r\n                                                    {{#if isUseMoney}}\r\n                                                        <div class="mm2-rup-room-content-message-points-compare-block-after">\r\n                                                            {{currency}} {{price-format rateRemain}}\r\n                                                        </div>\r\n                                                    {{/if}}\r\n                                                    {{#if isUsePoint}}\r\n                                                        <div class="mm2-rup-room-content-message-points-compare-block-after">\r\n                                                            {{price-format pointsRemain}}\r\n                                                        </div>\r\n                                                    {{/if}}\r\n                                                    <div class="mm2-rup-room-content-message-points-compare-block-after-caption">{{local \'rup.per_room_per_night\'}}</div>\r\n                                                </div>\r\n                                            </div>\r\n                                        </div>\r\n                                    {{/if}}\r\n                                </div>\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n                <div class="x-runner">\r\n                    <div class="x-slider"></div>\r\n                </div>\r\n            </div>\r\n            <div class="mm2-rup-content-bottom-container">\r\n                <span class="mm2-rup-content-bottom-link" data-item="cancel">{{local \'general.cancel\'}}</span>\r\n                <span class="mm2-gold-button" data-item="confirm">{{local \'general.confirm\'}}</span>\r\n            </div>\r\n        </div>\r\n    </div>\r\n</div>';
},{}],320:[function(e,i,a){var t=e("underscore"),r=e("backbone.marionette"),n=e("../../../common/scroll"),o=e("../../../06-popping/view"),s=e("../../../common/popup");i.exports=r.ItemView.extend({template:Handlebars.compile(e("./template.hbs")),ui:{close:"[data-item='close']",cancel:"[data-opt='cancel']",affirm:"[data-opt='affirm']",lampbox:".book2-lampbox-container",maxocc1:"[data-item='maxocc1']",maxocc2:"[data-item='maxocc2']"},events:{"click @ui.close":function(e){e.stopPropagation(),this.destroy()},"click @ui.cancel":function(e){e.stopPropagation(),this.__confirmResult=!1,this.destroy()},"click @ui.affirm":function(e){e.stopPropagation(),this.__confirmResult=!0,this.destroy()},click:function(e){this.ui.lampbox.has(e.target).length||this.destroy()},mousewheel:function(e){e.preventDefault()},DOMMouseScroll:function(e){e.preventDefault()},"mouseenter @ui.maxocc1":function(e){e.stopPropagation(),s.addPopupTip(this,o.OCCUPANCY,this.getOccupancy1(),jQuery(e.currentTarget))},"mouseleave @ui.maxocc1":function(e){e.stopPropagation(),s.delPopupTip()},"mouseenter @ui.maxocc2":function(e){e.stopPropagation(),s.addPopupTip(this,o.OCCUPANCY,this.getOccupancy2(),jQuery(e.currentTarget))},"mouseleave @ui.maxocc2":function(e){e.stopPropagation(),s.delPopupTip()}},getOccupancy1:function(){var e=this.serializeData();return{maxocc:e.maxocc1,adultocc:e.adultocc1,childocc:e.childocc1,adults:e.adults1,children:e.children1,maxchildage:e.maxchildage}},getOccupancy2:function(){var e=this.serializeData();return{maxocc:e.maxocc2,adultocc:e.adultocc2,childocc:e.childocc2,adults:e.adults2,children:e.children2,maxchildage:e.maxchildage}},serializeData:function(){var e=this,i=e.model.toJSON(),a=e.options.rootState,r=i,n=null,o=null,s=null,l=a.getRooms({id:i.categoryid});l.length&&(o=l[0]);var c=a.getUpgradeRateByRate({categoryid:i.categoryid,roomtypecode:i.roomtypecode,ratecode:i.ratecode,roomid:i.roomid});n=c&&c.roomrate||r,s=c&&c.roomtype||o;var d=a.getMaxChildAge(),p=d&&(r&&r.maxocc||"0"),m=d&&r&&r.adultocc,x=d&&r&&r.childocc,f=d&&(n&&n.maxocc||"0"),u=d&&n&&n.adultocc,h=d&&n&&n.childocc;return{isManyDays:a.isManyDays(),isUseMoney:a.isTrade(a.VIEW_TRADES.USE_MONEY),isUsePoint:a.isTrade(a.VIEW_TRADES.USE_POINT),currency:a.getCurrency(),type1:o&&o.type,type2:s&&s.type,image1:o&&(o.imageurl3||o.imageurl),image2:s&&(s.imageurl3||s.imageurl),bedtypeicon1:r&&r.bedtypeicon,bedtypeicon2:n&&n.bedtypeicon,bedtype1:r&&r.bedtype,bedtype2:n&&n.bedtype,roomsize1:o&&o.features.roomsize,roomsize2:s&&s.features.roomsize,maxchildage:d,maxocc1:r&&p,adultocc1:r&&m,childocc1:r&&x,maxocc2:n&&f,adultocc2:n&&u,childocc2:n&&h,adults1:t.range(r&&m||0),children1:t.range(r&&x||0),adults2:t.range(n&&u||0),children2:t.range(n&&h||0),hasocc1:!(!r||!m)||!(!r||!x),hasocc2:!(!n||!u)||!(!n||!h),rate1:r&&r.avgdisplaymemberrate,rate2:n&&n.avgdisplaymemberrate,rate3:c&&c.upgradeddifference.originalroomprice.showwithtax?c.upgradeddifference.originalroomprice.finalprice.avgprice.aftertax:c.upgradeddifference.originalroomprice.finalprice.avgprice.beforetax,points1:r&&r.avgdisplaypoints,points2:n&&n.avgdisplaypoints,points3:c&&c.upgradeddifference.originalroomprice.showwithtax?c.upgradeddifference.originalroomprice.finalprice.costpoints.avgaftertax:c.upgradeddifference.originalroomprice.finalprice.costpoints.avgbeforetax}},initialize:function(){this.__confirmResult=!1,n.autoCreate(this,{lock:!0})},onDestroy:function(){this.trigger("confirm:result",this.__confirmResult)}})},{"../../../06-popping/view":343,"../../../common/popup":348,"../../../common/scroll":349,"./template.hbs":319,"backbone.marionette":6,underscore:42}],319:[function(e,i,a){i.exports='<div class="x-mask x-mask-black">\r\n    <div class="x-al-c x-nowrap book2-vertical">\r\n        <div class="book2-lampbox-container x-al-l x-normal" style="width: 700px">\r\n            <div class="book2-lampbox-head">\r\n                <div class="x-flex x-fs-00">\r\n                    <span class="x-cell x-al-l x-di-v-m x-fs-28 x-ff-vb">{{local "booking.bed_type_unavailable"}}</span>\r\n                    <span class="x-cell x-al-r x-di-v-m x-nowrap">\r\n                        <!--<span class="x-di x-di-v-m x-fs-14 x-fc-azure x-pointer x-upper x-ff-m7 x-none" data-item="close">-->\r\n                            <!--Close Text-->\r\n                        <!--</span>-->\r\n                        <!--<span class="x-di x-di-v-m x-fs-24 x-fc-azure x-pointer icon-keep-right x-ml-04" data-item="close"></span>-->\r\n                        <span class="x-di x-di-v-m x-pointer icon-icon_B017" data-item="close"></span>\r\n                    </span>\r\n                </div>\r\n            </div>\r\n            <div class="book2-lampbox-body">\r\n                <div class="x-scroll">\r\n                    <div class="x-scroll-body" style="width: 700px">\r\n                        <div class="x-pl-05 x-pr-05 x-pb-20">\r\n                            <div class="x-pl-20 x-pr-20">\r\n                                <div class="x-pt-20 x-pb-20">\r\n                                    <p class="x-ff-sm" style="font-size: 18px; line-height: 26px">{{local "booking.your_preferred_bed_type"}}</p>\r\n                                </div>\r\n                                <div class="x-pt-10 x-pb-20 x-pl-10 x-pr-10 x-fs-00 x-nowrap">\r\n                                    <div class="book2-upgrade-price-child x-di x-di-v-t x-normal x-pl-20 x-pr-20" style="width: 50%; color: #868686;">\r\n                                        <div class="x-pl-20 x-pr-20">\r\n                                            <div class="x-img x-img-top" style="height: 120px; background-image: url(\'{{image1}}\')">\r\n                                                <span class="x-fs-12 x-ff-m7 x-lh-24 x-pl-08 x-pr-08 x-di x-di-v-t x-upper x-nowrap x-fc-white" style="background-color: #000;">{{local "booking.before"}}</span>\r\n                                            </div>\r\n                                            <div class="x-mt-20 x-fs-22 x-lh-24 x-ff-wb">{{type1}}</div>\r\n                                            <div class="x-mt-13">\r\n                                                <span class="x-fs-16 x-di x-di-v-m {{bedtypeicon1}}"></span>\r\n                                                <span class="x-fs-16 x-di x-di-v-m x-ff-sm x-ml-06">{{bedtype1}}</span>\r\n                                            </div>\r\n                                            {{#if roomsize1}}\r\n                                                <div class="x-mt-10">\r\n                                                    <span class="x-fs-16 x-di x-di-v-m icon-icon_I016"></span>\r\n                                                    <span class="x-fs-16 x-di x-di-v-m x-ff-sm x-ml-06 x-nowrap">{{{specialSymbolFix roomsize1}}}</span>\r\n                                                </div>\r\n                                            {{/if}}\r\n                                            <div class="x-mt-10">\r\n                                                {{#if adults1.length}}\r\n                                                    {{#each adults1}}\r\n                                                        <span class="x-fs-16 x-di x-di-v-m icon-icon_J013"></span>\r\n                                                    {{/each}}\r\n                                                    {{#equal adults1.length 1}}\r\n                                                        <span class="x-fs-16 x-di x-di-v-m x-ff-sm x-ml-06">{{local "booking.adult"}}</span>\r\n                                                    {{else}}\r\n                                                        <span class="x-fs-16 x-di x-di-v-m x-ff-sm x-ml-06">{{local "booking.adults"}}</span>\r\n                                                    {{/equal}}\r\n                                                    <span class="x-di x-di-v-m x-ml-06"></span>\r\n                                                {{/if}}\r\n                                                {{#if children2.length}}\r\n                                                    {{#each children2}}\r\n                                                        <span class="x-fs-16 x-di x-di-v-m icon-icon_J012"></span>\r\n                                                    {{/each}}\r\n                                                    {{#equal children2.length 1}}\r\n                                                        <span class="x-fs-16 x-di x-di-v-m x-ff-sm x-ml-06">{{local "booking.child"}}</span>\r\n                                                    {{else}}\r\n                                                        <span class="x-fs-16 x-di x-di-v-m x-ff-sm x-ml-06">{{local "booking.children"}}</span>\r\n                                                    {{/equal}}\r\n                                                {{/if}}\r\n                                                {{#if hasocc1}}\r\n                                                    <span class="x-di x-di-v-m x-fs-16 x-ml-06 x-default x-popup icon-icon_B008" data-item="maxocc1"></span>\r\n                                                {{/if}}\r\n                                            </div>\r\n                                            <div class="x-mt-23" style="height: 20px; line-height: 20px">\r\n\r\n                                            </div>\r\n                                            <div class="x-mt-04">\r\n                                                {{#if isUseMoney}}\r\n                                                    <div>\r\n                                                        <span class="x-fs-18 x-ff-wb x-di-v-b">{{currency}} {{price-format rate1}}</span>\r\n                                                        <span class="x-fs-12 x-ff-mh x-di-v-b">&nbsp;{{#if isManyDays}}{{local "Property.avg_night"}}{{else}}/{{local "general.avg_night"}}{{/if}}</span>\r\n                                                    </div>\r\n                                                {{/if}}\r\n                                                {{#if isUsePoint}}\r\n                                                    <div>\r\n                                                        <span class="x-fs-18 x-ff-wb x-di-v-b">{{num-format points1}} {{local "checkout.points"}}</span>\r\n                                                        <span class="x-fs-12 x-ff-mh x-di-v-b">&nbsp;{{#if isManyDays}}{{local "Property.avg_night"}}{{else}}/{{local "general.avg_night"}}{{/if}}</span>\r\n                                                    </div>\r\n                                                {{/if}}\r\n                                            </div>\r\n                                        </div>\r\n                                    </div>\r\n                                    <div class="book2-upgrade-price-child x-di x-di-v-t x-normal x-pl-20 x-pr-20" style="width: 50%">\r\n                                        <div class="x-pl-20 x-pr-20">\r\n                                            <div class="x-img x-img-top" style="height: 120px; background-image: url(\'{{image2}}\')">\r\n                                                <span class="x-fs-20 x-ff-m7 x-lh-24 x-pl-08 x-di x-di-v-t x-upper x-nowrap x-bc-azure x-fc-white icon-icon_J015"></span>\r\n                                                <span class="x-fs-12 x-ff-m7 x-lh-24 x-pl-08 x-pr-08 x-di x-di-v-t x-upper x-nowrap x-bc-azure x-fc-white">{{local "booking.upgraded"}}</span>\r\n                                            </div>\r\n                                            <div class=" x-mt-20 x-fs-22 x-lh-24 x-ff-wb">{{type2}}</div>\r\n                                            <div class="x-mt-13">\r\n                                                <span class="x-fs-16 x-di x-di-v-m {{bedtypeicon2}}"></span>\r\n                                                <span class="x-fs-16 x-di x-di-v-m x-ff-sm x-ml-06">{{bedtype2}}</span>\r\n                                            </div>\r\n                                            {{#if roomsize2}}\r\n                                                <div class="x-mt-10">\r\n                                                    <span class="x-fs-16 x-di x-di-v-m icon-icon_I016"></span>\r\n                                                    <span class="x-fs-16 x-di x-di-v-m x-ff-sm x-ml-06 x-nowrap">{{{specialSymbolFix roomsize2}}}</span>\r\n                                                </div>\r\n                                            {{/if}}\r\n                                            <div class="x-mt-10">\r\n                                                {{#if adults2.length}}\r\n                                                    {{#each adults2}}\r\n                                                        <span class="x-fs-16 x-di x-di-v-m icon-icon_J013"></span>\r\n                                                    {{/each}}\r\n                                                    {{#equal adults2.length 1}}\r\n                                                        <span class="x-fs-16 x-di x-di-v-m x-ff-sm x-ml-06">{{local "booking.adult"}}</span>\r\n                                                    {{else}}\r\n                                                        <span class="x-fs-16 x-di x-di-v-m x-ff-sm x-ml-06">{{local "booking.adults"}}</span>\r\n                                                    {{/equal}}\r\n                                                    <span class="x-di x-di-v-m x-ml-06"></span>\r\n                                                {{/if}}\r\n                                                {{#if children2.length}}\r\n                                                    {{#each children2}}\r\n                                                        <span class="x-fs-16 x-di x-di-v-m icon-icon_J012"></span>\r\n                                                    {{/each}}\r\n                                                    {{#equal children2.length 1}}\r\n                                                        <span class="x-fs-16 x-di x-di-v-m x-ff-sm x-ml-06">{{local "booking.child"}}</span>\r\n                                                    {{else}}\r\n                                                        <span class="x-fs-16 x-di x-di-v-m x-ff-sm x-ml-06">{{local "booking.children"}}</span>\r\n                                                    {{/equal}}\r\n                                                {{/if}}\r\n                                                {{#if hasocc2}}\r\n                                                    <span class="x-di x-di-v-m x-fs-16 x-ml-06 x-default x-popup icon-icon_B008" data-item="maxocc2"></span>\r\n                                                {{/if}}\r\n                                            </div>\r\n                                            <div class="x-mt-23" style="height: 20px; line-height: 20px; color: #ACACAC;">\r\n                                                {{#if isUseMoney}}\r\n                                                    <div class="x-fs-16 x-ff-wm x-through">{{currency}} {{price-format rate3}}</div>\r\n                                                {{/if}}\r\n                                                {{#if isUsePoint}}\r\n                                                    <div class="x-fs-16 x-ff-wm x-through">{{num-format points3}} {{local "checkout.points"}}</div>\r\n                                                {{/if}}\r\n                                            </div>\r\n                                            <div class="x-mt-04">\r\n                                                {{#if isUseMoney}}\r\n                                                    <div>\r\n                                                        <span class="x-fs-18 x-ff-wb x-di-v-b">{{currency}} {{price-format rate2}}</span>\r\n                                                        <span class="x-fs-12 x-ff-mh x-di-v-b">&nbsp;{{#if isManyDays}}{{local "Property.avg_night"}}{{else}}/{{local "general.avg_night"}}{{/if}}</span>\r\n                                                    </div>\r\n                                                {{/if}}\r\n                                                {{#if isUsePoint}}\r\n                                                    <div>\r\n                                                        <span class="x-fs-18 x-ff-wb x-di-v-b">{{num-format points2}} {{local "checkout.points"}}</span>\r\n                                                        <span class="x-fs-12 x-ff-mh x-di-v-b">&nbsp;{{#if isManyDays}}{{local "Property.avg_night"}}{{else}}/{{local "general.avg_night"}}{{/if}}</span>\r\n                                                    </div>\r\n                                                {{/if}}\r\n                                            </div>\r\n                                        </div>\r\n                                    </div>\r\n                                </div>\r\n                                <div class="x-pt-20 x-pb-20 x-al-c">\r\n                                    <button class="x-fs-14 x-ff-mh x-btn x-btn-vague" data-opt="cancel" style="width: 260px; letter-spacing: 1px;">{{local "booking.cancel_upgrade"}}</button>\r\n                                    <button class="x-fs-14 x-ff-mh x-btn x-btn-azure" data-opt="affirm" style="width: 260px; letter-spacing: 1px; margin-left: 30px;">{{local "booking.continue_with_booking"}}</button>\r\n                                </div>\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n                <div class="x-runner">\r\n                    <div class="x-slider"></div>\r\n                </div>\r\n            </div>\r\n        </div>\r\n    </div>\r\n</div>'},{}],318:[function(e,i,a){var t=e("backbone.marionette"),r=e("../../../common/scroll");i.exports=t.ItemView.extend({template:Handlebars.compile(e("./template.hbs")),ui:{close:"[data-item='close']",cancel:"[data-opt='cancel']",affirm:"[data-opt='affirm']",lampbox:".book2-lampbox-container"},events:{"click @ui.close":function(e){e.stopPropagation(),this.destroy()},"click @ui.cancel":function(e){e.stopPropagation(),this.__confirmResult=!1,this.destroy()},"click @ui.affirm":function(e){e.stopPropagation(),this.__confirmResult=!0,this.destroy()},click:function(e){this.ui.lampbox.has(e.target).length||this.destroy()},mousewheel:function(e){e.preventDefault()},DOMMouseScroll:function(e){e.preventDefault()}},serializeData:function(){var e=this,i=null,a=e.model.toJSON(),t=e.options.rootState,r=t.getRooms({id:a.categoryid});r.length&&(i=r[0]);var n,o=t.getUpgradeRateByRate({categoryid:a.categoryid,roomtypecode:a.roomtypecode,ratecode:a.ratecode,roomid:a.roomid});return a=o&&o.roomrate||a,i=o&&o.roomtype||i,n=o&&o.upgradeddifference,{isManyDays:t.isManyDays(),isUseMoney:t.isTrade(t.VIEW_TRADES.USE_MONEY),isUsePoint:t.isTrade(t.VIEW_TRADES.USE_POINT),currency:n&&n.currency||t.getCurrency(),type:i&&i.type,image:i&&(i.imageurl3||i.imageurl),rebuildpricedays:n&&n.rebuildpricedays,remainingdays:n&&n.days-n.rebuildpricedays,rate1:n&&(n.avgtopprice.showwithtax?n.avgtopprice.avgtopaftertaxupgraded:n.avgtopprice.avgtopbeforetaxupgraded),rate2:n&&(n.avgtopprice.showwithtax?n.avgtopprice.avglastaftertax:n.avgtopprice.avglastbeforetax),rate3:n&&(n.avgtopprice.showwithtax?n.avgtopprice.savedaftertaxupgraded:n.avgtopprice.savedbeforetaxupgraded),rate4:n&&(n.avgtopprice.showwithtax?n.avgtopprice.avgtopaftertax:n.avgtopprice.avgtopbeforetax),points1:0,points2:0,points3:0,points4:0}},initialize:function(){this.__confirmResult=!1,r.autoCreate(this,{lock:!0})},onDestroy:function(){this.trigger("confirm:result",this.__confirmResult)}})},{"../../../common/scroll":349,"./template.hbs":317,"backbone.marionette":6}],317:[function(e,i,a){i.exports='<div class="x-mask x-mask-black">\r\n    <div class="x-al-c x-nowrap book2-vertical">\r\n        <div class="book2-lampbox-container x-al-l x-normal" style="width: 750px">\r\n            <div class="book2-lampbox-head">\r\n                <div class="x-flex x-fs-00">\r\n                    <span class="x-cell x-al-l x-di-v-m x-fs-28 x-ff-vb">{{local "booking.room_upgrade_voucher_applied"}}</span>\r\n                    <span class="x-cell x-al-r x-di-v-m x-nowrap">\r\n                        <!--<span class="x-di x-di-v-m x-fs-14 x-fc-azure x-pointer x-upper x-ff-m7 x-none" data-item="close">-->\r\n                            <!--Close Text-->\r\n                        <!--</span>-->\r\n                        <!--<span class="x-di x-di-v-m x-fs-24 x-fc-azure x-pointer icon-keep-right x-ml-04" data-item="close"></span>-->\r\n                        <span class="x-di x-di-v-m x-pointer icon-icon_B017" data-item="close"></span>\r\n                    </span>\r\n                </div>\r\n            </div>\r\n            <div class="book2-lampbox-body">\r\n                <div class="x-scroll">\r\n                    <div class="x-scroll-body" style="width: 750px">\r\n                        <div class="x-pl-10 x-pr-10">\r\n                            <div class="x-pl-20 x-pr-20 x-pb-20">\r\n                                <div class="x-pt-20 x-pb-20">\r\n                                    <p class="x-ff-sm" style="font-size: 18px; line-height: 26px">{{{local "booking.you_room_upgrade_voucher_has_applied"}}}</p>\r\n                                </div>\r\n                                <div class="x-pt-10 x-pb-20 x-fs-00 x-nowrap">\r\n                                    <div class="x-di x-di-v-t x-img x-img-top" style="width: 140px; height: 100px; background-image: url(\'{{image}}\')">\r\n                                        <span class="x-fs-20 x-ff-m7 x-lh-24 x-pl-08 x-di x-di-v-t x-upper x-nowrap x-bc-azure x-fc-white icon-icon_J015"></span>\r\n                                        <span class="x-fs-12 x-ff-m7 x-lh-24 x-pl-08 x-pr-08 x-di x-di-v-t x-upper x-nowrap x-bc-azure x-fc-white">{{local "booking.upgraded"}}</span>\r\n                                    </div>\r\n                                    <div class="x-di x-di-v-t x-ml-23" style="width: calc(100% - 163px);">\r\n                                        <div class="x-ff-wb" style="font-size: 24px; line-height: 29px; padding-bottom: 30px;">{{type}}</div>\r\n                                        <div style="height: 82px">\r\n                                            <div class="book2-upgrade-price-child x-di x-di-v-t x-normal">\r\n                                                <div class="x-fs-12 x-ff-m7 x-upper">{{local "booking.first_nights" rebuildpricedays}}</div>\r\n                                                {{#if isUseMoney}}\r\n                                                    <div class="x-pt-20 x-fs-16 x-ff-wm" style="color: #acacac; text-decoration: line-through">{{currency}} {{price-format rate4}}</div>\r\n                                                {{/if}}\r\n                                                {{#if isUsePoint}}\r\n                                                    <div class="x-pt-20 x-fs-16 x-ff-wm" style="color: #acacac; text-decoration: line-through">{{num-format points4}} {{local "checkout.points"}}</div>\r\n                                                {{/if}}\r\n                                                <div class="x-fs-12 x-ff-mh x-pt-05" style="color: #acacac;">{{local "Property.avg_night"}}</div>\r\n                                            </div>\r\n                                            <div class="book2-upgrade-price-child x-di x-di-v-t x-normal x-pl-20">\r\n                                                <div class="x-fs-12 x-ff-m7 x-upper">{{local "booking.remaining_nights" remainingdays}}</div>\r\n                                            </div>\r\n                                            <div class="book2-upgrade-price-child x-di x-di-v-t x-normal x-pl-20">\r\n                                                <div class="x-ff-wm" style="font-size: 16px; line-height: 24px;">{{local "booking.your_upgrade_voucher_saved_you"}}:</div>\r\n                                            </div>\r\n                                        </div>\r\n                                        <div style="height: 42px">\r\n                                            <div class="book2-upgrade-price-child x-di x-di-v-t x-normal">\r\n                                                {{#if isUseMoney}}\r\n                                                    <div class="x-fs-16 x-ff-wb">{{currency}} {{price-format rate1}}</div>\r\n                                                {{/if}}\r\n                                                {{#if isUsePoint}}\r\n                                                    <div class="x-fs-16 x-ff-wb">{{num-format points1}} {{local "checkout.points"}}</div>\r\n                                                {{/if}}\r\n                                                <div class="x-fs-12 x-ff-mh x-pt-05">{{local "Property.avg_night"}}</div>\r\n                                            </div>\r\n                                            <div class="book2-upgrade-price-child x-di x-di-v-t x-normal x-pl-20">\r\n                                                {{#if isUseMoney}}\r\n                                                    <div class="x-fs-16 x-ff-wm">{{currency}} {{price-format rate2}}</div>\r\n                                                {{/if}}\r\n                                                {{#if isUsePoint}}\r\n                                                    <div class="x-fs-16 x-ff-wm">{{num-format points2}} {{local "checkout.points"}}</div>\r\n                                                {{/if}}\r\n                                                <div class="x-fs-12 x-ff-mh x-pt-05">{{local "Property.avg_night"}}</div>\r\n                                            </div>\r\n                                            <div class="book2-upgrade-price-child x-di x-di-v-t x-normal x-pl-20">\r\n                                                {{#if isUseMoney}}\r\n                                                    <div class="x-fs-20 x-ff-mh x-fc-azure">{{currency}} {{price-format rate3}}</div>\r\n                                                {{/if}}\r\n                                                {{#if isUsePoint}}\r\n                                                    <div class="x-fs-20 x-ff-mh x-fc-azure">{{num-format points3}} {{local "checkout.points"}}</div>\r\n                                                {{/if}}\r\n                                            </div>\r\n                                        </div>\r\n                                    </div>\r\n                                </div>\r\n                                <div class="x-pt-20 x-pb-20 x-al-c">\r\n                                    <button class="x-fs-14 x-ff-mh x-btn x-btn-vague" data-opt="cancel" style="width: 260px; letter-spacing: 1px;">{{local "booking.cancel_upgrade"}}</button>\r\n                                    <button class="x-fs-14 x-ff-mh x-btn x-btn-azure" data-opt="affirm" style="width: 260px; letter-spacing: 1px; margin-left: 30px;">{{local "booking.continue_with_booking"}}</button>\r\n                                </div>\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n                <div class="x-runner">\r\n                    <div class="x-slider"></div>\r\n                </div>\r\n            </div>\r\n        </div>\r\n    </div>\r\n</div>'},{}],306:[function(e,i,a){var t=e("backbone.marionette"),r=e("./01-caption/view"),n=e("./02-toolbar/view"),o=e("./03-content/01-view-by-city/view"),s=e("./03-content/02-view-by-maps/view"),l=e("./03-content/03-view-by-room/view"),c=e("./03-content/04-view-by-rate/view"),d=e("./03-content/06-view-by-all/view"),p=e("./03-content/05-view-by-ratecalendar/view"),m=e("./04-invalid/view");i.exports=t.LayoutView.extend({template:Handlebars.compile(e("./template.hbs")),regions:{caption:".book2-caption",toolbar:".book2-toolbar",content:".book2-content"},initialize:function(){var e=this.options.rootState;this.__renderDeferred=jQuery.Deferred(),this.listenTo(e,"showCaptionView",this.showCaptionView),this.listenTo(e,"showToolbarView",this.showToolbarView),this.listenTo(e,"showContentCity",this.showContentCity),this.listenTo(e,"showContentMaps",this.showContentMaps),this.listenTo(e,"showContentRoom",this.showContentRoom),this.listenTo(e,"showContentRate",this.showContentRate),this.listenTo(e,"showContentAll",this.showContentAll),this.listenTo(e,"showContentRateCalendar",this.showContentRateCalendar),this.listenTo(e,"showInvalidView",this.showInvalidView)},onRender:function(){this.__renderDeferred.resolve()},showCaptionView:function(e){return this.__renderDeferred.then(jQuery.proxy(this.__showCaptionView,this,e))},showToolbarView:function(e){return this.__renderDeferred.then(jQuery.proxy(this.__showToolbarView,this,e))},showContentCity:function(e){return this.__renderDeferred.then(jQuery.proxy(this.__showContentCity,this,e))},showContentMaps:function(e){return this.__renderDeferred.then(jQuery.proxy(this.__showContentMaps,this,e))},showContentRoom:function(e){return this.__renderDeferred.then(jQuery.proxy(this.__showContentRoom,this,e))},showContentRate:function(e){return this.__renderDeferred.then(jQuery.proxy(this.__showContentRate,this,e))},showContentAll:function(e){return this.__renderDeferred.then(jQuery.proxy(this.__showContentAll,this,e))},showContentRateCalendar:function(e){return this.__renderDeferred.then(jQuery.proxy(this.__showContentRateCalendar,this,e))},showInvalidView:function(e){return this.__renderDeferred.then(jQuery.proxy(this.__showInvalidView,this,e))},__showCaptionView:function(){this.getRegion("caption").show(new r({rootState:this.options.rootState}))},__showToolbarView:function(){this.getRegion("toolbar").show(new n({rootState:this.options.rootState}))},__showContentCity:function(){this.getRegion("content").show(new o({rootState:this.options.rootState}))},__showContentMaps:function(){this.getRegion("content").show(new s({rootState:this.options.rootState}))},__showContentRoom:function(){this.getRegion("content").show(new l({rootState:this.options.rootState}))},__showContentRate:function(){this.getRegion("content").show(new c({rootState:this.options.rootState}))},__showContentAll:function(){this.getRegion("content").show(new d({rootState:this.options.rootState}))},__showContentRateCalendar:function(){this.getRegion("content").show(new p({rootState:this.options.rootState}))},__showInvalidView:function(){this.getRegion("content").show(new m({rootState:this.options.rootState}))}})},{"./01-caption/view":239,"./02-toolbar/view":241,"./03-content/01-view-by-city/view":246,"./03-content/02-view-by-maps/view":250,"./03-content/03-view-by-room/view":268,"./03-content/04-view-by-rate/view":280,"./03-content/05-view-by-ratecalendar/view":285,"./03-content/06-view-by-all/view":303,"./04-invalid/view":304,"./template.hbs":305,"backbone.marionette":6}],305:[function(e,i,a){i.exports='<div class="book2-caption"></div>\r\n<div class="book2-toolbar"></div>\r\n<div class="book2-content"></div>'},{}],304:[function(e,i,a){i.exports=e("../03-content/01-view-by-city/empty/view")},{"../03-content/01-view-by-city/empty/view":245}],303:[function(e,i,a){var t=e("underscore"),r=e("backbone"),n=e("backbone.marionette"),o=e("./child/view"),s=e("./empty/view");i.exports=n.CollectionView.extend({childView:o,emptyView:s,className:"book2-content-section",childViewOptions:function(e,i){return{model:e,index:i,rootState:this.options.rootState}},initialize:function(){var e=this,i=e.options.rootState,a=i.getParam().code,n=i.getRooms({hotelcode:a});n=t.where(n,{availability:!0}),n=t.sortBy(n,function(e){var a=e.id;return a===i.getParam().defaultRoomInAll?-1:t.findIndex(n,{
id:a})}),e.collection=new r.Collection(n),e.collection.comparator=function(e){var a=e.get("id");return a===i.getParam().defaultRoomInAll?-1:t.findIndex(n,{id:a})},e.listenTo(i,"showSummaryView",e.__changeIndex),0==n.length&&(i.trigger("changeViewStyle",i.VIEW_STYLES.HOTEL_BY_ROOM),setTimeout(function(){jQuery(".book2-toolbar-section [data-item='all']").prop("disabled",!0).css({cursor:"not-allowed"})},100))},onRender:function(){this.__defaultExpandChildView()},__changeIndex:function(){var e=this,i=e.collection,a=e.options.rootState,t=a.getParam().defaultRoomInAll,r=i.findWhere({id:t});if(r)if(i.indexOf(r)>0)i.sort();else{var n=e.children.findByModel(r);n&&n.render()}},__defaultExpandChildView:function(){var e=this,i=e.collection,a=e.options.rootState,t=a.getParam().defaultRoomInAll,r=null;a.isFinal()&&i.length&&(t&&(r=i.findWhere({id:t,availability:!0})),r||(r=i.findWhere({availability:!0})),r&&a.trigger("loadStaysInAll",{categoryid:r.get("id")}))}})},{"./child/view":300,"./empty/view":302,backbone:8,"backbone.marionette":6,underscore:42}],302:[function(e,i,a){var t=e("backbone.marionette");i.exports=t.ItemView.extend({template:Handlebars.compile(e("./template.hbs")),serializeData:function(){return{disablereservation:this.options.rootState.getHotel().disablereservation}},onRender:function(){},onDestroy:function(){}})},{"./template.hbs":301,"backbone.marionette":6}],301:[function(e,i,a){i.exports='{{#if disablereservation}}\r\n    <div class="x-fs-20 x-lh-25 x-al-c" style="padding: 4em">{{local "booking.disable_reservation"}}</div>\r\n{{else}}\r\n    <div class="x-fs-20 x-lh-25 x-al-c" style="padding: 4em">{{local "Property.no_room_avaliable"}}</div>\r\n{{/if}}'},{}],300:[function(e,i,a){var t=(e("underscore"),e("backbone")),r=e("backbone.marionette"),n=e("./01-room/view"),o=e("./02-stay/view"),s=e("./03-ratelist/view"),l=e("../../../../06-popping/view"),c=e("../../../../common/popup"),d=!1;i.exports=r.LayoutView.extend({template:Handlebars.compile(e("./template.hbs")),regions:{room:"[data-region='room']",stay:"[data-region='stay']",rate:"[data-region='rate']",list:"[data-region='list']"},ui:{highlight:".x-highlight",differ:"[data-item='differ']",voucherBox:"[data-item='voucherBox']",voucherTip:"[data-item='voucherTip']",voucherTxt:"[data-item='voucherTxt']",voucherText:"[data-item='voucherText']",sales:"[data-item='sales']",close:"[data-item='close']"},events:{"click @ui.close":function(){this.options.rootState.SALES_SHOW=!0,this.ui.sales.hide()},"click @ui.voucherBox":function(){var e=this,i=e.model.toJSON(),a=e.options.rootState,t=a.getAllah({categoryid:i.id,byAll:!0});t&&(t.voucherusage?(a.trigger("turnUpgradeRate",{categoryid:t.categoryid,roomtypecode:t.roomtypecode,ratecode:t.ratecode,roomid:t.roomid,voucherusage:!1}),a.trigger("expandChildView",t,!0)):(a.setIGPointsWhenRup(a.getIGPoints()),a.trigger("loadUpgradeRate",t)))},"mouseenter @ui.voucherTip":function(e){e.stopPropagation(),c.addPopupTip(this,l.VOUCHER,this.serializeData(),jQuery(e.currentTarget),!1,!1,!0)},"mouseleave @ui.voucherTip":function(e){e.stopPropagation(),c.delPopupTip()}},serializeData:function(){var e,i,a=this,t=a.model.toJSON(),r=a.options.rootState,n=r.getHotel(),o=t.differentiator,s=r.getAllah({categoryid:t.id,byAll:!0}),l=s&&s.roomupgradeavailabled;return s&&s.voucherusage&&(i=r.getUpgradeRateByRate({categoryid:s.categoryid,roomtypecode:s.roomtypecode,ratecode:s.ratecode,roomid:s.roomid}),e=i&&i.roomtype),{bookingflowgreenbarcontent:n&&n.bookingflowgreenbarcontent,isUseMoney:r.isTrade(r.VIEW_TRADES.USE_MONEY),isUsePoint:r.isTrade(r.VIEW_TRADES.USE_POINT),id:t.id,expandAll:o||l,differentiator:o,vouchervisible:l,voucherusage:s&&s.voucherusage,originRoomName:t&&t.type,targetRoomName:e&&e.type,upgradeObject:i}},initialize:function(){var e=this.options.rootState;this.__renderDeferred=jQuery.Deferred(),this.firstRender=!0,this.listenTo(e,"expandSelfView",this.expandChildView),this.listenTo(e,"expandPopupView",this.expandPopupView),this.listenTo(e,"hiddenPopupView",this.hiddenPopupView),this.listenTo(e,"redrawStay",this.showStayViewByChangeTrade),this.listenTo(e,"turnUpgradeRate",this.turnUpgradeRate),this.listenTo(e,"showUpgradeTip",this.showUpgradeTip)},onRender:function(){this.__showRoomView(!1),this.__renderDeferred.resolve()},expandChildView:function(e,i){return this.__renderDeferred.then(jQuery.proxy(this.__expandChildView,this,e,i))},expandPopupView:function(e){return this.__renderDeferred.then(jQuery.proxy(this.__expandPopupView,this,e))},hiddenPopupView:function(e){return this.__renderDeferred.then(jQuery.proxy(this.__hiddenPopupView,this,e))},showStayViewByChangeTrade:function(){return this.__renderDeferred.then(jQuery.proxy(this.__showStayViewByChangeTrade,this))},turnUpgradeRate:function(e){return this.__renderDeferred.then(jQuery.proxy(this.__turnUpgradeRate,this,e))},showUpgradeTip:function(e){return this.__renderDeferred.then(jQuery.proxy(this.__showUpgradeTip,this,e))},__expandChildView:function(e,i){var a=this.options.rootState;i?this.model.get("id")===a.getParam().defaultRoomInAll?(this.__holdHighlight(),this.__hideSalesItem(),this.__showRoomView(!0),this.__showStayView(!0)):(this.__freeHighlight(),this.__showRoomView(!1),this.__hideStayView()):this.model.get("id")===e.categoryid?(this.__holdHighlight(),this.__hideSalesItem(),this.__showRoomView(!0),this.__showStayView(!0)):(this.__freeHighlight(),this.__showRoomView(!1),this.__hideStayView())},__expandPopupView:function(e){this.model.get("id")===e.categoryid?(this.__showRoomView(!0),this.__showStayView(!1)):(this.__showRoomView(!1),this.__hideStayView())},__hiddenPopupView:function(e){this.model.get("id")===e.categoryid?(this.__showRoomView(!0),this.__showStayView(!0)):(this.__showRoomView(!1),this.__hideStayView())},__showRoomView:function(e){this.getRegion("room").show(new n({model:this.model,rootState:this.options.rootState,openPopupView:this.getRegion("rate").hasView(),expandAll:e}))},__showListView:function(){var e=this,i=e.model.get("id"),a=e.options.rootState,r=a.getAllah({categoryid:i,byAll:!0});this.getRegion("list").show(new s({model:r?new t.Model(r):null,rootState:a}))},__showStayViewByChangeTrade:function(){(this.getRegion("stay")&&this.getRegion("stay").hasView()||this.stayRegion&&this.stayRegion.hasView())&&this.__showStayView(!0)},__showStayView:function(e){var i=this,a=i.model.get("id"),n=i.options.rootState,s=n.getAllah({categoryid:a,byAll:!0}),l={};s&&s.voucherusage&&(l=n.getUpgradeRateByRate({categoryid:s.categoryid,roomtypecode:s.roomtypecode,ratecode:s.ratecode,roomid:s.roomid}),l&&l.roomrate&&(s=l.roomrate||s)),this.firstRender&&this.getRegion("stay")?(this.getRegion("stay").show(new o({model:s?new t.Model(s):null,rootState:n,expandAll:e&&!this.getRegion("rate").hasView()})),this.firstRender=!1):(this.stayRegion=new r.Region({el:jQuery('[data-region="stay"]').get(0)}),this.stayRegion.show(new o({model:s?new t.Model(s):null,rootState:n,expandAll:e&&!this.getRegion("rate").hasView()})))},__hideStayView:function(){jQuery("[data-region='stay']").html()},__holdHighlight:function(){this.ui.differ.show(),this.ui.highlight.addClass("holds")},__freeHighlight:function(){this.ui.differ.hide(),this.ui.highlight.removeClass("holds")},__hideSalesItem:function(){var e=this,i=e.options.rootState;i.isFirstLoad()&&!i.SALES_SHOW?e.ui.sales.css("display","table"):e.ui.sales.css("display","none")},__turnUpgradeRate:function(e){var i=this,a=i.model.toJSON(),t=i.options.rootState,r=t.getAllah({categoryid:a.id,byAll:!0});r&&r.categoryid===e.categoryid&&r.roomtypecode===e.roomtypecode&&r.ratecode===e.ratecode&&r.roomid===e.roomid&&(t.changeRateValue(e),e.voucherusage?(i.ui.voucherBox.addClass("checked"),i.ui.voucherText.text(i18n.t("rup.room_upgraded"))):(i.ui.voucherBox.removeClass("checked"),i.ui.voucherText.text(i18n.t("rup.use_points_to_upgrade"))),i.__updateVoucherTxt())},__showUpgradeTip:function(){var e=this;if(e.serializeData().vouchervisible){if(d)return;d=!0,e.ui.voucherTip.length&&e.ui.voucherTip[0].clientHeight&&e.ui.voucherTip.finish().trigger("mouseenter").delay(5e3).queue(function(){jQuery(this).trigger("mouseleave").dequeue()})}},__updateVoucherTxt:function(){}})},{"../../../../06-popping/view":343,"../../../../common/popup":348,"./01-room/view":289,"./02-stay/view":293,"./03-ratelist/view":298,"./template.hbs":299,backbone:8,"backbone.marionette":6,underscore:42}],299:[function(e,i,a){i.exports='<div class="x-mt-13 x-ff-00 x-pl-20 x-pr-20 x-pt-13 x-pb-13 x-flex x-bc-green" style="display: none" data-item="sales">\r\n    <div class="x-cell x-al-l">\r\n        <span class="x-fs-14 x-fc-white x-di x-di-v-m">{{#if bookingflowgreenbarcontent}}{{bookingflowgreenbarcontent}}{{else}}{{local "booking.epic_sales"}}{{/if}}</span>\r\n    </div>\r\n    <div class="x-cell x-al-r">\r\n        <span class="x-fs-24 x-fc-white x-di x-di-v-m x-pointer icon-icon_B017" data-item="close"></span>\r\n    </div>\r\n</div>\r\n\r\n<div class="x-mt-13" data-id="{{id}}"></div>\r\n\r\n{{#if expandAll}}\r\n    <div class="x-pl-20 x-pr-20 x-pt-17 x-pb-17 x-bc-azure x-hide" data-item="differ">\r\n        <div class="x-flex x-fs-00">\r\n            <div class="x-cell x-al-l x-di-v-m">\r\n                {{#if vouchervisible}}\r\n                    <!--<span class="x-fs-20 x-di x-di-v-m x-fc-white icon-icon_J015"></span>-->\r\n                    <!--<span data-item="voucherTxt" class="x-fs-14 x-di x-di-v-m x-fc-white x-ml-06 x-ff-wb">-->\r\n                        <!--{{#if voucherusage}}-->\r\n                            <!--{{local "booking.you_have_been_upgraded" targetRoomName originRoomName }}-->\r\n                        <!--{{else}}-->\r\n                            <!--{{local "booking.use_your_room_upgrade_voucher"}}-->\r\n                        <!--{{/if}}-->\r\n                    <!--</span>-->\r\n\r\n                    <span class="x-fs-14 x-di x-di-v-m x-fc-white x-ff-wb">{{differentiator}}</span>\r\n                {{else}}\r\n                    <span class="x-fs-14 x-di x-di-v-m x-fc-white x-ff-wb">{{differentiator}}</span>\r\n                {{/if}}\r\n            </div>\r\n            <div class="x-cell x-al-r x-di-v-m">\r\n                {{#if vouchervisible}}\r\n                    {{#if voucherusage}}\r\n                        <span class="x-fs-16 x-di x-di-v-m x-fc-white x-check x-check-sm x-pointer checked" data-item="voucherBox"></span>\r\n                        <span class="x-fs-14 x-di x-di-v-m x-fc-white x-ml-06 x-upper x-ff-m7 x-none x-mt-02" style="letter-spacing: 0.65px;" data-item="voucherText">{{local \'rup.room_upgraded\'}}</span>\r\n                    {{else}}\r\n                        <span class="x-fs-16 x-di x-di-v-m x-fc-white x-check x-check-sm x-pointer" data-item="voucherBox"></span>\r\n                        <span class="x-fs-14 x-di x-di-v-m x-fc-white x-ml-06 x-upper x-ff-m7 x-none x-mt-02" style="letter-spacing: 0.65px;" data-item="voucherText">{{local \'rup.use_points_to_upgrade\'}}</span>\r\n                    {{/if}}\r\n                    <!--<span class="x-fs-14 x-di x-di-v-m x-fc-white x-ml-06 x-upper x-ff-mh x-none">{{local "booking.use_upgrade_voucher"}}</span>-->\r\n\r\n                    <span class="x-fs-16 x-di x-di-v-m x-fc-white x-ml-06 x-default icon-icon_B008" data-item="voucherTip"></span>\r\n                {{/if}}\r\n            </div>\r\n        </div>\r\n    </div>\r\n{{/if}}\r\n\r\n\r\n<div class="x-bc-white x-fs-00">\r\n    <div class="x-highlight">\r\n        <div data-region="room"></div>\r\n    </div>\r\n</div>'},{}],293:[function(e,i,a){var t=e("underscore"),r=e("backbone"),n=e("backbone.marionette"),o=e("../../../../../../ui/util"),s=e("../../../../../common/count"),l=e("../../../../../common/short"),c=e("./child/view");i.exports=n.CompositeView.extend({childView:c,template:Handlebars.compile(e("./template.hbs")),className:"book2-stay-arar",childViewContainer:".book2-stay-container",ui:{first:"[data-item='first']",child:"[data-item='child']",other:"[data-item='other']",count:"[data-item='count']",update:".book2-updated-tip",change:"[data-item='change']"},events:{"click @ui.other":function(){var e=this,i=e.options.rootState;e.model&&(i.trigger("showLampBoxStay",e.model.toJSON()),i.trigger("lightBoxAnimate",e.ui.other.offset()))},"click @ui.change":function(){var e=this,i=e.options.rootState;i.isStyle(i.VIEW_STYLES.HOTEL_BY_ROOM)||i.isStyle(i.VIEW_STYLES.HOTEL_BY_ALL)?(i.trigger("showLampBoxRate",e.model.toJSON()),i.trigger("lightBoxAnimate",e.ui.change.offset())):i.isStyle(i.VIEW_STYLES.HOTEL_BY_RATE)&&(i.trigger("showLampBoxRoom",e.model.toJSON()),i.trigger("lightBoxAnimate",e.ui.change.offset()))}},childViewOptions:function(e){return{model:e,rootState:this.options.rootState}},serializeData:function(){var e=this,i=null,a=e.options.rootState;return e.collection.length&&(i=e.collection.at(0).toJSON()),{currency:a.getCurrency(),isUseMoney:a.isTrade(a.VIEW_TRADES.USE_MONEY),isUsePoint:a.isTrade(a.VIEW_TRADES.USE_POINT),isHotelByRoom:a.isStyle(a.VIEW_STYLES.HOTEL_BY_ROOM),isHotelByRate:a.isStyle(a.VIEW_STYLES.HOTEL_BY_RATE),expandAll:i&&e.options.expandAll,onlyone:1===e.collection.length&&e.options.expandAll,data:i,multiple:parseInt(a.getParam().rooms)>1}},initialize:function(){var e=this,i=e.model,a=e.options.rootState,t=[];i&&(t=a.getStays({roomtypecode:i.get("roomtypecode"),ratecode:i.get("ratecode"),roomid:i.get("roomid")})),e.collection=new r.Collection(t),e.__childVisible=!1,e.__renderDeferred=jQuery.Deferred(),e.listenTo(a,"redrawViewChild",e.redrawViewChild),e.listenTo(a,"changePartCount",e.changePartCount),l.autoCreate(this)},onRender:function(){var e=this;e.__renderDeferred.resolve(),e.__childVisible||0===e.collection.length?e.__showChild():e.__addCount(),1===e.collection.length&&e.ui.other.remove()},onShow:function(){var e=this,i=e.model.get("roomId");if(0===e.collection.length){var a=jQuery("[data-id='"+i+"']").next(),t=a.find(".book2-short-block-arar").find(".x-level");a.find("[data-region='stay']").html(""),t.length&&t.find(".x-level").height(170)}},redrawViewChild:function(e){return this.__renderDeferred.then(jQuery.proxy(this.__redrawViewChild,this,e))},changePartCount:function(e){return this.__renderDeferred.then(jQuery.proxy(this.__changePartCount,this,e))},__redrawViewChild:function(){this.render()},__changePartCount:function(){var e=this,i=e.model,a=e.options.rootState,r=[];i&&(r=a.getStays({roomtypecode:i.get("roomtypecode"),ratecode:i.get("ratecode"),roomid:i.get("roomid")})),e.collection.length&&(e.children.forEach(function(e){var i=t.findWhere(r,{key:e.model.get("key")});i&&(e.model.set(i),e.createCountView())}),e.__addCount())},__onChangeCount:function(e){var i=this,a=i.collection.at(0),t=a.toJSON(),r={roomtypecode:t.roomtypecode,ratecode:t.ratecode,roomid:t.roomid},n=i.options.rootState;n.setStayCount({key:t.key,categoryid:t.categoryid,quantity:e}),n.trigger("changePartCount",r),1===t.maxquantity?i.__showUpdateTip():i.__fadeUpdateTip()},__showChild:function(){this.ui.first.hide(),this.ui.child.show(),this.ui.other.html(i18n.t("booking.see_less_addons")),o.tracker.trigger("change:size"),this.__childVisible=!0},__hideChild:function(){this.ui.first.show(),this.ui.child.hide(),this.ui.other.html(i18n.t("booking.see_more_addons")),o.tracker.trigger("change:size"),this.__childVisible=!1,this.collection.length&&this.__addCount()},__addCount:function(){var e=this,i=e.collection.at(0).toJSON(),a=e.options.rootState,t=parseFloat(i.maxquantity),r=a.getStayCount({key:i.key,categoryid:i.categoryid});s.autoCreate(this.ui.count,{minValue:0,maxValue:t&&t>0?t:99,value:r||0,change:jQuery.proxy(this.__onChangeCount,this),label:i18n.t("booking.add_to_booking"),single:!0})},__showUpdateTip:function(){this.ui.update.finish&&this.ui.update.finish().fadeIn(200).delay(5e3).fadeOut(400)},__fadeUpdateTip:t.debounce(function(){this.__showUpdateTip()},500)})},{"../../../../../../ui/util":2122,"../../../../../common/count":345,"../../../../../common/short":350,"./child/view":291,"./template.hbs":292,backbone:8,"backbone.marionette":6,underscore:42}],292:[function(e,i,a){i.exports='{{#if data}}\r\n    <div class="x-pt-18 x-pb-20">\r\n        <div class="book2-short-block" style="width: 100%">\r\n            <div class="x-fs-00 x-default-bold">\r\n                {{#if data}}\r\n                    {{#if multiple}}\r\n                        <span class="x-fs-12 x-ff-mh x-upper" style="color: #202020; font-weight: 300;">{{local "booking.add_more_value_to_this_rate_for_each_room"}}</span>\r\n                    {{else}}\r\n                        <span class="x-fs-12 x-ff-mh x-upper" style="color: #202020; font-weight: 300;">{{local "booking.add_more_value_to_this_rate"}}</span>\r\n                    {{/if}}\r\n                {{/if}}\r\n            </div>\r\n            {{#if data}}\r\n                {{#if onlyone}}\r\n                    <div class="x-fs-00 x-mt-08 x-nowrap">\r\n                        <div class="book2-stay-image x-di x-di-v-t x-img" style="background-image: url(\'{{data.img}}\')"></div>\r\n                        <div class="book2-stay-theme x-di x-di-v-t">\r\n                            <div class="book2-stay-child-arar x-fs-00 x-nowrap">\r\n                                <div class="panel-1 x-di x-di-v-m x-normal">\r\n                                    <div><h4 class="x-fs-18 x-ff-wb">{{data.inventorycode}}</h4></div>\r\n                                    <div style="margin-top: 12px" class="x-pr-10">\r\n                                        <p class="x-fs-13 x-lh-18 x-ff-sm x-short" data-line="2">\r\n                                            {{data.desc}}\r\n                                        </p >\r\n                                    </div>\r\n                                </div>\r\n                                <div class="panel-2 x-di x-di-v-m x-normal">\r\n                                    <div>\r\n                                        {{#if isUseMoney}}\r\n                                            <span class="x-fs-18 x-ff-m7 x-di-v-t x-upper"><span class="x-fs-13 x-ff-m7 x-di-v-t x-upper">+{{data.ratecurrency}}</span> {{price-format data.avgdisplayrate}}</span>\r\n                                        {{/if}}\r\n                                        {{#if isUsePoint}}\r\n                                            <span class="x-fs-18 x-ff-m7 x-di-v-t x-upper">{{num-format data.avgcostpoints}}</span>\r\n                                        {{/if}}\r\n                                    </div>\r\n                                    <div class="x-mt-04">\r\n                                        <span class="x-fs-12 x-ff-sm x-upper">{{local "booking.price_for_all_guests"}}</span>\r\n                                    </div>\r\n                                    <div class="x-mt-10 x-level">\r\n                                        <span class="x-fs-00" data-item="count"></span>\r\n                                        <div class="book2-updated-tip x-fs-12 x-fc-green x-flt">\r\n                                            <span class="x-fs-16 x-di x-di-v-m icon-icon_I009"></span> {{local "booking.updated"}}\r\n                                        </div>\r\n                                    </div>\r\n\r\n                                </div>\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n                {{else}}\r\n                    <div class="x-mt-08" data-item="first">\r\n                        <div class="book2-stay-child-arar x-fs-00 x-nowrap">\r\n                            <div class="panel-1 x-di x-di-v-m x-normal">\r\n                                <div><h4 class="x-fs-18 x-ff-wb">{{data.inventorycode}}</h4></div>\r\n                                {{#if expandAll}}\r\n                                    <div style="margin-top: 12px;" class="x-pr-10">\r\n                                        <p class="x-fs-13 x-ff-sm x-lh-18 x-short" data-line="2">\r\n                                            {{data.desc}}\r\n                                        </p >\r\n                                    </div>\r\n                                {{/if}}\r\n                            </div>\r\n                            <div class="panel-2 x-di x-di-v-m x-normal">\r\n                                <div>\r\n                                    {{#if isUseMoney}}\r\n                                        <span class="x-fs-17 x-ff-wb x-di-v-t x-upper"><span class="x-fs-13 x-ff-wb x-di-v-t x-upper">+{{data.ratecurrency}}</span> {{price-format data.avgdisplayrate}}</span>\r\n                                    {{/if}}\r\n                                    {{#if isUsePoint}}\r\n                                        <span class="x-fs-17 x-ff-wb x-di-v-t x-upper">{{num-format data.avgcostpoints}}</span>\r\n                                    {{/if}}\r\n                                </div>\r\n                                <div class="x-mt-02">\r\n                                    <span class="x-fs-12 x-ff-mh x-upper">{{#if multiple}}{{local "booking.per_room"}} {{/if}}{{data.pricingtype}}</span>\r\n                                </div>\r\n                                {{#if expandAll}}\r\n                                    <div class="x-mt-10 x-level">\r\n                                        <span class="x-fs-00" data-item="count"></span>\r\n                                        <div class="book2-updated-tip x-fs-12 x-fc-green x-flt">\r\n                                            <span class="x-fs-16 x-di x-di-v-m icon-icon_I009"></span> {{local "booking.updated"}}\r\n                                        </div>\r\n                                    </div>\r\n\r\n                                {{/if}}\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n                {{/if}}\r\n            {{/if}}\r\n            <div class="book2-stay-container" data-item="child"></div>\r\n            {{#if expandAll}}\r\n                <div class="x-mt-08">\r\n                    <span class="x-fs-13 x-ff-mm x-fc-azure x-pointer x-under" data-item="other">{{local "booking.see_more_addons"}}</span>\r\n                </div>\r\n            {{/if}}\r\n        </div>\r\n    </div>\r\n{{else}}\r\n    <div>\r\n        <div class="book2-stay-container" data-item="child"></div>\r\n    </div>\r\n{{/if}}\r\n<!--<div class="x-pt-13 x-pb-17 x-bc-black x-highlight-lrb x-pointer" data-item="change">-->\r\n    <!--{{#if isHotelByRoom}}-->\r\n        <!--<div class="x-fs-16 x-ff-wb x-ml-20 x-fc-azure x-under x-delta right x-upper">{{local "booking.view_and_compare_all_rates"}}</div>-->\r\n    <!--{{/if}}-->\r\n    <!--{{#if isHotelByRate}}-->\r\n        <!--<div class="x-fs-16 x-ff-wb x-ml-20 x-fc-azure x-under x-delta right x-upper">{{local "booking.view_and_compare_all_rooms"}}</div>-->\r\n    <!--{{/if}}-->\r\n<!--</div>-->'},{}],291:[function(e,i,a){var t=e("underscore"),r=e("backbone.marionette"),n=e("../../../../../../common/count"),o=e("../../../../../../common/short");i.exports=r.ItemView.extend({template:Handlebars.compile(e("./template.hbs")),ui:{count:"[data-item='count']",update:".book2-updated-tip"},initialize:function(){o.autoCreate(this)},onRender:function(){this.createCountView()},serializeData:function(){var e=this,i=e.model.toJSON(),a=e.options.rootState;return{currency:a.getCurrency(),isUseMoney:a.isTrade(a.VIEW_TRADES.USE_MONEY),isUsePoint:a.isTrade(a.VIEW_TRADES.USE_POINT),data:i,multiple:parseInt(a.getParam().rooms)>1}},createCountView:function(){var e=this,i=e.model.toJSON(),a=e.options.rootState,t=parseFloat(i.maxquantity);0===i.displayrate&&a.isStayModified&&!a.isStayModified({key:i.key,categoryid:i.categoryid})&&a.setStayCount({key:i.key,categoryid:i.categoryid,quantity:1});var r=a.getStayCount({key:i.key,categoryid:i.categoryid});n.autoCreate(this.ui.count,{minValue:0,maxValue:t&&t>0?t:99,value:r||0,change:jQuery.proxy(e.__onChangeCount,this),label:i18n.t("booking.add_to_booking"),single:!0})},__onChangeCount:function(e){var i=this,a=i.model.toJSON(),t={roomtypecode:a.roomtypecode,ratecode:a.ratecode,roomid:a.roomid},r=i.options.rootState;r.setStayCount({key:a.key,categoryid:a.categoryid,quantity:e}),r.trigger("changePartCount",t),1===a.maxquantity?i.__showUpdateTip():i.__fadeUpdateTip()},__showUpdateTip:function(){this.ui.update.finish&&this.ui.update.finish().show().delay(5e3).queue(function(){jQuery(this).fadeOut(400).dequeue()})},__fadeUpdateTip:t.debounce(function(){this.__showUpdateTip()},500)})},{"../../../../../../common/count":345,"../../../../../../common/short":350,"./template.hbs":290,"backbone.marionette":6,underscore:42}],290:[function(e,i,a){i.exports='<div class="x-fs-00 x-mt-16 x-nowrap">\r\n    <div class="book2-stay-image x-di x-di-v-t x-img" style=\'background-image: url("{{data.img}}")\'></div>\r\n    <div class="book2-stay-theme x-di x-di-v-t">\r\n        <div class="book2-stay-child x-fs-00 x-nowrap">\r\n            <div class="panel-1 x-di x-di-v-t x-normal">\r\n                <div><h4 class="x-fs-16 x-ff-wb">{{data.inventorycode}}</h4></div>\r\n                <div style="margin-top: 8px">\r\n                    <p class="x-fs-13 x-ff-sm x-lh-18 x-short" data-line="2">\r\n                        {{data.desc}}\r\n                    </p >\r\n                </div>\r\n            </div>\r\n            <div class="panel-2 x-di x-di-v-t x-normal">\r\n                <div>\r\n                    {{#if isUseMoney}}\r\n                        <span class="x-fs-17 x-ff-wb x-di-v-t x-upper"><span class="x-fs-13 x-ff-wb x-di-v-t x-upper">+{{data.ratecurrency}}</span> {{price-format data.avgdisplayrate}}</span>\r\n                    {{/if}}\r\n                    {{#if isUsePoint}}\r\n                        <span class="x-fs-17 x-ff-wb x-di-v-t x-upper">{{num-format data.avgcostpoints}}</span>\r\n                    {{/if}}\r\n                </div>\r\n                <div class="x-mt-02">\r\n                    <span class="x-fs-12 x-ff-mh x-upper">{{#if multiple}}{{local "booking.per_room"}} {{/if}}{{data.pricingtype}}</span>\r\n                </div>\r\n                <div class="x-mt-10">\r\n                    <span class="x-fs-00" data-item="count"></span>\r\n                </div>\r\n                <div class="book2-updated-tip x-fs-12 x-mt-08 x-fc-green x-al-r">\r\n                    <span class="x-fs-16 x-di x-di-v-m icon-icon_I009"></span> {{local "booking.updated"}}\r\n                </div>\r\n            </div>\r\n        </div>\r\n    </div>\r\n</div>'},{}],289:[function(e,i,a){function t(e){var i=e.memberrate===e.avgdisplayoriginalprice;return!i}function r(e){var i=(e.avgdisplaypoints||e.points)===e.avgdisplayoriginalpoints;return!i}function n(e){return e.avgdisplayoriginalprice}function o(e){return e.avgdisplayoriginalpoints}function s(e){return e.memberrate}function l(e){return e.avgdisplaypoints||e.points}function c(e){return e.memberrate}function d(e){return e.avgdisplaypoints||e.points}function p(i,a,t,r){var n=x.has(a,"memberrate")&&x.has(a,"avgdisplaypoints"),o=x.uniq(i,function(e){return e.bedtype});return o=x.map(o,function(e){return n&&x.findWhere(i,{ratecode:a.ratecode,bedtype:e.bedtype})||e}),o=x.map(o,function(i){var o=i.bedtype,s=i.bedtypeicon,l=parseFloat(i.memberrate),c=parseFloat(i.avgdisplaypoints),d=i.bedtype===a.bedtype;if(n&&!d)if(r){var p=c-parseFloat(a.avgdisplaypoints);p&&(o=Handlebars.compile(e("./bedtext-point.hbs"))({bedtype:o,currency:t,operator:p>0?"+":"-",difference:Math.abs(p)}))}else{var p=l-parseFloat(a.memberrate);p&&(o=Handlebars.compile(e("./bedtext.hbs"))({bedtype:o,currency:t,operator:p>0?"+":"-",difference:Math.abs(p)}))}return{bedtext:o,bedtype:i.bedtype,bedtypeicon:s,highlight:d}})}function m(e){return x.filter(e||[],function(e){return!!e.fonticon}).slice(0,4)}var x=e("underscore"),f=e("backbone"),u=e("backbone.marionette"),h=e("moment"),g={},v=!1,_="YYYY-MM-DD",y=e("../../../../../06-popping/view"),b=e("../../../../../common/popup"),w=e("../../../../../common/short"),k=e("../03-ratelist/view");i.exports=u.LayoutView.extend({template:Handlebars.compile(e("./template.hbs")),regions:{list:"[data-region='list']"},ui:{voucher:"[data-item='voucher']",voucherBox:"[data-item='voucher'].x-check",voucherTip:"[data-item='voucher-popup']",otherRoom:"[data-item='other-room']",otherDate:"[data-item='other-date']",popup:"[data-item='popup']",maxocc:"[data-item='maxocc']",member:"[data-item='member']","short":"[data-item='short']",short_p:"[data-item='short-p']",short_h:"[data-item='short-h']",readmore:"[data-item='readmore']",loyaltyroomupgrade_text:"[data-item='loyaltyroomupgrade_text']",loyaltyroomupgrade_icon:"[data-item='loyaltyroomupgrade_icon']"},events:{"mouseenter @ui.maxocc":function(e){e.stopPropagation(),b.addPopupTip(this,y.OCCUPANCY,this.getOccupancy(),jQuery(e.currentTarget))},"mouseleave @ui.maxocc":function(e){e.stopPropagation(),b.delPopupTip()},"mouseenter @ui.member":function(e){e.stopPropagation();this.serializeData();b.addPopupTip(this,y.MEMBER,this.getMember(),jQuery(e.currentTarget))},"mouseleave @ui.member":function(e){e.stopPropagation(),b.delPopupTip()},"mouseenter @ui.short":function(e){e.stopPropagation(),b.addPopupTip(this,y.TIPSHORT,this.getTipShort(),jQuery(this.ui["short"]))},"mouseleave @ui.short":function(e){e.stopPropagation();var i=e.toElement||e.relatedTarget;jQuery(i).hasClass("x-penalty")||jQuery(i).closest(".x-penalty").length||b.delPopupTip()},"mouseleave @ui.short_p":function(e){e.stopPropagation();var i=e.toElement||e.relatedTarget;jQuery(i).hasClass("x-penalty")||jQuery(i).closest(".x-penalty").length||b.delPopupTip()},"mouseenter @ui.short_p":function(e){e.stopPropagation(),b.addPopupTip(this,y.TIPSHORT,this.getTipShort(),jQuery(this.ui["short"]))},"click [data-item='look']":function(e){e.stopPropagation();var i=this,a=i.options.rootState;a.isFinal()&&a.trigger("planGalleryData",{categoryid:i.model.get("id")})},"click [data-item='beds']":function(e){var i=this,a=null,t=i.model.get("id"),r=i.options.rootState,n=r.getAllah({categoryid:t,byAll:!0}),o=jQuery(e.currentTarget).attr("data-bed-type"),s=r.getRates({categoryid:t,bedtype:o});r.isFinal()&&s.length&&(a=n?x.findWhere(s,{ratecode:n.ratecode})||s[0]:s[0],r.setAllah({categoryid:a.categoryid,roomtypecode:a.roomtypecode,ratecode:a.ratecode,roomid:a.roomid,byAll:!0}),r.storeUpdatedTip({type:g,code:t,name:o}),i.options.expandAll?r.trigger("loadStaysByRate",a):r.trigger("loadStaysByRate",a,!0))},"click [data-item='hand']":function(){var e=this,i=e.options.rootState;i.isFinal()&&i.trigger("loadStaysInAll",{categoryid:e.model.get("id")})},"click [data-item='rate']":function(){var e=this,i=e.options.rootState;i.isFinal()&&(e.options.openPopupView?i.trigger("hiddenPopupView",{categoryid:e.model.get("id")}):i.trigger("expandPopupView",{categoryid:e.model.get("id")}))},"click [data-item='s-rate-calendar']":function(){var e=this,i=e.options.rootState;i.setLastStyle(i.getStyle()),i.isFinal()&&i.trigger("changeViewStyle",i.VIEW_STYLES.HOTEL_BY_CALENDAR)},"click [data-item='book']":function(){var e=this,i=e.options.rootState,a=i.getAllah({categoryid:e.model.get("id"),byAll:!0});a&&i.trigger("addShoppingCart",a)},"click [data-item='sign']":function(){this.options.rootState.trigger("registerPayment")},"click @ui.voucher":function(){var e=this,i=e.model.toJSON(),a=e.options.rootState,t=a.getAllah({categoryid:i.id,byAll:!0});if(t){var r=!t.voucherusage;a.changeRateValue({categoryid:t.categoryid,roomtypecode:t.roomtypecode,ratecode:t.ratecode,roomid:t.roomid,voucherusage:r}),r?(e.ui.voucherBox.addClass("checked"),e.ui.voucherTip.addClass("holds").delay(5e3).queue(function(){jQuery(this).removeClass("holds").dequeue()})):e.ui.voucherBox.removeClass("checked")}},"click @ui.otherRoom":function(){var e=jQuery(".book2-content-section").children(),i=e.has(this.el),a=null;if(i.length)for(a=i.next();a.length;){if(a.has(".x-radio[data-item='hand']").length)return void jQuery("html,body").animate({
scrollTop:a.offset().top-13-71},200);a=a.next()}var t=e.has("[data-item='book']");t.length&&jQuery("html,body").animate({scrollTop:t.offset().top-13-71},200)},"click @ui.otherDate":function(e){e.stopPropagation();var i=this,a=i.options.rootState;a.trigger("expandCalendar")},"click @ui.loyaltyroomupgrade_text":function(e){e.stopPropagation();var i=this,a=i.model.toJSON(),t=i.options.rootState,r=t.getAllah({categoryid:a.id,byAll:!0});if(r){var n=!r.loyaltyroomupgradeusage,o=r.specialrequests||"",s=i18n.t("booking.loyalty_room_upgrade_special_requests");n?o&&0===o.indexOf(s)||(o=s+" "+o):o&&0===o.indexOf(s)&&(o=o.slice(s.length).replace(/^\s/,""));var l={categoryid:r.categoryid,roomtypecode:r.roomtypecode,ratecode:r.ratecode,roomid:r.roomid,loyaltyroomupgradeusage:n,specialrequests:o};t.changeRateValue(l),n?(i.ui.loyaltyroomupgrade_text.eq(0).addClass("checked-azure"),i.ui.loyaltyroomupgrade_icon.finish().trigger("mouseenter").delay(3e3).queue(function(){jQuery(this).trigger("mouseleave").dequeue()})):i.ui.loyaltyroomupgrade_text.eq(0).removeClass("checked-azure"),t.trigger("loyaltyRoomUpgrade",l)}},"mouseenter @ui.loyaltyroomupgrade_icon":function(e){e.stopPropagation(),b.addPopupTip(this,y.LOYALTYROOMUPGRADE,{},this.ui.loyaltyroomupgrade_icon)},"mouseleave @ui.loyaltyroomupgrade_icon":function(e){e.stopPropagation(),b.delPopupTip()}},getOccupancy:function(){var e=this,i=e.model.toJSON(),a=e.options.rootState,t=a.getAllah({categoryid:i.id,byAll:!0}),r={},n=a.getMaxChildAge();return t&&(r.maxocc=n&&(t.maxocc||0),r.adultocc=n&&(t.adultocc||0),r.childocc=n&&(t.childocc||0),r.adults=x.range(t.adultocc||0),r.children=x.range(t.childocc||0)),r.maxchildage=n,r},getMember:function(){var e=this,i=e.model.toJSON(),a=e.options.rootState,t=a.getAllah({categoryid:i.id,byAll:!0});return{isLogin:a.isLogin(),isUseMoney:a.isTrade(a.VIEW_TRADES.USE_MONEY),isUsePoint:a.isTrade(a.VIEW_TRADES.USE_POINT),currency:a.getCurrency(),complete:a.getComplete(),loyalty:a.getLoyalty(),pointssaved:t?parseFloat(t.pointssaved):parseFloat(i.price.pointssaved),ratesaved:t?parseFloat(t.ratesaved):parseFloat(i.price.ratesaved),vouchervisible:t&&t.vouchervisible}},getTipShort:function(){var e=this,i=e.model.toJSON(),a=e.options.rootState,t=a.getAllah({categoryid:i.id,byAll:!0});return t},serializeData:function(){var e,i=this,a=i.model.toJSON(),f=i.options.rootState,u=f.getAllah({categoryid:a.id,byAll:!0}),g=f.getHotel(),v=!1,y=u?parseFloat(u.pointssaved):parseFloat(a.price.pointssaved),b=u?parseFloat(u.ratesaved):parseFloat(a.price.ratesaved);u&&u.voucherusage&&(e=f.getUpgradeRateByRate({categoryid:u.categoryid,roomtypecode:u.roomtypecode,ratecode:u.ratecode,roomid:u.roomid}),e&&(u=e.roomrate||u,a=e.roomtype||a,y=e.roomrate.pointssaved,b=e.upgradeddifference.savedprice.avgtotal)),u&&!u.roomupgradeavailabled&&g.loyaltyroomupgradeenable&&(v=!0);var w=g.locationbookingurl;if(w){var k={},S=f.getParam();S.checkin&&(k.checkin=h(S.checkin).format(_)),S.checkout&&(k.checkout=h(S.checkout).format(_)),k=x.assign(k,{discountcode:S.discountcode||"",groupcode:S.groupcode||"",promocode:S.promocode||"",adults:S.adults||1,children:S.children||0,rooms:S.rooms||1,AAA:!(!S.isAmerican||!S.AAA),AARP:!(!S.isAmerican||!S.AARP),GOV:!(!S.isAmerican||!S.GOV),Accessible:!!S.Accessible}),w+=w.indexOf("?")>=0?"&"+jQuery.param(k):"?"+jQuery.param(k)}var V=f.getMaxChildAge(),P=V&&(u&&u.maxocc||"0"),R=V&&u&&u.adultocc,C=V&&u&&u.childocc,T=f.getParam().rooms,A=a.NumberOfUnits,D=parseInt(T)>parseInt(A),E=function(){var e="",i=null!=u.rategainresult,a=g.activatebeatthempmg,t=null!=u.rategainresult?u.rategainresult.status:!1;return i?("2"===t&&(e="PMG1_CRS lower"),"3"===t&&(e=a?"PMG3a_CRS higher and beat them":"PMG3b_CRS higher and match"),"4"===t&&(e=a?"PMG2a_CRS same and beat them":"PMG2b_CRS same and match"),"5"===t&&(e="PMG4_CRS much higher")):e="PMG5_Null",e};return{isLogin:f.isLogin(),isFinal:f.isFinal(),enableslashprice:f.getHotel().enableslashprice&&f.isLogin(),isManyDays:f.isManyDays(),isUseMoney:f.isTrade(f.VIEW_TRADES.USE_MONEY),isUsePoint:f.isTrade(f.VIEW_TRADES.USE_POINT),expandAll:u&&i.options.expandAll,openPopupView:i.options.openPopupView,maxchildage:V,currency:f.getCurrency(),restricted:u?u.roomstay&&u.roomstay.RatePlan&&u.roomstay.RatePlan.restricted:a.rateplan&&a.rateplan.restricted,complete:!(u?u.roomstay&&u.roomstay.RatePlan&&u.roomstay.RatePlan.restricted:a.rateplan&&a.rateplan.restricted)&&f.getComplete(),locationname:g.locationname,locationtitle:g.locationtitle,locationbookingurl:w,samecityhotelcount:g.samecityhotelcount-1,otheravailability:f.getRooms({availability:!0}).length,data:u,id:a.id,type:a.type,badgeicon:a.badgeicon,badgetitle:a.badgetitle,bedtypes:p(u?u.voucherusage?a.availability?a.bedtypes:[]:f.getRates({categoryid:a.id}):a.availability?a.bedtypes:[],i.options.expandAll?u||{}:u||{},f.getCurrency(),f.isTrade(f.VIEW_TRADES.USE_POINT)),amenities:m(a.amenities),roomsize:a.features.roomsize,roomtagline:a.roomtagline,image:u?(u.roomtypeimg||"").replace(/^#+/,"")||a.imageurl3||a.imageurl:a.imageurl3||a.imageurl,rate:s(u||a.price),points:l(u||a.price),memberrate:c(u||a.price),memberpoints:d(u||a.price),originrate:n(u||a.price),originpoints:o(u||a.price),priceCompared:t(u||a.price),PointsCompared:r(u||a.price),pointssaved:y,ratesaved:b,pointssavedformat:Handlebars.compile("{{num-format this}}")(u?parseFloat(u.pointssaved):parseFloat(a.price.pointssaved)),ratesavedformat:Handlebars.compile("{{price-format this}}")(u?parseFloat(u.ratesaved):parseFloat(a.price.ratesaved)),availability:u?!0:a.availability,vouchervisible:u&&u.roomupgradeavailabled,voucherusage:u&&u.voucherusage,upgradePoints:e&&e.upgradeddifference.avgtopprice.avgtoppoints,loyaltyroomupgradeenable:!1,loyaltyroomupgradeusage:u&&u.loyaltyroomupgradeusage,bestdeal:u&&u.badgetitle,maxocc:u&&P,adultocc:u&&R,childocc:u&&C,hasocc:!(!u||!R)||!(!u||!C),adults:x.range(u&&R||0),children:x.range(u&&C||0),pointsText:i18n.t("checkout.points"),hasRateCalendar:f.hasRateCalendar(),upgradeObject:e,pmg:E(),roomsOfUnits:D}},initialize:function(){var e=this.options.rootState;w.autoCreate(this),this.__renderDeferred=jQuery.Deferred(),this.listenTo(e,"redrawViewChild",this.redrawViewChild),this.listenTo(e,"changePartCount",this.changePartCount),this.listenTo(e,"turnUpgradeRate",this.changePartCount)},onRender:function(){var e=this;e.__renderDeferred.resolve(),e.options.rootState.glintUpdatedTip({code:this.model.get("id"),type:g},e),e.__renderRateList(),e.__showTipInFirstRender()},onShow:function(){},onDestroy:function(){clearTimeout(this.__timeout),this.__destroy=!0},redrawViewChild:function(e){return this.__renderDeferred.then(jQuery.proxy(this.__redrawViewChild,this,e))},changePartCount:function(e){return this.__renderDeferred.then(jQuery.proxy(this.__changePartCount,this,e))},__redrawViewChild:function(){var e=this.options.rootState;this.render(),e.trigger("redrawStay",this.model.get("id"))},__changePartCount:function(e){this.model.get("id")===e.categoryid&&this.render()},__renderRateList:function(){var e=this,i=e.model.get("id"),a=e.options.rootState,t=a.getAllah({categoryid:i,byAll:!0});e.getRegion("list").show(new k({model:t?new f.Model(t):null,rootState:a,expandAll:e.options.expandAll}))},__showTipInFirstRender:function(){var e=this;setTimeout(function(){var i=jQuery(window);if(e.options.expandAll){if(v)return;v=!0;var a=e.ui.popup.eq(0).find(".x-popup-body"),t=a.closest(".x-popup-wrap");if(e.ui.popup.eq(0).addClass("holds"),a.length){a.css({marginLeft:"initial",marginRight:"initial"});var r=a.offset();if(r.left<36)r.left<=0&&a.css({marginLeft:-(2*r.left)+36});else{var n=i.width()-t.width()-70;n<r.left&&a.css({marginRight:r.left-n})}}e.__timeout=setTimeout(function(){e.__destroy||e.ui.popup.removeClass("holds")},3e3)}})}})},{"../../../../../06-popping/view":343,"../../../../../common/popup":348,"../../../../../common/short":350,"../03-ratelist/view":298,"./bedtext-point.hbs":286,"./bedtext.hbs":287,"./template.hbs":288,backbone:8,"backbone.marionette":6,moment:16,underscore:42}],298:[function(e,i,a){function t(e){return r.uniq(e,function(e){return e.ratecode})}var r=e("underscore"),n=e("backbone"),o=e("backbone.marionette"),s=e("./child/view"),l=e("./empty/view");i.exports=o.CollectionView.extend({childView:s,emptyView:l,className:"book2-content-ratelist",childViewOptions:function(e,i){return{model:e,index:i,rootState:this.options.rootState}},initialize:function(){var e=this,i=e.options.rootState;if(e.__renderDeferred=jQuery.Deferred(),e.model){var a=e.model.toJSON(),o=i.getAllah({categoryid:a.categoryid,byAll:!0}),s=i.getRates({categoryid:a.categoryid,bedtype:a.bedtype});e.options.expandAll&&(s=r.filter(s,function(e){return e.ratecode!==o.ratecode?e:void 0})),s.length&&(e.collection=new n.Collection(t(s)))}},onRender:function(){this.__renderDeferred.resolve()}})},{"./child/view":295,"./empty/view":297,backbone:8,"backbone.marionette":6,underscore:42}],297:[function(e,i,a){var t=e("backbone.marionette");i.exports=t.ItemView.extend({template:Handlebars.compile(e("./template.hbs")),serializeData:function(){},onRender:function(){},onDestroy:function(){}})},{"./template.hbs":296,"backbone.marionette":6}],295:[function(e,i,a){function t(e){var i=e.memberrate===e.avgdisplayoriginalprice;return!i}function r(e){var i=(e.avgdisplaypoints||e.points)===e.avgdisplayoriginalpoints;return!i}var n=(e("underscore"),e("backbone.marionette")),o=e("../../../../../../06-popping/view"),s=e("../../../../../../common/popup"),l=e("../../../../../../common/short"),c={},d=n.ItemView.extend({template:Handlebars.compile(e("./template.hbs")),className:"book2-ratelist-child",ui:{"short":"[data-item='short']",short_p:"[data-item='short-p']",short_h:"[data-item='short-h']"},events:{"mouseenter @ui.short":function(e){e.stopPropagation(),s.addPopupTip(this,o.TIPSHORT,this.getTipShort(),jQuery(this.ui["short"]))},"mouseleave @ui.short":function(e){e.stopPropagation();var i=e.toElement||e.relatedTarget;jQuery(i).hasClass("x-penalty")||jQuery(i).closest(".x-penalty").length||s.delPopupTip()},"mouseleave @ui.short_p":function(e){e.stopPropagation();var i=e.toElement||e.relatedTarget;jQuery(i).hasClass("x-penalty")||jQuery(i).closest(".x-penalty").length||s.delPopupTip()},"mouseenter @ui.short_p":function(e){e.stopPropagation(),s.addPopupTip(this,o.TIPSHORT,this.getTipShort(),jQuery(this.ui["short"]))},"click [data-item='select']":function(e){e.stopPropagation();var i=this,a=i.model.toJSON(),t=i.options.rootState;t.setAllah({categoryid:a.categoryid,roomtypecode:a.roomtypecode,ratecode:a.ratecode,roomid:a.roomid,byAll:!0}),t.storeUpdatedTip({type:c,code:a.roomtypecode,name:a.ratecode,room:a.roomid}),t.trigger("loadStaysByRate",a)}},serializeData:function(){var e=this,i=e.model.toJSON(),a=e.options.rootState,n=parseFloat(i.pointssaved),o=parseFloat(i.ratesaved);return{isLogin:a.isLogin(),isFinal:a.isFinal(),enableslashprice:a.getHotel().enableslashprice&&a.isLogin(),isManyDays:a.isManyDays(),currency:a.getCurrency(),restricted:i&&i.roomstay&&i.roomstay.RatePlan&&i.roomstay.RatePlan.restricted,complete:!(i&&i.roomstay&&i.roomstay.RatePlan&&i.roomstay.RatePlan.restricted)&&a.getComplete(),isUseMoney:a.isTrade(a.VIEW_TRADES.USE_MONEY),isUsePoint:a.isTrade(a.VIEW_TRADES.USE_POINT),expandAll:e.options.expandAll,data:i,rate:e.getOriginPrice(i),points:e.getOriginPoint(i),memberrate:e.getMemberPrice(i),memberpoints:e.getMemberPoint(i),priceCompared:t(i),PointsCompared:r(i),pointssaved:n,ratesaved:o,pointssavedformat:Handlebars.compile("{{num-format this}}")(parseFloat(i.pointssaved)),ratesavedformat:Handlebars.compile("{{price-format this}}")(parseFloat(i.ratesaved)),priceratiodesc:(i.priceratio&&i.priceratio.desc||"").trim(),bestdeal:i&&i.badgetitle,pointsText:i18n.t("checkout.points")}},initialize:function(){this.options.rootState;this.__renderDeferred=jQuery.Deferred(),l.autoCreate(this)},onRender:function(){var e=this;e.__renderDeferred.resolve(),e.options.expandAll},onDestroy:function(){clearTimeout(this.__timeout),this.__destroy=!0},getTipShort:function(){var e=this,i=e.model.toJSON();e.options.rootState;return i}});i.exports=d,d.prototype.getOriginPrice=function(e){return e.avgdisplayoriginalprice},d.prototype.getOriginPoint=function(e){return e.avgdisplayoriginalpoints},d.prototype.getMemberPrice=function(e){return e.memberprice?parseFloat(e.memberrate)||0:(parseFloat(e.memberrate)||0)-parseFloat(e.ratesaved)},d.prototype.getMemberPoint=function(e){return e.memberprice?parseFloat(e.avgdisplaypoints||e.points)||0:(parseFloat(e.avgdisplaypoints||e.points)||0)-(parseFloat(e.pointssaved)||0)}},{"../../../../../../06-popping/view":343,"../../../../../../common/popup":348,"../../../../../../common/short":350,"./template.hbs":294,"backbone.marionette":6,underscore:42}],294:[function(e,i,a){i.exports='<div class="x-fs-00 x-di x-di-v-m book2-ratelist-panel1" style="width: 72%">\r\n    <div class="book2-short-theme x-di x-di-v-m" style="margin-left: 0;margin-right: 0;width: calc(60% + 4px);min-height: 85px;">\r\n        <div>\r\n            <h2 class="x-fs-24 x-di x-di-v-m x-lh-24 x-ff-wb x-pr-17" style="margin-top: -5px"><span class="x-default x-mr-08" data-item=\'short-p\'>{{data.ratename}}</span>{{#if bestdeal}}<span class="x-ff-mh x-fs-12 x-lh-24 x-pl-05 x-pr-05 x-di x-di-v-m x-upper x-nowrap x-bc-peach x-fc-white x-lp-01">{{ bestdeal }}</span>{{/if}}\r\n            </h2>\r\n\r\n        </div>\r\n        <div class="x-mt-08 x-mb-8">\r\n            {{#if data.roomstay.RatePlan.paymentType}}\r\n                <span class="x-fs-16 x-ff-m7 x-di x-di-v-m x-upper x-default" style="color: #202020; letter-spacing: 1px"><span data-item=\'short-p\'>{{local "booking.pay_now_and_save"}}</span><span class="x-fs-16 x-di x-di-v-m x-ml-06 x-default x-pb-02 icon-icon_B008" data-item="short"></span></span>\r\n            {{else}}\r\n                <span class="x-fs-16 x-ff-m7 x-di x-di-v-m x-upper x-default" style="color: #202020; letter-spacing: 1px"><span data-item=\'short-p\'>{{local "booking.book_now_and_pay_later"}}</span><span class="x-fs-16 x-di x-di-v-m x-ml-06 x-default x-pb-02 icon-icon_B008" data-item="short"></span></span>\r\n            {{/if}}\r\n            <!--<span class="x-di x-di-v-m x-fs-16 x-ml-06 x-pointer icon-icon_B008" data-item="short"></span>-->\r\n        </div>\r\n    </div>\r\n    <div class="x-di x-di-v-t" style="width: calc(40% - 4px)">\r\n        <div class="panel-2 x-di x-di-v-t x-normal">\r\n            {{#if isFinal}}\r\n                {{#if isUseMoney}}\r\n                    {{#if ratesaved}}\r\n                        {{#if isLogin}}\r\n                            <span class="x-fs-16 x-di x-di-v-m x-ff-m7 x-fc-azure x-upper">{{local "booking.you_ve_saved"}} <span class="x-nowrap">{{currency}} {{price-format ratesaved}}</span></span>\r\n                        {{else}}\r\n                            {{#if complete}}\r\n                                <span class="x-fs-16 x-di x-di-v-m x-ff-m7 x-upper x-through">{{local "booking.usual_price"}}: <span class="x-nowrap">{{currency}} {{price-format rate}}</span></span>\r\n                            {{else}}\r\n                                <!--<span class="x-fs-16 x-di x-di-v-m x-ff-m7 x-upper">{{local "Property.members_pay"}}: {{currency}} {{price-format memberrate}}</span>-->\r\n                                <span class="x-fs-16 x-di x-di-v-m x-ff-m7 x-upper">{{local "booking.members_save"}}: <span class="x-nowrap">{{currency}} {{price-format ratesaved}}</span></span>\r\n                            {{/if}}\r\n\r\n                            <!--<div class="x-mt-04">-->\r\n                            <!--<span style="display: inline-block; max-width: 250px; line-height: 14px">-->\r\n                                <!--{{#if complete}}-->\r\n                            <!--<span class="x-fs-14 x-fc-white x-bc-azure x-di-v-m x-mr-06 icon-icon_I009"></span>-->\r\n                            <!--<span class="x-fs-12 x-ff-mm x-fw-none x-fc-azure x-di-v-m x-under">{{local "booking.complete_then_sign"}}</span>-->\r\n                                <!--{{else}}-->\r\n                            <!--<span class="x-fs-12 x-ff-mm x-fw-none x-pointer x-fc-azure x-under" data-item="sign">{{local "booking.sign_up_to_pay" currency ratesavedformat }}</span>-->\r\n                                <!--{{/if}}-->\r\n                            <!--</span>-->\r\n                            <!--</div>-->\r\n                        {{/if}}\r\n                        <div class="x-mt-08"></div>\r\n                    {{else}}\r\n                        {{#if restricted}}\r\n                            <div class="x-fs-16 x-ff-sm x-italic x-fc-gray">{{local "booking.loyalty_discount_not_applicable"}}</div>\r\n                            <div class="x-mt-08"></div>\r\n                        {{/if}}\r\n                    {{/if}}\r\n                {{/if}}\r\n                {{#if isUsePoint}}\r\n                    {{#if pointssaved}}\r\n                        {{#if isLogin}}\r\n                            <span class="x-fs-16 x-di x-di-v-m x-ff-m7 x-fc-azure x-upper">{{local "booking.you_ve_saved"}} <span class="x-nowrap">{{num-format pointssaved}} {{local "checkout.points"}}</span></span>\r\n                        {{else}}\r\n                            {{#if complete}}\r\n                                <span class="x-fs-16 x-di x-di-v-m x-ff-m7 x-upper x-through">{{local "booking.usual_price"}}: {{num-format points}}</span>\r\n                            {{else}}\r\n                                <!--<span class="x-fs-16 x-di x-di-v-m x-ff-m7 x-upper">{{local "Property.members_pay"}}: {{num-format memberpoints}} {{local "checkout.points"}}</span>-->\r\n                                <span class="x-fs-16 x-di x-di-v-m x-ff-m7 x-upper">{{local "booking.members_save"}}: <span class="x-nowrap">{{num-format pointssaved}} {{local "checkout.points"}}</span></span>\r\n                            {{/if}}\r\n                            <!--<div class="x-mt-04">-->\r\n                            <!--<span style="display: inline-block; max-width: 250px; line-height: 14px">-->\r\n                                <!--{{#if complete}}-->\r\n                            <!--<span class="x-fs-14 x-fc-white x-bc-azure x-di-v-m x-mr-06 icon-icon_I009"></span>-->\r\n                            <!--<span class="x-fs-12 x-ff-mm x-fw-none x-fc-azure x-di-v-m x-under">{{local "booking.complete_then_sign"}}</span>-->\r\n                                <!--{{else}}-->\r\n                            <!--<span class="x-fs-12 x-ff-mm x-fw-none x-pointer x-fc-azure x-under" data-item="sign">{{local "booking.sign_up_to_pay" currency ratesavedformat }}</span>-->\r\n                                <!--{{/if}}-->\r\n                            <!--</span>-->\r\n                            <!--</div>-->\r\n                        {{/if}}\r\n                        <div class="x-mt-08"></div>\r\n                    {{else}}\r\n                        {{#if restricted}}\r\n                            <div class="x-fs-16 x-ff-sm x-italic x-fc-gray">{{local "booking.loyalty_discount_not_applicable"}}</div>\r\n                            <div class="x-mt-08"></div>\r\n                        {{/if}}\r\n                    {{/if}}\r\n                {{/if}}\r\n            {{/if}}\r\n        </div>\r\n    </div>\r\n</div>\r\n<div class="x-fs-00 x-di x-di-v-t book2-ratelist-price" style="width: 28%;margin-top: -2px;">\r\n    <div class="panel-2 x-di x-di-v-t x-normal x-al-r x-full x-level">\r\n        {{#if isFinal}}\r\n            {{#if isUseMoney}}\r\n                {{#if rate}}\r\n                    <div class="x-di x-pr-30">\r\n                        <div class="x-fs-00">\r\n                            {{#if isLogin}}\r\n                                <span class="x-fs-24 x-ff-wb x-upper x-di x-di-v-m x-mt-01">{{currency}} {{price-format memberrate}}</span>\r\n                            {{else}}\r\n                                {{#if complete}}\r\n                                    <span class="x-fs-24 x-ff-wb x-upper x-di x-di-v-m x-mt-01">{{currency}} {{price-format memberrate}}</span>\r\n                                {{else}}\r\n                                    <span class="x-fs-24 x-ff-wb x-upper x-di x-di-v-m x-mt-01">{{currency}} {{price-format rate}}</span>\r\n                                {{/if}}\r\n                            {{/if}}\r\n                        </div>\r\n                        {{#if isManyDays}}\r\n                            <div class="x-fs-16 x-ff-m7 x-mt-08 x-upper">{{local "Property.avg_night"}}</div>\r\n                        {{else}}\r\n                            <div class="x-fs-16 x-ff-m7 x-mt-08 x-upper">{{local "Property.avg_person"}}</div>\r\n                        {{/if}}\r\n                        {{#if enableslashprice}}\r\n                            {{#if priceCompared}}\r\n                                <div class="x-fs-00">\r\n                                    <span class="x-fs-24 x-upper x-di x-di-v-m x-mt-01" style="text-decoration: line-through;">{{currency}} {{price-format rate}}</span>\r\n                                </div>\r\n                            {{/if}}\r\n                        {{/if}}\r\n                    </div>\r\n                    <div class="x-di x-di-v-t x-flt-r">\r\n                        <span class="x-fs-32 x-di x-di-v-m x-radio-arar x-fc-azure x-ml-08 x-pointer" data-item="select"></span>\r\n                    </div>\r\n                {{/if}}\r\n            {{/if}}\r\n            {{#if isUsePoint}}\r\n                {{#if points}}\r\n                    <div class="x-di x-pr-30">\r\n                        <div class="x-fs-00">\r\n                            {{#if isLogin}}\r\n                                <span class="x-fs-24 x-ff-wb x-upper x-di x-di-v-m x-mt-01">{{num-format memberpoints}} {{local \'account.points\'}}</span>\r\n                            {{else}}\r\n                                {{#if complete}}\r\n                                    <span class="x-fs-24 x-ff-wb x-upper x-di x-di-v-m x-mt-01">{{num-format memberpoints}} {{local \'account.points\'}}</span>\r\n                                {{else}}\r\n                                    <span class="x-fs-24 x-ff-wb x-upper x-di x-di-v-m x-mt-01">{{num-format points}} {{local \'account.points\'}}</span>\r\n                                {{/if}}\r\n                            {{/if}}\r\n                        </div>\r\n                        {{#if isManyDays}}\r\n                            <div class="x-fs-16 x-ff-m7 x-mt-08 x-upper">{{local "Property.avg_night"}}</div>\r\n                        {{else}}\r\n                            <div class="x-fs-16 x-ff-m7 x-mt-08 x-upper">{{local "Property.avg_person"}}</div>\r\n                        {{/if}}\r\n                        {{#if enableslashprice}}\r\n                            {{#if PointsCompared}}\r\n                                <div class="x-fs-00">\r\n                                    <span class="x-fs-24 x-upper x-di x-di-v-m x-mt-01" style="text-decoration: line-through;">{{num-format  points}} {{local \'account.points\'}}</span>\r\n                                </div>\r\n                            {{/if}}\r\n                        {{/if}}\r\n                    </div>\r\n                    <div class="x-di x-di-v-t x-flt-r">\r\n                        <span class="x-fs-32 x-di x-di-v-m x-radio-arar x-fc-azure x-ml-08 x-pointer" data-item="select"></span>\r\n                    </div>\r\n                {{/if}}\r\n            {{/if}}\r\n        {{else}}\r\n            <div class="x-mt-36">\r\n                <span class="x-di x-di-v-m"><img class="x-load x-load-sm" src="/assets/img/card/Preloader3.2_RedIcon_300px.gif" alt="{{local "form.loading"}}"></span>\r\n                <span class="x-di x-di-v-m x-fs-14">{{local "booking.price_loading"}}</span>\r\n            </div>\r\n        {{/if}}\r\n    </div>\r\n</div>'},{}],288:[function(e,i,a){i.exports='{{#if expandAll}}\r\n    <div class="book2-child-block x-bd-azure">\r\n        <div class="book2-child-header x-fs-00">\r\n            <h2 class="x-fs-24 x-di x-di-v-m x-lh-29 x-ff-wb x-mr-08">{{type}}</h2>\r\n            {{#if badgetitle}}\r\n                <div class="x-di x-di-v-m">\r\n                    <span class="x-fs-12 x-ff-mh x-lh-22 x-pl-08 x-pr-08 x-di x-di-v-t x-upper x-nowrap x-bc-peach x-fc-white x-lp-01">{{badgetitle}}</span>\r\n                </div>\r\n            {{/if}}\r\n        </div>\r\n        <div class="x-flex x-bc-light">\r\n            <div class="book2-child-room-content book2-all-expand x-cell-top x-bd-arar-r x-bc-white" style="width: 236px;max-width: 236px;">\r\n                <div class="book2-child-image-arar x-fs-00 x-img x-img-top-arar" style="background-image: url(\'{{image}}\')"></div>\r\n                {{#unless noGallery}}\r\n                    <div class="x-fs-00 x-mt-16">\r\n                        <span class="x-fs-18 x-di x-di-v-m x-fc-azure x-pointer icon-icon_A004" data-item="look"></span>\r\n                        <span class="x-fs-16 x-di x-di-v-m x-fc-azure x-pointer x-ml-06 x-under" data-item="look">{{local "booking.quick_look"}}</span>\r\n                    </div>\r\n                {{/unless}}\r\n                <div class="panel-1 x-di x-di-v-t x-normal">\r\n                    <div class="x-mt-08">\r\n                        {{#if amenities.length}}\r\n                            {{#each amenities}}\r\n                                <span class="x-fs-18 x-di x-di-v-m x-default x-popup {{fonticon}}" data-item="popup">\r\n                                    <div class="x-popup-wrap x-fs-00">\r\n                                        <div class="x-popup-body x-fs-16 x-ff-sm x-nowrap" style="padding: 6px 6px;text-align: center;">{{name}}</div>\r\n                                    </div>\r\n                                </span>\r\n                                <span class="x-ml-04 x-di x-di-v-m"></span>\r\n                            {{/each}}\r\n                        {{/if}}\r\n                    </div>\r\n                    {{#if roomtagline}}\r\n                    <div class="x-mt-08">\r\n                        <span class="x-fs-16 x-di x-di-v-m x-ff-sm x-fc-black x-normal">{{roomtagline}}</span>\r\n                    </div>\r\n                    {{else}}\r\n                        {{#if roomsize}}\r\n                            <div class="x-mt-08">\r\n                                <span class="x-fs-16 x-fc-black icon-icon_I016"></span>\r\n                                <span class="x-fs-16 x-ff-sm x-fc-black x-ml-06">{{{specialSymbolFix roomsize}}}</span>\r\n                            </div>\r\n                        {{/if}}\r\n                        <div>\r\n                            {{#if adults.length}}\r\n                                <div class="x-mt-08">\r\n                                    {{#each adults}}\r\n                                        <span class="x-fs-16 x-di x-di-v-m x-fc-black icon-icon_J013"></span>\r\n                                    {{/each}}\r\n                                    {{#equal adults.length 1}}\r\n                                        <span class="x-fs-16 x-di x-di-v-m x-ff-sm x-ml-06">{{local "booking.adult"}}</span>\r\n                                    {{else}}\r\n                                        <span class="x-fs-16 x-di x-di-v-m x-ff-sm x-ml-06">{{local "booking.adults"}}</span>\r\n                                    {{/equal}}\r\n                                    {{#if hasocc}}\r\n                                        <span class="x-di x-di-v-m x-fs-16 x-ml-06 x-default x-popup icon-icon_B008" data-item="maxocc"></span>\r\n                                    {{/if}}\r\n                                </div>\r\n                            {{/if}}\r\n                            {{#if children.length}}\r\n                                <div class="x-mt-08">\r\n                                    {{#each children}}\r\n                                        <span class="x-fs-16 x-di x-di-v-m x-fc-black icon-icon_J012"></span>\r\n                                    {{/each}}\r\n                                    {{#equal children.length 1}}\r\n                                        <span class="x-fs-16 x-di x-di-v-m x-ff-sm x-ml-06">{{local "booking.child"}}</span>\r\n                                    {{else}}\r\n                                        <span class="x-fs-16 x-di x-di-v-m x-ff-sm x-ml-06">{{local "booking.children"}}</span>\r\n                                    {{/equal}}\r\n                                    {{#unless adults.length}}\r\n                                        {{#if hasocc}}\r\n                                                <span class="x-di x-di-v-m x-fs-16 x-ml-06 x-default x-popup icon-icon_B008" data-item="maxocc"></span>\r\n                                        {{/if}}\r\n                                    {{/unless}}\r\n                                </div>\r\n                            {{/if}}\r\n\r\n                        </div>\r\n                    {{/if}}\r\n                    <div class="x-mt-08">\r\n                        {{#each bedtypes}}\r\n                            <div class="x-mb-8">\r\n                                {{#if highlight}}\r\n                                    <div class="x-nowrap x-fc-azure">\r\n                                        <span class="x-fs-16 x-di x-di-v-m {{bedtypeicon}}"></span>\r\n                                        <span class="x-normal x-fs-16 x-di x-di-v-m x-ff-wm x-ml-06 x-under">{{{bedtext}}}</span>\r\n                                    </div>\r\n                                {{else}}\r\n                                    <div class="x-nowrap x-fc-black x-pointer" data-bed-type="{{bedtype}}" data-item="beds">\r\n                                        <span class="x-fs-16 x-di x-di-v-m {{bedtypeicon}}"></span>\r\n                                        <span class="x-normal x-fs-16 x-di x-di-v-m x-ff-sm x-ml-06 x-under">{{{bedtext}}}</span>\r\n                                    </div>\r\n                                {{/if}}\r\n                                <div class="book2-updated-tip x-fs-12 x-mt-08 x-fc-green" data-bed-type="{{bedtype}}">\r\n                                    <span class="x-fs-14 x-di x-di-v-m icon-icon_I009"></span> {{local "booking.updated"}}\r\n                                </div>\r\n                            </div>\r\n                            <div class="x-di x-di-v-t x-ml-08"></div>\r\n                        {{/each}}\r\n                    </div>\r\n                    {{#if loyaltyroomupgradeenable}}\r\n                        <!--<div class="x-mt-18">-->\r\n                            <!--{{#if loyaltyroomupgradeusage}}-->\r\n                                <!--<span data-item="loyaltyroomupgrade_text" class="x-di-v-m x-fs-16 x-pointer x-check x-check-sm checked-azure"></span>-->\r\n                            <!--{{else}}-->\r\n                                <!--<span data-item="loyaltyroomupgrade_text" class="x-di-v-m x-fs-16 x-pointer x-check x-check-sm"></span>-->\r\n                            <!--{{/if}}-->\r\n                            <!--<span data-item="loyaltyroomupgrade_text" class="x-di-v-m x-fs-16 x-fc-azure x-pointer x-pl-06 x-none">{{local "booking.use_upgrade_voucher"}}</span>-->\r\n                            <!--<span data-item="loyaltyroomupgrade_icon" class="x-di-v-m x-fs-16 x-fc-azure x-default x-ml-06 icon-icon_B008"></span>-->\r\n                        <!--</div>-->\r\n                    {{/if}}\r\n                </div>\r\n            </div>\r\n            <div class="book2-child-rate-panel x-cell-top">\r\n                <div class="book2-child-rate-panel-top">\r\n                    <div class="x-ml-20 x-fs-00">\r\n                        <div class="book2-short-block-arar x-di x-di-v-m" style="width: 72%">\r\n                            <div class="x-level">\r\n                                <div class="book2-short-theme x-di x-di-v-m" style="margin-left: 0;margin-right: 0;width: calc(60% - 2px);min-height: 85px;">\r\n                                    <div>\r\n                                        <h2 class="x-fs-24 x-di x-di-v-m x-lh-24 x-ff-wb x-pr-24" style="margin-top: -5px"><span class="x-default x-mr-08" data-item=\'short-p\'>{{data.ratename}}</span>{{#if bestdeal}}<span class="x-ff-mh x-fs-12 x-lh-24 x-pl-05 x-pr-05 x-di x-di-v-m x-upper x-nowrap x-bc-peach x-fc-white x-lp-01">{{ bestdeal }}</span>{{/if}}\r\n                                        </h2>\r\n                                    </div>\r\n                                    <div class="x-mt-08 x-mb-8">\r\n                                    {{#if data.roomstay.RatePlan.paymentType}}\r\n                                        <span class="x-fs-16 x-ff-m7 x-di x-di-v-m x-upper x-default" style="color: #202020; letter-spacing: 1px"><span data-item=\'short-p\'>{{local "booking.pay_now_and_save"}}</span><span class="x-fs-16 x-di x-di-v-m x-ml-06 x-default x-pb-02 icon-icon_B008" data-item="short"></span></span>\r\n                                    {{else}}\r\n                                        <span class="x-fs-16 x-ff-m7 x-di x-di-v-m x-upper x-default" style="color: #202020; letter-spacing: 1px"><span data-item=\'short-p\'>{{local "booking.book_now_and_pay_later"}}</span><span class="x-fs-16 x-di x-di-v-m x-ml-06 x-default x-pb-02 icon-icon_B008" data-item="short"></span></span>\r\n                                    {{/if}}\r\n                                    <!--<span class="x-di x-di-v-m x-fs-16 x-ml-06 x-pointer icon-icon_B008" data-item="short"></span>-->\r\n                                    </div>\r\n                                </div>\r\n                                <div class="x-di x-di-v-t" style="width: 40%">\r\n                                    <div class="panel-2 x-di x-di-v-t x-normal">\r\n                                        {{#if isFinal}}\r\n                                            {{#if availability}}\r\n                                                {{#if isUseMoney}}\r\n                                                    {{#if ratesaved}}\r\n                                                        {{#if isLogin}}\r\n                                                            <span class="x-fs-16 x-di x-di-v-m x-ff-m7 x-fc-azure x-upper">{{local "booking.you_ve_saved"}} <span class="x-nowrap">{{currency}} {{price-format ratesaved}}</span></span>\r\n                                                        {{else}}\r\n                                                            {{#if complete}}\r\n                                                                <span class="x-fs-16 x-di x-di-v-m x-ff-m7 x-upper x-through">{{local "booking.usual_price"}}: <span class="x-nowrap">{{currency}} {{price-format rate}}</span>></span>\r\n                                                            {{else}}\r\n                                                                <!--<span class="x-fs-16 x-di x-di-v-m x-ff-m7 x-upper">{{local "Property.members_pay"}}: {{currency}} {{price-format memberrate}}</span>-->\r\n                                                                <span class="x-fs-16 x-di x-di-v-m x-ff-m7 x-upper">{{local "booking.members_save"}}: <span class="x-nowrap">{{currency}} {{price-format ratesaved}}</span></span>\r\n                                                            {{/if}}\r\n\r\n                                                            <!--<div class="x-mt-04">-->\r\n                                                            <!--<span style="display: inline-block; max-width: 250px; line-height: 14px">-->\r\n                                                                <!--{{#if complete}}-->\r\n                                                            <!--<span class="x-fs-14 x-fc-white x-bc-azure x-di-v-m x-mr-06 icon-icon_I009"></span>-->\r\n                                                            <!--<span class="x-fs-12 x-ff-mm x-fw-none x-fc-azure x-di-v-m x-under">{{local "booking.complete_then_sign"}}</span>-->\r\n                                                                <!--{{else}}-->\r\n                                                            <!--<span class="x-fs-12 x-ff-mm x-fw-none x-pointer x-fc-azure x-under" data-item="sign">{{local "booking.sign_up_to_pay" currency ratesavedformat }}</span>-->\r\n                                                                <!--{{/if}}-->\r\n                                                            <!--</span>-->\r\n                                                            <!--</div>-->\r\n                                                        {{/if}}\r\n                                                        <div class="x-mt-08"></div>\r\n                                                    {{else}}\r\n                                                        {{#if restricted}}\r\n                                                            <div class="x-fs-16 x-ff-sm x-italic x-fc-gray">{{local "booking.loyalty_discount_not_applicable"}}</div>\r\n                                                            <div class="x-mt-08"></div>\r\n                                                        {{/if}}\r\n                                                    {{/if}}\r\n                                                {{/if}}\r\n                                                {{#if isUsePoint}}\r\n                                                    {{#if pointssaved}}\r\n                                                        {{#if isLogin}}\r\n                                                            <span class="x-fs-16 x-di x-di-v-m x-ff-m7 x-fc-azure x-upper">{{local "booking.you_ve_saved"}} <span class="x-nowrap">{{num-format pointssaved}} {{local "checkout.points"}}</span></span>\r\n                                                        {{else}}\r\n                                                            {{#if complete}}\r\n                                                                <span class="x-fs-16 x-di x-di-v-m x-ff-m7 x-upper x-through">{{local "booking.usual_price"}}: {{num-format points}}</span>\r\n                                                            {{else}}\r\n                                                                <!--<span class="x-fs-16 x-di x-di-v-m x-ff-m7 x-upper">{{local "Property.members_pay"}}: {{num-format memberpoints}} {{local "checkout.points"}}</span>-->\r\n                                                                <span class="x-fs-16 x-di x-di-v-m x-ff-m7 x-upper">{{local "booking.members_save"}}: <span class="x-nowrap">{{num-format pointssaved}} {{local "checkout.points"}}</span></span>\r\n                                                            {{/if}}\r\n                                                            <!--<div class="x-mt-04">-->\r\n                                                            <!--<span style="display: inline-block; max-width: 250px; line-height: 14px">-->\r\n                                                                <!--{{#if complete}}-->\r\n                                                            <!--<span class="x-fs-14 x-fc-white x-bc-azure x-di-v-m x-mr-06 icon-icon_I009"></span>-->\r\n                                                            <!--<span class="x-fs-12 x-ff-mm x-fw-none x-fc-azure x-di-v-m x-under">{{local "booking.complete_then_sign"}}</span>-->\r\n                                                                <!--{{else}}-->\r\n                                                            <!--<span class="x-fs-12 x-ff-mm x-fw-none x-pointer x-fc-azure x-under" data-item="sign">{{local "booking.sign_up_to_pay" currency ratesavedformat }}</span>-->\r\n                                                                <!--{{/if}}-->\r\n                                                            <!--</span>-->\r\n                                                            <!--</div>-->\r\n                                                        {{/if}}\r\n                                                        <div class="x-mt-08"></div>\r\n                                                    {{else}}\r\n                                                        {{#if restricted}}\r\n                                                            <div class="x-fs-16 x-ff-sm x-italic x-fc-gray">{{local "booking.loyalty_discount_not_applicable"}}</div>\r\n                                                            <div class="x-mt-08"></div>\r\n                                                        {{/if}}\r\n                                                    {{/if}}\r\n                                                {{/if}}\r\n                                            {{/if}}\r\n                                        {{/if}}\r\n                                    </div>\r\n                                </div>\r\n                            </div>\r\n                            <div data-region="stay"></div>\r\n                        </div>\r\n                        <div class="book2-child-price-block x-mt-13 x-di x-di-v-t x-pl-10 x-pr-15" style="width: 28%">\r\n                            <div class="panel-2 x-di x-di-v-t x-normal x-al-r x-full x-level">\r\n                                {{#if isFinal}}\r\n                                    {{#if availability}}\r\n                                        {{#if isUseMoney}}\r\n                                            {{#if rate}}\r\n                                                <div class="x-di x-pr-30">\r\n                                                    <div class="x-fs-00">\r\n                                                        {{#if isLogin}}\r\n                                                            <span class="x-fs-24 x-ff-wb x-upper x-di x-di-v-m x-mt-01">{{currency}} {{price-format memberrate}}</span>\r\n                                                        {{else}}\r\n                                                            {{#if complete}}\r\n                                                                <span class="x-fs-24 x-ff-wb x-upper x-di x-di-v-m x-mt-01">{{currency}} {{price-format memberrate}}</span>\r\n                                                            {{else}}\r\n                                                                <span class="x-fs-24 x-ff-wb x-upper x-di x-di-v-m x-mt-01">{{currency}} {{price-format rate}}</span>\r\n                                                            {{/if}}\r\n                                                        {{/if}}\r\n                                                    </div>\r\n                                                    {{#if upgradePoints}}\r\n                                                        <div class="x-fs-00">\r\n                                                            <span class="x-fs-24 x-ff-wb x-di x-di-v-m x-fc-peach x-ml-04 x-mr-04">+</span>\r\n                                                            <span class="x-fs-24 x-ff-wb x-upper x-di x-di-v-m x-fc-peach">{{num-format upgradePoints}} PTS</span>\r\n                                                        </div>\r\n                                                    {{/if}}\r\n                                                    {{#if isManyDays}}\r\n                                                        <div class="x-fs-16 x-ff-m7 x-mt-08 x-upper">{{local "Property.avg_night"}}</div>\r\n                                                    {{else}}\r\n                                                        <div class="x-fs-16 x-ff-m7 x-upper x-mt-08">{{local "Property.avg_person"}}</div>\r\n                                                    {{/if}}\r\n                                                    {{#if enableslashprice}}\r\n                                                        {{#if priceCompared}}\r\n                                                            <div class="x-fs-00">\r\n                                                                <span class="x-fs-24  x-upper x-di x-di-v-m x-mt-08" style="text-decoration: line-through;">{{currency}} {{price-format originrate}}</span>\r\n                                                            </div>\r\n                                                        {{/if}}\r\n                                                    {{/if}}\r\n                                                </div>\r\n                                                <div class="x-di x-di-v-t x-flt-r">\r\n                                                        <span class="x-fs-32 x-di x-di-v-m x-radio-arar x-fc-azure x-ml-08 x-default checked"></span>\r\n                                                </div>\r\n                                            {{/if}}\r\n                                        {{/if}}\r\n                                        {{#if isUsePoint}}\r\n                                            {{#if points}}\r\n                                                <div class="x-di x-pr-30">\r\n                                                    <div class="x-fs-00">\r\n                                                        {{#if isLogin}}\r\n                                                            <span class="x-fs-24 x-ff-wb x-upper x-di x-di-v-m x-mt-01">{{num-format memberpoints}}{{#unless upgradePoints}} {{local \'account.points\'}}{{/unless}}</span>\r\n                                                        {{else}}\r\n                                                            {{#if complete}}\r\n                                                                <span class="x-fs-24 x-ff-wb x-upper x-di x-di-v-m x-mt-01">{{num-format memberpoints}}{{#unless upgradePoints}} {{local \'account.points\'}}{{/unless}}</span>\r\n                                                            {{else}}\r\n                                                                <span class="x-fs-24 x-ff-wb x-upper x-di x-di-v-m x-mt-01">{{num-format points}}{{#unless upgradePoints}} {{local \'account.points\'}}{{/unless}}</span>\r\n                                                            {{/if}}\r\n                                                        {{/if}}\r\n                                                    </div>\r\n                                                    {{#if upgradePoints}}\r\n                                                        <div class="x-fs-00">\r\n                                                            <span class="x-fs-24 x-ff-wb x-di x-di-v-m x-fc-peach x-ml-04 x-mr-04">+</span>\r\n                                                            <span class="x-fs-24 x-ff-wb x-upper x-di x-di-v-m x-fc-peach">{{num-format upgradePoints}} PTS</span>\r\n                                                        </div>\r\n                                                    {{/if}}\r\n                                                    {{#if isManyDays}}\r\n                                                        <div class="x-fs-16 x-ff-m7 x-mt-08 x-upper">{{local "Property.avg_night"}}</div>\r\n                                                    {{else}}\r\n                                                        <div class="x-fs-16 x-ff-m7 x-upper x-mt-08">{{local "Property.avg_person"}}</div>\r\n                                                    {{/if}}\r\n                                                    {{#if enableslashprice}}\r\n                                                        {{#if PointsCompared}}\r\n                                                            <div class="x-fs-00">\r\n                                                                <span class="x-fs-24  x-upper x-di x-di-v-m x-mt-08" style="text-decoration: line-through;">{{num-format originpoints}} {{local \'account.points\'}}</span>\r\n                                                            </div>\r\n                                                        {{/if}}\r\n                                                    {{/if}}\r\n                                                </div>\r\n                                                <div class="x-di x-di-v-t x-flt-r">\r\n                                                        <span class="x-fs-32 x-di x-di-v-m x-radio-arar x-fc-azure x-ml-08 x-default checked"></span>\r\n                                                </div>\r\n                                            {{/if}}\r\n                                        {{/if}}\r\n                                        <div>\r\n                                            <div class="x-mt-70 x-full x-al-r {{#if roomsOfUnits}}x2-disable{{/if}}">\r\n                                                <button type="button" class="x-fs-14 x-ff-mh x-btn x-btn-azure" data-pmg="{{pmg}}" data-item="book" style="width: 100%;letter-spacing: 1px;white-space: normal;max-width:200px;">{{local "booking.checkout"}}</button>\r\n                                            </div>\r\n                                            {{#if data.priceratio.list.length}}\r\n                                                <div class="x-mt-13" style="font-size: 10px; opacity: .6; margin-bottom: 20px">\r\n                                                    <span class="x-al-l x-di x-full" data-pmg="{{pmg}}" style="max-width: 200px">\r\n                                                        <div class="x-fs-15 x-ff-m7 x-fc-green x-upper">{{data.priceratio.title}}</div>\r\n                                                        <div class="x-fs-00 x-mt-10 x-nowrap x-flex">\r\n                                                            <div class="x-di x-di-v-t x-cell" style="width: 68%">\r\n                                                                {{#each data.priceratio.list}}\r\n                                                                    <div class="x-ff-sm x-lh-15 x-mb-4 x-fs-13">{{website}}</div>\r\n                                                                {{/each}}\r\n                                                            </div>\r\n                                                            <div class="x-di x-di-v-t x-cell">\r\n                                                                {{#each data.priceratio.list}}\r\n                                                                    <div class="x-ff-sm x-lh-15 x-mb-4 x-fs-13">{{currency}} {{price-format price}}</div>\r\n                                                                {{/each}}\r\n                                                            </div>\r\n                                                        </div>\r\n                                                        {{#if data.priceratio.rategainDisclaimer}}\r\n                                                            <div class="x-fs-14 x-ff-sm x-mt-10 x-italic">{{data.priceratio.rategainDisclaimer}}</div>\r\n                                                        {{/if}}\r\n                                                    </span>\r\n                                                </div>\r\n                                            {{/if}}\r\n                                        </div>\r\n                                    {{/if}}\r\n                                {{else}}\r\n                                    <div class="x-mt-36">\r\n                                        <span class="x-di x-di-v-m"><img class="x-load x-load-sm" alt="" src="/assets/img/card/Preloader3.2_RedIcon_300px.gif" alt="{{local "form.loading"}}"></span>\r\n                                        <span class="x-di x-di-v-m x-fs-14">{{local "booking.price_loading"}}</span>\r\n                                    </div>\r\n                                {{/if}}\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n                <div data-region="list"></div>\r\n            </div>\r\n        </div>\r\n    </div>\r\n\r\n{{else}}\r\n    <div class="book2-child-block x-highlight-all">\r\n        {{#if availability}}\r\n            <div class="book2-child-header-sm x-fs-00">\r\n                <h2 class="x-fs-24 x-di x-di-v-m x-lh-29 x-ff-wb x-mr-08 x-pointer" data-item="hand">{{type}}</h2>\r\n                {{#if badgetitle}}\r\n                    <div class="x-di x-di-v-m">\r\n                        <span class="x-fs-12 x-ff-mh x-lh-22 x-pl-08 x-pr-08 x-di x-di-v-t x-upper x-nowrap x-bc-peach x-fc-white x-lp-01">{{badgetitle}}</span>\r\n                    </div>\r\n                {{/if}}\r\n            </div>\r\n            <div class="x-flex">\r\n                <div class="book2-child-room-content x-cell-top x-arar-after">\r\n                    <div class="book2-child-image-arar x-fs-00 x-img x-img-top-arar x-pointer" data-item="hand" style="background-image: url(\'{{image}}\')"></div>\r\n                    {{#unless noGallery}}\r\n                        <div class="x-fs-00 x-mt-16">\r\n                            <span class="x-fs-18 x-di x-di-v-m x-fc-azure x-pointer icon-icon_A004" data-item="look"></span>\r\n                            <span class="x-fs-16 x-di x-di-v-m x-fc-azure x-pointer x-ml-06 x-under" data-item="look">{{local "booking.quick_look"}}</span>\r\n                        </div>\r\n                    {{/unless}}\r\n                    <div class="panel-1 x-di x-di-v-t x-normal">\r\n                        <div class="x-mt-08">\r\n                            {{#if amenities.length}}\r\n                                {{#each amenities}}\r\n                                    <span class="x-fs-18 x-di x-di-v-m x-default x-popup {{fonticon}}" data-item="popup">\r\n                                    <div class="x-popup-wrap x-fs-00">\r\n                                        <div class="x-popup-body x-fs-16 x-ff-sm x-nowrap" style="padding: 6px 6px;text-align: center;">{{name}}</div>\r\n                                    </div>\r\n                                </span>\r\n                                    <span class="x-ml-04 x-di x-di-v-m"></span>\r\n                                {{/each}}\r\n                            {{/if}}\r\n                        </div>\r\n                        {{#if roomtagline}}\r\n                            <div class="x-mt-08">\r\n                                <span class="x-fs-16 x-di x-di-v-m x-ff-sm x-fc-black x-normal">{{roomtagline}}</span>\r\n                            </div>\r\n                        {{else}}\r\n                            {{#if roomsize}}\r\n                                <div class="x-mt-08">\r\n                                    <span class="x-fs-16 x-fc-black icon-icon_I016"></span>\r\n                                    <span class="x-fs-16 x-ff-sm x-fc-black x-ml-06">{{{specialSymbolFix roomsize}}}</span>\r\n                                </div>\r\n                            {{/if}}\r\n                            <div>\r\n                                {{#if adults.length}}\r\n                                    <div class="x-mt-08">\r\n                                        {{#each adults}}\r\n                                            <span class="x-fs-16 x-di x-di-v-m x-fc-black icon-icon_J013"></span>\r\n                                        {{/each}}\r\n                                        {{#equal adults.length 1}}\r\n                                            <span class="x-fs-16 x-di x-di-v-m x-ff-sm x-ml-06">{{local "booking.adult"}}</span>\r\n                                        {{else}}\r\n                                            <span class="x-fs-16 x-di x-di-v-m x-ff-sm x-ml-06">{{local "booking.adults"}}</span>\r\n                                        {{/equal}}\r\n                                        {{#if hasocc}}\r\n                                            <span class="x-di x-di-v-m x-fs-16 x-ml-06 x-default x-popup icon-icon_B008" data-item="maxocc"></span>\r\n                                        {{/if}}\r\n                                    </div>\r\n                                {{/if}}\r\n                                {{#if children.length}}\r\n                                    <div class="x-mt-08">\r\n                                        {{#each children}}\r\n                                            <span class="x-fs-16 x-di x-di-v-m x-fc-black icon-icon_J012"></span>\r\n                                        {{/each}}\r\n                                        {{#equal children.length 1}}\r\n                                            <span class="x-fs-16 x-di x-di-v-m x-ff-sm x-ml-06">{{local "booking.child"}}</span>\r\n                                        {{else}}\r\n                                            <span class="x-fs-16 x-di x-di-v-m x-ff-sm x-ml-06">{{local "booking.children"}}</span>\r\n                                        {{/equal}}\r\n                                        {{#unless adults.length}}\r\n                                            {{#if hasocc}}\r\n                                                <span class="x-di x-di-v-m x-fs-16 x-ml-06 x-default x-popup icon-icon_B008" data-item="maxocc"></span>\r\n                                            {{/if}}\r\n                                        {{/unless}}\r\n                                    </div>\r\n                                {{/if}}\r\n\r\n                            </div>\r\n                        {{/if}}\r\n                        \r\n                        <div class="x-mt-08">\r\n                            {{#each bedtypes}}\r\n                                <div class="x-mb-8">\r\n                                    {{#if highlight}}\r\n                                        <div class="x-nowrap x-fc-azure">\r\n                                            <span class="x-fs-16 x-di x-di-v-m {{bedtypeicon}}"></span>\r\n                                            <span class="x-normal x-fs-16 x-di x-di-v-m x-ff-wm x-ml-06 x-under">{{{bedtext}}}</span>\r\n                                        </div>\r\n                                    {{else}}\r\n                                        <div class="x-nowrap x-fc-black x-pointer" data-bed-type="{{bedtype}}" data-item="beds">\r\n                                            <span class="x-fs-16 x-di x-di-v-m {{bedtypeicon}}"></span>\r\n                                            <span class="x-normal x-fs-16 x-di x-di-v-m x-ff-sm x-ml-06 x-under">{{{bedtext}}}</span>\r\n                                        </div>\r\n                                    {{/if}}\r\n                                    <div class="book2-updated-tip x-fs-12 x-mt-08 x-fc-green" data-bed-type="{{bedtype}}">\r\n                                        <span class="x-fs-14 x-di x-di-v-m icon-icon_I009"></span> {{local "booking.updated"}}\r\n                                    </div>\r\n                                </div>\r\n                                <div class="x-di x-di-v-t x-ml-08"></div>\r\n                            {{/each}}\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n                <div data-region="list" class="x-cell-top book2-list-sm x-pb-04"></div>\r\n            </div>\r\n        {{/if}}\r\n    </div>\r\n{{/if}}';
},{}],287:[function(e,i,a){i.exports="{{bedtype}} <span class='x-nowrap'>({{operator}}{{currency}}{{price-format difference}})</span>"},{}],286:[function(e,i,a){i.exports="{{bedtype}} <span class='x-nowrap'>({{operator}}{{num-format difference}})</span>"},{}],285:[function(e,i,a){var t=(e("underscore"),e("backbone"),e("backbone.marionette")),r=e("./rate-calendar/view"),n=e("./rate-calendar/locals"),o=e("../../../../ui/util"),s=null,l=e("moment");i.exports=t.LayoutView.extend({template:Handlebars.compile(e("./template.hbs")),className:"book2-content-section-calendar",regions:{calendar:"[data-region='rate-calendar-content']"},ui:{checkMemberPrice:"[data-item='rc-view-mp']",checkMemberPriceTip:"[data-item='rc-view-mp-tip']"},events:{},serializeData:function(){var e,i,a=this,t=a.options.rootState;return this.rate&&this.rate[0]&&(e=this.rate[0].currencyMark,i=this.rate[0].currencyName),{isLogin:t.isLogin(),currency:e&&i?e+" "+i:null}},initialize:function(){var e=this.options.rootState;this.isUseMoney=e.isTrade(e.VIEW_TRADES.USE_MONEY),this.isUsePoint=e.isTrade(e.VIEW_TRADES.USE_POINT),this.rate=e.getCalendarRate(),this.viewMember=e.isLogin(),this.changeMonth=0,s=null,this.listenTo(e,"redrawViewChild",this.showCalendar),this.__renderDeferred=jQuery.Deferred()},onRender:function(){var e=this;e.__renderDeferred.resolve(),e.__showCalendar(e.rate);var i=o.queryparam();i.rateCalendar||(i.rateCalendar=!0,i.promocode||(i.promocode=i.promo=""),o.updateParamHistor(i))},onDestroy:function(){var e=o.queryparam();e.rateCalendar&&(delete e.rateCalendar,e.promocode||(e.promocode=e.promo=""),o.updateParamHistor(e))},showCalendar:function(){return this.__renderDeferred.then(jQuery.proxy(this.__showCalendar,this,this.rate))},__showCalendar:function(){var e=this.options.rootState,i=this;this.calendarView=new r({nowMonth:e.getParam().checkin,maxMonth:this.__setCalenderNum(this.rate),changeMonth:this.changeMonth,rate:this.rate,useMoney:e.isTrade(e.VIEW_TRADES.USE_MONEY),usePoint:e.isTrade(e.VIEW_TRADES.USE_POINT),viewMember:this.viewMember,selectDate:s}),this.getRegion("calendar").show(this.calendarView),this.calendarView.on("rc:add:month",function(){i.changeMonth+=1}),this.calendarView.on("rc:minus:month",function(){i.changeMonth-=1}),this.calendarView.on("date:been:select",function(i){var a=i,t=n.nextDate(a),r={prevDate:a,nextDate:t};e.trigger("updateDate",r),e.trigger("updateResults")})},__setCalenderNum:function(e){var i=null;e&&e.length&&(i=l(e[e.length-1].checkinDate)._d);var a=i?i.getTime()-(new Date).getTime():0;return 0==parseInt(a/864e5)?0:parseInt(a/864e5)+2},showTip:function(){var e=this;this.ui.checkMemberPrice.hasClass("checked")?(this.viewMember=!1,this.showCalendar(),this.ui.checkMemberPrice.removeClass("checked"),this.ui.checkMemberPriceTip.finish().animate({opacity:0},200)):(this.ui.checkMemberPrice.addClass("checked"),this.viewMember=!0,this.showCalendar(),this.ui.checkMemberPriceTip.finish().animate({opacity:1},200),clearTimeout(this.timeID),this.timeID=setTimeout(e.removeTip,5e3))},removeTip:function(){jQuery("[data-item='rc-view-mp-tip']").finish().animate({opacity:0},200)}})},{"../../../../ui/util":2122,"./rate-calendar/locals":281,"./rate-calendar/view":283,"./template.hbs":284,backbone:8,"backbone.marionette":6,moment:16,underscore:42}],284:[function(e,i,a){i.exports='<div class="rc-container">\r\n    <!--<div class="rc-header">-->\r\n        <!--<div class="rc-title">{{local "booking.match_prices"}}</div>-->\r\n        <!--{{#if isLogin}}-->\r\n            <!--{{else}}-->\r\n            <!--<div class="rc-view-mp">-->\r\n                <!--<span class="rc-checkbox" data-item="rc-view-mp"></span>-->\r\n                <!--<span class="rc-view-mp-content">-->\r\n                    <!--<span>{{local "booking.view_member_rate"}}</span>-->\r\n                    <!--<div>-->\r\n                       <!--{{local "booking.get_lower_rates"}}-->\r\n                    <!--</div>-->\r\n                <!--</span>-->\r\n                <!--<div class="rc-view-mp-tip-box" data-item="rc-view-mp-tip">-->\r\n                    <!--<span class="rc-view-mp-tip-box-content"><span class="icon-icon_I009"></span>{{local "booking.unlock_lower_rates"}}</span>-->\r\n                <!--</div>-->\r\n            <!--</div>-->\r\n        <!--{{/if}}-->\r\n    <!--</div>-->\r\n    <div class="rc-content" data-region="rate-calendar-content"></div>\r\n    <div class="rc-footer">\r\n        <div class="rc-bottom-tip">\r\n            <div class="rc-click-tip">{{local "booking.simply_click"}}</div>\r\n            <div class="rc-match-price">{{#if currency}}{{local-replace \'booking.rate_currency\' currency}}{{/if}}</div>\r\n        </div>\r\n        <div class="rc-cutline">\r\n            <div class="rc-cutline-hd">\r\n                <span class="rc-square"></span><span>{{local "booking.high_demand"}}</span>\r\n            </div>\r\n            <div class="rc-cutline-lr">\r\n                <span class="rc-square"></span><span>{{local "booking.lowest_rate"}}</span>\r\n            </div>\r\n        </div>\r\n    </div>\r\n</div>'},{}],283:[function(e,i,a){var t=e("backbone.marionette"),r=e("./locals");i.exports=t.ItemView.extend({ui:{cells:".x-solar-cell",validDateItem:".x-solar-item.valid-date"},events:{"click .x-solar-icon-prev":function(e){this.goToPrevMonth(e)},"click .x-solar-prev-content":function(e){this.goToPrevMonth(e)},"click .x-solar-icon-next":function(e){this.goToNextMonth(e)},"click .x-solar-next-content":function(e){this.goToNextMonth(e)},"click      @ui.validDateItem":function(e){e.stopPropagation();var i=jQuery(e.currentTarget),a=i.find(".x-solar-cell"),t=a.find(".x-solar-none"),r=a.find(".x-solar-text"),n=a.find(".x-solar-mask");t.length||!r.length||n.hasClass("rc-sold-out")||this.trigger("date:been:select",new Date(a.attr("data-date")))},"mouseenter @ui.validDateItem":function(e){e.stopPropagation();var i=jQuery(e.currentTarget),a=i.find(".x-solar-cell"),t=a.find(".x-solar-text");t.length&&this.trigger("date:will:select",new Date(a.attr("data-date")))},"mouseleave @ui.validDateItem":function(){this.__rendered&&this.showDateCSS({prevDate:this.prevDate,nextDate:this.nextDate,currentDate:this.currentDate})}},template:function(i){return Handlebars.compile(e("./template.hbs"))(i)},className:function(){return"x-solar"},serializeData:function(){return{weeks:r.weeks,title:r.months[this.nowMonth.getMonth()]+" "+this.nowMonth.getFullYear(),prevTitle:r.months[this.prevMonth.getMonth()]+" "+this.prevMonth.getFullYear(),nextTitle:r.months[this.nextMonth.getMonth()]+" "+this.nextMonth.getFullYear(),days:r.getDays(this.nowMonth,r.nowDate(),this.rate,this.maxDays,this.selectDate),prev:this.havePrevMonth(r.nowMonth(),this.nowMonth),next:this.maxMonth?this.haveNextMonth(this.maxMonth,this.nowMonth):!0,showRate:this.showRate,useMoney:this.useMoney,usePoint:this.usePoint,viewMember:this.viewMember}},initialize:function(e){this.maxDays=e.maxMonth,this.maxMonth=e.maxMonth?r.getMaxMonth(e.maxMonth):null,this.nowMonth=e.nowMonth?e.nowMonth:r.nowMonth(),this.prevMonth=r.prevMonth(this.nowMonth),this.nextMonth=r.nextMonth(this.nowMonth),this.showRate=e.showRate,this.rate=e.rate,this.useMoney=e.useMoney,this.usePoint=e.usePoint,this.viewMember=e.viewMember,this.selectDate=e.selectDate,this.options.noClickOff||(this.cancelFN=jQuery.proxy(this.__undo,this))},onDestroy:function(){this.__rendered=!1,this.options.noClickOff||jQuery(document).off("click",this.cancelFN)},onRender:function(){this.options.noClickOff||jQuery(document).off("click",this.cancelFN).on("click",this.cancelFN),this.__rendered=!0,this.showDateCSS({prevDate:this.prevDate,nextDate:this.nextDate,currentDate:this.currentDate})},initOptions:function(e){this.maxMonth=e.maxMonth,this.nowMonth=e.nowMonth||r.nowMonth(),this.prevMonth=r.prevMonth(this.nowMonth),this.nextMonth=r.nextMonth(this.nowMonth),this.prevDate=e.prevDate,this.nextDate=e.nextDate,this.currentDate=e.currentDate,this.showRate=e.showRate,this.__rendered&&this.render()},showDateCSS:function(e){if(this.ui.cells.removeClass("prev"),this.ui.cells.removeClass("next"),this.ui.cells.removeClass("note"),this.ui.cells.removeClass("current"),e.prevDate&&this.$el.find("[data-date='"+e.prevDate.toUTCString()+"']").addClass("prev"),e.nextDate)if(e.nextDate>e.prevDate)this.$el.find("[data-date='"+e.nextDate.toUTCString()+"']").addClass("next");else{var i=r.nextDate(e.prevDate);this.$el.find("[data-date='"+i.toUTCString()+"']").addClass("next")}if(e.prevDate&&e.nextDate)for(var a=r.nextDate(e.prevDate),t=r.prevDate(e.nextDate);t>=a;a.setDate(a.getDate()+1))this.$el.find("[data-date='"+a.toUTCString()+"']").addClass("note");e.currentDate&&this.$el.find("[data-date='"+e.currentDate.toUTCString()+"']").addClass("current")},__undo:function(e){0===this.$el.has(e.target).length&&this.trigger("date:cancel")},goToPrevMonth:function(e){e&&e.stopPropagation(),this.trigger("rc:minus:month"),this.initOptions({nowMonth:r.prevMonth(this.nowMonth),prevDate:this.prevDate,nextDate:this.nextDate,currentDate:this.currentDate,maxMonth:this.maxMonth,showRate:this.showRate})},goToNextMonth:function(e){e&&e.stopPropagation(),this.trigger("rc:add:month"),this.initOptions({nowMonth:r.nextMonth(this.nowMonth),prevDate:this.prevDate,nextDate:this.nextDate,currentDate:this.currentDate,maxMonth:this.maxMonth,showRate:this.showRate})},haveNextMonth:function(e,i){return e.getFullYear()>i.getFullYear()?!0:1===e.getDate()?e.getMonth()-1>i.getMonth():e.getMonth()>i.getMonth()},havePrevMonth:function(e,i){return e.getFullYear()<i.getFullYear()?!0:e.getMonth()<i.getMonth()}})},{"./locals":281,"./template.hbs":282,"backbone.marionette":6}],282:[function(e,i,a){i.exports='<table class="x-solar-tab" border="0" cellpadding="0" cellspacing="0">\r\n    <thead>\r\n        <tr>\r\n            <th class="x-solar-item" colspan="2">\r\n                <div class="x-solar-cell-head">\r\n                    {{#if prev}}\r\n                        <span class="x-solar-prev-content">{{prevTitle}}</span>\r\n                        <span class="x-solar-icon x-solar-icon-prev"></span>\r\n                    {{/if}}\r\n                </div>\r\n            </th>\r\n            <th class="x-solar-date" colspan="3">{{title}}</th>\r\n            <th class="x-solar-item" colspan="2">\r\n                <div class="x-solar-cell-head">\r\n                    {{#if next}}\r\n                        <span class="x-solar-next-content">{{nextTitle}}</span>\r\n                        <span class="x-solar-icon x-solar-icon-next"></span>\r\n                    {{/if}}\r\n                </div>\r\n            </th>\r\n        </tr>\r\n        <tr>\r\n            {{#each weeks}}\r\n                <th class="x-solar-item">\r\n                    <div class="x-solar-cell-head">\r\n                        <span class="x-solar-head">{{this}}</span>\r\n                    </div>\r\n                </th>\r\n            {{/each}}\r\n        </tr>\r\n    </thead>\r\n    <tbody>\r\n        {{#if useMoney}}\r\n            {{#if viewMember}}\r\n                {{#each days}}\r\n                    <tr>\r\n                        {{#each this}}\r\n                            <td class="x-solar-item {{#if this}}valid-date{{/if}}">\r\n                                <div class="x-solar-cell{{#if this.soldOut}} rc-sold-out{{/if}}" {{#if this}}data-date="{{this.UTC}}"{{/if}}>\r\n                                    {{#if this}}\r\n                                        {{#if this.live}}\r\n                                            <span class="x-solar-mask{{#if this.soldOut}} rc-sold-out{{/if}}{{#if this.select}} select{{/if}}">\r\n                                                <svg width="100%" height="100%" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 16">\r\n                                                    <path d="M 0 0 V 0 16 H 15 L 20 8 L 15 0 Z" class="prev"/>\r\n                                                    <path d="M 5 0 L 0 8 L 5 16 H 20 V 0 Z" class="next"/>\r\n                                                </svg>\r\n                                            </span>\r\n                                            <span class="x-solar-text">{{this.text}}</span>\r\n                                            {{#if this.soldOut}}\r\n                                                <span class="x-solar-price rc-sold-out">{{local \'booking.sold_out\'}}</span>\r\n                                            {{else}}\r\n                                                <span class="x-solar-price{{#if this.sellingFast}} rc-sf{{/if}}{{#if this.lowestRate}} rc-lr{{/if}}">{{#if this.currencyMark}}{{this.currencyMark}}{{/if}} <span class="rc-num">{{rc-price-format this.memberPrice}}</span></span>\r\n                                                {{#if this.memberPMG}}\r\n                                                    <div class="x-solar-pmg">\r\n                                                        <span class="rc-pmg-mask">\r\n                                                            <span class="icon-icon_B016"></span>\r\n                                                            <div class="rc-pmg-popup">\r\n                                                                <p class="rc-pmg-header">{{this.MPMGTitle}}</p>\r\n                                                                {{#each this.memberPMG}}\r\n                                                                    <p class="rc-pmg-content">\r\n                                                                        <span class="rc-pmg-name">{{website}}</span>\r\n                                                                        <span class="rc-pmg-price">{{currencyMark}} {{#if showwithtax}}{{rc-price-format originpricewithtax}}{{else}}{{rc-price-format originprice}}{{/if}}</span>\r\n                                                                    </p>\r\n                                                                {{/each}}\r\n                                                                {{#if this.memberRategainDisclaimer}}\r\n                                                                    <p class="rc-pmg-content x-italic">{{this.memberRategainDisclaimer}}</p>\r\n                                                                {{/if}}\r\n                                                            </div>\r\n                                                        </span>\r\n                                                    </div>\r\n                                                {{/if}}\r\n                                            {{/if}}\r\n\r\n                                        {{else}}\r\n                                            <span class="x-solar-none">\r\n                                        <span class="x-solar-text">{{this.text}}</span>\r\n                                    </span>\r\n                                        {{/if}}\r\n                                    {{else}}\r\n                                        <span class="x-solar-none"></span>\r\n                                    {{/if}}\r\n                                </div>\r\n                            </td>\r\n                        {{/each}}\r\n                    </tr>\r\n                {{/each}}\r\n            {{else}}\r\n                {{#each days}}\r\n                    <tr>\r\n                        {{#each this}}\r\n                            <td class="x-solar-item {{#if this}}valid-date{{/if}}">\r\n                                <div class="x-solar-cell{{#if this.soldOut}} rc-sold-out{{/if}}" {{#if this}}data-date="{{this.UTC}}"{{/if}}>\r\n                                    {{#if this}}\r\n                                        {{#if this.live}}\r\n                                            <span class="x-solar-mask{{#if this.soldOut}} rc-sold-out{{/if}}{{#if this.select}} select{{/if}}">\r\n                                        <svg width="100%" height="100%" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 16">\r\n                                            <path d="M 0 0 V 0 16 H 15 L 20 8 L 15 0 Z" class="prev"/>\r\n                                            <path d="M 5 0 L 0 8 L 5 16 H 20 V 0 Z" class="next"/>\r\n                                        </svg>\r\n                                    </span>\r\n                                            <span class="x-solar-text">{{this.text}}</span>\r\n\r\n                                            {{#if this.soldOut}}\r\n                                                <span class="x-solar-price rc-sold-out">{{local \'booking.sold_out\'}}</span>\r\n                                            {{else}}\r\n                                                <span class="x-solar-price{{#if this.sellingFast}} rc-sf{{/if}}{{#if this.lowestRate}} rc-lr{{/if}}">{{#if this.currencyMark}}{{this.currencyMark}}{{/if}} <span class="rc-num">{{rc-price-format this.price}}</span></span>\r\n                                                {{#if this.PMG}}\r\n                                                    <div class="x-solar-pmg">\r\n                                                        <span class="rc-pmg-mask">\r\n                                                            <span class="icon-icon_B016"></span>\r\n                                                            <div class="rc-pmg-popup">\r\n                                                                <p class="rc-pmg-header">{{this.PMGTitle}}</p>\r\n                                                                {{#each this.PMG}}\r\n                                                                    <p class="rc-pmg-content">\r\n                                                                        <span class="rc-pmg-name">{{website}}</span>\r\n                                                                        <span class="rc-pmg-price">{{currencyMark}} {{#if showwithtax}}{{rc-price-format originpricewithtax}}{{else}}{{rc-price-format originprice}}{{/if}}</span>\r\n                                                                    </p>\r\n                                                                {{/each}}\r\n                                                                {{#if this.rategainDisclaimer}}\r\n                                                                    <p class="rc-pmg-content x-italic">{{this.rategainDisclaimer}}</p>\r\n                                                                {{/if}}\r\n                                                            </div>\r\n                                                        </span>\r\n                                                    </div>\r\n                                                {{/if}}\r\n                                            {{/if}}\r\n\r\n                                        {{else}}\r\n                                            <span class="x-solar-none">\r\n                                        <span class="x-solar-text">{{this.text}}</span>\r\n                                    </span>\r\n                                        {{/if}}\r\n                                    {{else}}\r\n                                        <span class="x-solar-none"></span>\r\n                                    {{/if}}\r\n                                </div>\r\n                            </td>\r\n                        {{/each}}\r\n                    </tr>\r\n                {{/each}}\r\n            {{/if}}\r\n        {{/if}}\r\n        {{#if usePoint}}\r\n            {{#each days}}\r\n                <tr>\r\n                    {{#each this}}\r\n                        <td class="x-solar-item {{#if this}}valid-date{{/if}}">\r\n                            <div class="x-solar-cell{{#if this.soldOut}} rc-sold-out{{/if}}" {{#if this}}data-date="{{this.UTC}}"{{/if}}>\r\n                                {{#if this}}\r\n                                    {{#if this.live}}\r\n                                        <span class="x-solar-mask{{#if this.soldOut}} rc-sold-out{{/if}}{{#if this.select}} select{{/if}}">\r\n                                        <svg width="100%" height="100%" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 16">\r\n                                            <path d="M 0 0 V 0 16 H 15 L 20 8 L 15 0 Z" class="prev"/>\r\n                                            <path d="M 5 0 L 0 8 L 5 16 H 20 V 0 Z" class="next"/>\r\n                                        </svg>\r\n                                    </span>\r\n                                        <span class="x-solar-text">{{this.text}}</span>\r\n                                        {{#if this.soldOut}}\r\n                                            <span class="x-solar-price rc-sold-out">{{local \'booking.sold_out\'}}</span>\r\n                                        {{else}}\r\n                                            <span class="x-solar-price{{#if this.sellingFast}} rc-sf{{/if}}{{#if this.lowestRate}} rc-lr{{/if}}"><span class="rc-num">{{num-format this.point}}</span></span>\r\n                                        {{/if}}\r\n\r\n                                    {{else}}\r\n                                        <span class="x-solar-none">\r\n                                        <span class="x-solar-text">{{this.text}}</span>\r\n                                    </span>\r\n                                    {{/if}}\r\n                                {{else}}\r\n                                    <span class="x-solar-none"></span>\r\n                                {{/if}}\r\n                            </div>\r\n                        </td>\r\n                    {{/each}}\r\n                </tr>\r\n            {{/each}}\r\n        {{/if}}\r\n    </tbody>\r\n</table>'},{}],281:[function(e,i,a){var t=e("underscore"),r=window.local&&window.local.dates||{January:"January",February:"February",March:"March",April:"April",May:"May",June:"June",July:"July",August:"August",September:"September",October:"October",November:"November",December:"December",Sunday:"Sunday",Monday:"Monday",Tuesday:"Tuesday",Wednesday:"Wednesday",Thursday:"Thursday",Friday:"Friday",Saturday:"Saturday"},n=window.local&&window.local.dates_short||{January:"Jan",February:"Feb",March:"Mar",April:"Apr",May:"May",June:"Jun",July:"Jul",August:"Aug",September:"Sep",October:"Oct",November:"Nov",December:"Dec",Sunday:"Sun",Monday:"Mon",Tuesday:"Tue",Wednesday:"Wed",Thursday:"Thu",Friday:"Fri",Saturday:"Sat"};i.exports={weeks:[r.Sunday,r.Monday,r.Tuesday,r.Wednesday,r.Thursday,r.Friday,r.Saturday],weeks_short:[n.Sunday,n.Monday,n.Tuesday,n.Wednesday,n.Thursday,n.Friday,n.Saturday],months:[r.January,r.February,r.March,r.April,r.May,r.June,r.July,r.August,r.September,r.October,r.November,r.December],months_short:[n.January,n.February,n.March,n.April,n.May,n.June,n.July,n.August,n.September,n.October,n.November,n.December],getDays:function(e,i,a,r,n){for(var o=e.getFullYear(),s=e.getMonth(),l=new Date(o,s,1),c=new Date(o,s+1,0),d=l.getDay(),p=c.getDay(),m=new Date(o,s,0===d?1:1-d),x=new Date(o,s+1,6===p?0:6-p),f=this.getMaxMonth(r),u=[];x>=m;){var h,g=m.getDay(),v=m.getDate(),_=m.getMonth(),y=m.getFullYear();if(0===g?(h=[],u.push(h)):h=u[u.length-1],_===s){var b,w={};t.each(a,function(e){var i=e.checkinDate.split("-"),a=new Date(i[0],i[1]-1,i[2]);a.getFullYear()===y&&a.getMonth()===_&&a.getDate()===v&&(w.memberPrice=e.roomPrice.memberprice.showwithtax?e.roomPrice.memberprice.averageaftertaxprice:e.roomPrice.memberprice.averagebefortaxprice,w.memberChannel=e.roomPrice.memberprice.channel,w.price=e.roomPrice.guestprice.showwithtax?e.roomPrice.guestprice.averageaftertaxprice:e.roomPrice.guestprice.averagebefortaxprice,w.channel=e.roomPrice.guestprice.channel,w.point=e.points,w.currencyMark=e.currencyMark,w.sellingFast=e.isBestSell,w.lowestRate=e.isLowestDate,w.sellingFast&&w.lowestRate&&(w.sellingFast=!1),e.roomPrice.memberprice.currentrategainprice&&e.roomPrice.memberprice.rategainresult&&(w.memberPMG=e.roomPrice.memberprice.currentrategainprice,w.MPMGTitle=e.roomPrice.memberprice.rategainresult.title,w.memberRategainDisclaimer=e.roomPrice.memberprice.rategainresult.rategainDisclaimer,t.each(w.memberPMG,function(i){i.currencyMark=w.currencyMark,i.showwithtax=e.roomPrice.memberprice.showwithtax})),e.roomPrice.guestprice.currentrategainprice&&e.roomPrice.guestprice.rategainresult&&(w.PMG=e.roomPrice.guestprice.currentrategainprice,w.PMGTitle=e.roomPrice.guestprice.rategainresult.title,w.rategainDisclaimer=e.roomPrice.guestprice.rategainresult.rategainDisclaimer,t.each(w.PMG,function(i){i.currencyMark=w.currencyMark,i.showwithtax=e.roomPrice.guestprice.showwithtax})))}),b=!w.price,h.push({select:n?m.toUTCString()===n.toUTCString():!1,UTC:m.toUTCString(),live:m>=i&&f>m,text:v,memberPrice:w.memberPrice,memberPMG:w.memberPMG,price:w.price,PMG:w.PMG,PMGTitle:w.PMGTitle,MPMGTitle:w.MPMGTitle,point:w.point,currencyMark:w.currencyMark,sellingFast:w.sellingFast,lowestRate:w.lowestRate,soldOut:b})}else h.push(void 0);m.setDate(v+1)}return u},nowMonth:function(){var e=new Date;return new Date(e.getFullYear(),e.getMonth(),1)},changeMonth:function(e){var i=new Date;return new Date(i.getFullYear(),i.getMonth()+e,1)},getMaxMonth:function(e){var i=new Date;return new Date(i.getFullYear(),i.getMonth(),i.getDate()+e)},prevMonth:function(e){return new Date(e.getFullYear(),e.getMonth()-1,1)},nextMonth:function(e){return new Date(e.getFullYear(),e.getMonth()+1,1)},nowDate:function(){var e=new Date;return new Date(e.getFullYear(),e.getMonth(),e.getDate())},prevDate:function(e){return new Date(e.getFullYear(),e.getMonth(),e.getDate()-1)},nextDate:function(e){return new Date(e.getFullYear(),e.getMonth(),e.getDate()+1)}}},{underscore:42}],280:[function(e,i,a){function t(e){return r.uniq(e.sort(function(e,i){return parseFloat(e.sortorder)-parseFloat(i.sortorder)||parseFloat(e.memberrate)-parseFloat(i.memberrate)}),function(e){return e.ratecode})}var r=e("underscore"),n=e("backbone"),o=e("backbone.marionette"),s=e("./child/view"),l=e("./empty/view");i.exports=o.CollectionView.extend({childView:s,emptyView:l,className:"book2-content-section",childViewOptions:function(e,i){return{model:e,index:i,rootState:this.options.rootState}},initialize:function(){var e=this,i=e.options.rootState,a=i.getParam().code,o=i.getRates({hotelcode:a});o=t(o),e.collection=new n.Collection(o),e.collection.comparator=function(e){var a=e.get("ratecode");return a===i.getParam().defaultRate?-1:r.findIndex(o,{ratecode:a})},e.listenTo(i,"showSummaryView",e.__changeIndex),0==o.length&&(i.trigger("changeViewStyle",i.VIEW_STYLES.HOTEL_BY_ROOM),setTimeout(function(){jQuery(".book2-toolbar-section [data-item='rate']").prop("disabled",!0).css({cursor:"not-allowed"})},50))},onRender:function(){this.__defaultExpandChildView()},__changeIndex:function(){var e=this,i=e.collection,a=e.options.rootState,t=a.getParam().defaultRate,r=i.findWhere({ratecode:t});if(r)if(i.indexOf(r)>0)i.sort();else{var n=e.children.findByModel(r);n&&n.render()}},__defaultExpandChildView:function(){var e=this,i=e.collection,a=e.options.rootState,t=a.getParam().defaultRate,r=null;a.isFinal()&&i.length&&(t&&(r=i.findWhere({ratecode:t})),r||(r=i.models[0]),r&&a.trigger("loadRatesByCode",{ratecode:r.get("ratecode")}))}})},{"./child/view":278,"./empty/view":279,backbone:8,"backbone.marionette":6,underscore:42}],279:[function(e,i,a){i.exports=e("../../03-view-by-room/empty/view")},{"../../03-view-by-room/empty/view":267}],278:[function(e,i,a){var t=(e("underscore"),e("backbone")),r=e("backbone.marionette"),n=e("./01-rate/view"),o=e("./02-stay/view"),s=e("./03-room/view"),l=e("../../../../06-popping/view"),c=e("../../../../common/popup"),d=!1;i.exports=r.LayoutView.extend({template:Handlebars.compile(e("./template.hbs")),regions:{rate:"[data-region='rate']",stay:"[data-region='stay']",room:"[data-region='room']"},ui:{highlight:".x-highlight",differ:"[data-item='differ']",voucherBox:"[data-item='voucherBox']",voucherTip:"[data-item='voucherTip']",voucherTxt:"[data-item='voucherTxt']",voucherText:"[data-item='voucherText']",sales:"[data-item='sales']",close:"[data-item='close']"},events:{"click @ui.close":function(){this.options.rootState.SALES_SHOW=!0,this.ui.sales.hide()},"click @ui.voucherBox":function(){var e=this,i=e.model.toJSON(),a=e.options.rootState,t=a.getAllah({ratecode:i.ratecode});t&&(t.voucherusage?(a.trigger("turnUpgradeRate",{categoryid:t.categoryid,roomtypecode:t.roomtypecode,ratecode:t.ratecode,roomid:t.roomid,voucherusage:!1}),a.trigger("expandChildView",t)):(a.setIGPointsWhenRup(a.getIGPoints()),a.trigger("loadUpgradeRate",t)))},"mouseenter @ui.voucherTip":function(e){e.stopPropagation(),c.addPopupTip(this,l.VOUCHER,this.serializeData(),jQuery(e.currentTarget),!1,!1,!0)},"mouseleave @ui.voucherTip":function(e){e.stopPropagation(),c.delPopupTip()}},serializeData:function(){var e=this,i=e.model.toJSON(),a=e.options.rootState,t=a.getAllah({ratecode:i.ratecode}),r=a.getHotel(),n=null,o=[];t&&(o=a.getRooms({id:t.categoryid})),o.length&&(n=o[0]);var s,l,c=n&&n.differentiator,d=t&&t.roomupgradeavailabled;return t&&t.voucherusage&&(l=a.getUpgradeRateByRate({categoryid:t.categoryid,roomtypecode:t.roomtypecode,ratecode:t.ratecode,roomid:t.roomid}),s=l&&l.roomtype),{bookingflowgreenbarcontent:r&&r.bookingflowgreenbarcontent,isUseMoney:a.isTrade(a.VIEW_TRADES.USE_MONEY),isUsePoint:a.isTrade(a.VIEW_TRADES.USE_POINT),id:i.ratecode,firstLoad:a.isFirstLoad(),expandAll:c||d,differentiator:c,vouchervisible:d,voucherusage:t&&t.voucherusage,originRoomName:n&&n.type,targetRoomName:s&&s.type,upgradeObject:l}},initialize:function(){var e=this.options.rootState;this.__renderDeferred=jQuery.Deferred(),this.listenTo(e,"expandSelfView",this.expandChildView),this.listenTo(e,"expandPopupView",this.expandPopupView),this.listenTo(e,"hiddenPopupView",this.hiddenPopupView),this.listenTo(e,"turnUpgradeRate",this.turnUpgradeRate),this.listenTo(e,"showUpgradeTip",this.showUpgradeTip)},onRender:function(){this.__showRateView(!1),this.__renderDeferred.resolve()},onDestroy:function(){this.__destroy=!0},expandChildView:function(e){return this.__renderDeferred.then(jQuery.proxy(this.__expandChildView,this,e))},expandPopupView:function(e){return this.__renderDeferred.then(jQuery.proxy(this.__expandPopupView,this,e))},hiddenPopupView:function(e){return this.__renderDeferred.then(jQuery.proxy(this.__hiddenPopupView,this,e))},turnUpgradeRate:function(e){return this.__renderDeferred.then(jQuery.proxy(this.__turnUpgradeRate,this,e))},showUpgradeTip:function(e){return this.__renderDeferred.then(jQuery.proxy(this.__showUpgradeTip,this,e))},__expandChildView:function(e){this.model.get("ratecode")===e.ratecode?(this.__holdHighlight(),this.__hideSalesItem(),this.__showStayView(!0),this.__showRateView(!0)):(this.__freeHighlight(),this.__hideRoomView(),this.__hideStayView(),this.__showRateView(!1))},__expandPopupView:function(e){this.model.get("ratecode")===e.ratecode?(this.__holdHighlight(),this.__showStayView(!1),this.__showRateView(!0)):(this.__freeHighlight(),this.__hideRoomView(),this.__hideStayView(),this.__showRateView(!1))},__hiddenPopupView:function(e){this.model.get("ratecode")===e.ratecode?(this.__holdHighlight(),this.__hideRoomView(),this.__showStayView(!0),this.__showRateView(!0)):(this.__freeHighlight(),this.__hideRoomView(),this.__hideStayView(),this.__showRateView(!1))},__showRateView:function(e){var i=this;i.getRegion("rate").show(new n({model:i.model,rootState:i.options.rootState,openPopupView:i.getRegion("room").hasView(),expandAll:e}))},__showStayView:function(e){var i=this,a=i.model.get("ratecode"),r=i.options.rootState,n=r.getAllah({ratecode:a}),s={};n&&n.voucherusage&&(s=r.getUpgradeRateByRate({categoryid:n.categoryid,roomtypecode:n.roomtypecode,ratecode:n.ratecode,roomid:n.roomid}),s&&s.roomrate&&(n=s.roomrate||n)),this.getRegion("stay").show(new o({model:n?new t.Model(n):null,rootState:r,expandAll:e&&!this.getRegion("room").hasView()
}))},__showRoomView:function(){this.getRegion("room").show(new s({model:this.model,rootState:this.options.rootState}))},__hideStayView:function(){this.getRegion("stay").empty()},__hideRoomView:function(){this.getRegion("room").empty()},__holdHighlight:function(){this.ui.differ.show(),this.ui.highlight.addClass("holds")},__freeHighlight:function(){this.ui.differ.hide(),this.ui.highlight.removeClass("holds")},__hideSalesItem:function(){var e=this,i=e.options.rootState;i.isFirstLoad()&&!i.SALES_SHOW?e.ui.sales.css("display","table"):e.ui.sales.css("display","none")},__turnUpgradeRate:function(e){var i=this,a=i.model.toJSON(),t=i.options.rootState,r=t.getAllah({ratecode:a.ratecode});r&&r.categoryid===e.categoryid&&r.roomtypecode===e.roomtypecode&&r.ratecode===e.ratecode&&r.roomid===e.roomid&&(t.changeRateValue(e),e.voucherusage?(i.ui.voucherBox.addClass("checked"),i.ui.voucherText.text(i18n.t("rup.room_upgraded"))):(i.ui.voucherBox.removeClass("checked"),i.ui.voucherText.text(i18n.t("rup.use_points_to_upgrade"))),i.__updateVoucherTxt())},__showUpgradeTip:function(){var e=this;if(e.serializeData().vouchervisible){if(d)return;d=!0,e.ui.voucherTip.length&&e.ui.voucherTip[0].clientHeight&&e.ui.voucherTip.finish().trigger("mouseenter").delay(5e3).queue(function(){jQuery(this).trigger("mouseleave").dequeue()})}},__updateVoucherTxt:function(){}})},{"../../../../06-popping/view":343,"../../../../common/popup":348,"./01-rate/view":270,"./02-stay/view":271,"./03-room/view":276,"./template.hbs":277,backbone:8,"backbone.marionette":6,underscore:42}],277:[function(e,i,a){i.exports='<div class="x-mt-13 x-ff-00 x-pl-20 x-pr-20 x-pt-13 x-pb-13 x-flex x-bc-green" style="display: none" data-item="sales">\r\n    <div class="x-cell x-al-l">\r\n        <span class="x-fs-14 x-fc-white x-di x-di-v-m">{{#if bookingflowgreenbarcontent}}{{bookingflowgreenbarcontent}}{{else}}{{local "booking.epic_sales"}}{{/if}}</span>\r\n    </div>\r\n    <div class="x-cell x-al-r">\r\n        <span class="x-fs-24 x-fc-white x-di x-di-v-m x-pointer icon-icon_B017" data-item="close"></span>\r\n    </div>\r\n</div>\r\n\r\n<div class="x-mt-13" data-id="{{id}}"></div>\r\n\r\n{{#if expandAll}}\r\n    <div class="x-pl-20 x-pr-20 x-pt-17 x-pb-17 x-bc-azure x-hide" data-item="differ">\r\n        <div class="x-flex x-fs-00">\r\n            <div class="x-cell x-al-l x-di-v-m">\r\n                {{#if vouchervisible}}\r\n                    <!--<span class="x-fs-20 x-di x-di-v-m x-fc-white icon-icon_J015"></span>-->\r\n                    <!--<span data-item="voucherTxt" class="x-fs-14 x-di x-di-v-m x-fc-white x-ml-06 x-ff-wb">-->\r\n                        <!--{{#if voucherusage}}-->\r\n                            <!--{{local "booking.you_have_been_upgraded" targetRoomName originRoomName }}-->\r\n                        <!--{{else}}-->\r\n                            <!--{{local "booking.use_your_room_upgrade_voucher"}}-->\r\n                        <!--{{/if}}-->\r\n                    <!--</span>-->\r\n\r\n                    <span class="x-fs-14 x-di x-di-v-m x-fc-white x-ff-wb">{{differentiator}}</span>\r\n                {{else}}\r\n                    <span class="x-fs-14 x-di x-di-v-m x-fc-white x-ff-wb">{{differentiator}}</span>\r\n                {{/if}}\r\n            </div>\r\n            <div class="x-cell x-al-r x-di-v-m">\r\n                {{#if vouchervisible}}\r\n                    {{#if voucherusage}}\r\n                        <span class="x-fs-16 x-di x-di-v-m x-fc-white x-check x-check-sm x-pointer checked" data-item="voucherBox"></span>\r\n                        <span class="x-fs-14 x-di x-di-v-m x-fc-white x-ml-06 x-upper x-ff-m7 x-none x-mt-02" style="letter-spacing: 0.65px;" data-item="voucherText">{{local \'rup.room_upgraded\'}}</span>\r\n                    {{else}}\r\n                        <span class="x-fs-16 x-di x-di-v-m x-fc-white x-check x-check-sm x-pointer" data-item="voucherBox"></span>\r\n                        <span class="x-fs-14 x-di x-di-v-m x-fc-white x-ml-06 x-upper x-ff-m7 x-none x-mt-02" style="letter-spacing: 0.65px;" data-item="voucherText">{{local \'rup.use_points_to_upgrade\'}}</span>\r\n                    {{/if}}\r\n                    <!--<span class="x-fs-14 x-di x-di-v-m x-fc-white x-ml-06 x-upper x-ff-mh x-none">{{local "booking.use_upgrade_voucher"}}</span>-->\r\n                    <span class="x-fs-16 x-di x-di-v-m x-fc-white x-ml-06 x-default icon-icon_B008" data-item="voucherTip"></span>\r\n                {{/if}}\r\n            </div>\r\n        </div>\r\n    </div>\r\n{{/if}}\r\n\r\n<div class="x-bc-white x-fs-00">\r\n    <div class="x-highlight">\r\n        <div data-region="rate"></div>\r\n        <div data-region="stay"></div>\r\n    </div>\r\n    <div data-region="room"></div>\r\n</div>'},{}],276:[function(e,i,a){function t(e,i){return r.map(r.uniq(r.map(e,function(e){return e.categoryid})),function(e){return r.assign({categoryid:e},i)})}var r=e("underscore"),n=e("backbone"),o=e("backbone.marionette"),s=e("./child/view"),l=e("./empty/view");i.exports=o.CompositeView.extend({childView:s,emptyView:l,template:Handlebars.compile(e("./template.hbs")),childViewContainer:".book2-room-container",events:{"click [data-item='close']":function(){var e=this,i=e.options.rootState;i.trigger("hiddenPopupView",{ratecode:e.model.get("ratecode")})}},childViewOptions:function(e){return{model:e,rootState:this.options.rootState}},initialize:function(){var e=this,i=e.model.toJSON(),a=e.options.rootState,r=a.getAllah({ratecode:i.ratecode}),o=a.getRates({ratecode:i.ratecode});e.collection=new n.Collection(t(o,{ratecode:i.ratecode,bedtype:r?r.bedtype:i.bedtype}))}})},{"./child/view":273,"./empty/view":274,"./template.hbs":275,backbone:8,"backbone.marionette":6,underscore:42}],275:[function(e,i,a){i.exports='<div class="book2-room-container"></div>\r\n{{#unless expandAll}}\r\n    <div class="x-al-c x-lh-50 x-pointer x-top-line" data-item="close">\r\n        <span class="x-fs-16 x-ff-m7 x-upper x-delta">{{local "general.close"}}</span>\r\n    </div>\r\n{{/unless}}'},{}],274:[function(e,i,a){i.exports=e("../../../../03-view-by-room/child/03-rate/empty/view")},{"../../../../03-view-by-room/child/03-rate/empty/view":261}],271:[function(e,i,a){i.exports=e("../../../03-view-by-room/child/02-stay/view")},{"../../../03-view-by-room/child/02-stay/view":257}],270:[function(e,i,a){function t(e){var i=e.memberrate===e.avgdisplayoriginalprice;return!i}function r(e){var i=(e.avgdisplaypoints||e.points)===e.avgdisplayoriginalpoints;return!i}function n(e){return e.avgdisplayoriginalprice}function o(e){return e.avgdisplayoriginalpoints}function s(e){return e.memberrate}function l(e){return e.avgdisplaypoints||e.points}function c(e){return e.memberrate}function d(e){return e.avgdisplaypoints||e.points}function p(e,i,a,t){var r=x.has(i,"memberrate")&&x.has(i,"avgdisplaypoints");return e=x.uniq(e,function(e){return e.bedtype}),e=x.map(e,function(e){var n=e.bedtype,o=e.bedtypeicon,s=parseFloat(e.memberrate),l=parseFloat(e.avgdisplaypoints),c=e.bedtype===i.bedtype;if(r&&!c)if(t){var d=l-parseFloat(i.avgdisplaypoints);d&&(n=Handlebars.compile("{{bedtype}} ({{operator}}{{num-format difference}})")({bedtype:n,currency:a,operator:d>0?"+":"-",difference:Math.abs(d)}))}else{var d=s-parseFloat(i.memberrate);d&&(n=Handlebars.compile("{{bedtype}} ({{operator}}{{currency}}{{price-format difference}})")({bedtype:n,currency:a,operator:d>0?"+":"-",difference:Math.abs(d)}))}return{bedtext:n,bedtype:e.bedtype,bedtypeicon:o,highlight:c}})}function m(e){return x.filter(e||[],function(e){return!!e.fonticon}).slice(0,4)}var x=e("underscore"),f=e("backbone.marionette"),u={},h=!1,g=e("../../../../../06-popping/view"),v=e("../../../../../common/popup"),_=e("../../../../../common/short");i.exports=f.ItemView.extend({template:Handlebars.compile(e("./template.hbs")),ui:{voucher:"[data-item='voucher']",voucherBox:"[data-item='voucher'].x-check",voucherTip:"[data-item='voucher-popup']",maxocc:"[data-item='maxocc']",member:"[data-item='member']","short":"[data-item='short']",short_p:"[data-item='short-p']",popup:"[data-item='popup-p']",displayChild:"[data-item='displayChild']",loyaltyroomupgrade_text:"[data-item='loyaltyroomupgrade_text']",loyaltyroomupgrade_icon:"[data-item='loyaltyroomupgrade_icon']"},events:{"mouseenter @ui.maxocc":function(e){e.stopPropagation(),v.addPopupTip(this,g.OCCUPANCY,this.getOccupancy(),jQuery(e.currentTarget))},"mouseleave @ui.maxocc":function(e){e.stopPropagation(),v.delPopupTip()},"mouseenter @ui.member":function(e){e.stopPropagation();this.serializeData();v.addPopupTip(this,g.MEMBER,this.getMember(),jQuery(e.currentTarget))},"mouseleave @ui.member":function(e){e.stopPropagation(),v.delPopupTip()},"mouseenter @ui.short":function(e){e.stopPropagation(),v.addPopupTip(this,g.PENALTY,this.getTipShort(),jQuery(this.ui["short"]))},"mouseleave @ui.short":function(e){e.stopPropagation(),v.delPopupTip()},"mouseleave @ui.short_p":function(e){e.stopPropagation(),v.delPopupTip()},"mouseenter @ui.short_p":function(e){e.stopPropagation(),v.addPopupTip(this,g.PENALTY,this.getTipShort(),jQuery(this.ui["short"]))},"click [data-item='look']":function(e){e.stopPropagation();var i=this,a=i.model.toJSON(),t=i.options.rootState;t.isFinal()&&t.trigger("planGalleryData",{ratecode:a.ratecode,categoryid:a.categoryid})},"click [data-item='beds']":function(e){var i=this,a=null,t=i.model.get("ratecode"),r=i.options.rootState,n=r.getAllah({ratecode:t}),o=jQuery(e.currentTarget).attr("data-bed-type"),s=r.getRates({ratecode:t,bedtype:o});s.length&&(a=n?x.findWhere(s,{categoryid:n.categoryid})||s[0]:s[0],r.setAllah({roomtypecode:a.roomtypecode,ratecode:a.ratecode,roomid:a.roomid}),r.storeUpdatedTip({type:u,code:t,name:o}),r.trigger("loadStaysByRate",a))},"click [data-item='hand']":function(){var e=this,i=e.options.rootState;i.isFinal()&&i.trigger("loadRatesByCode",{ratecode:e.model.get("ratecode")})},"click [data-item='room']":function(){var e=this,i=e.options.rootState;i.isFinal()&&(e.options.openPopupView?i.trigger("hiddenPopupView",{ratecode:e.model.get("ratecode")}):i.trigger("expandPopupView",{ratecode:e.model.get("ratecode")}))},"click [data-item='book']":function(){var e=this,i=e.model.toJSON(),a=e.options.rootState,t=a.getAllah({ratecode:i.ratecode});t&&a.trigger("addShoppingCart",t)},"click [data-item='sign']":function(){this.options.rootState.trigger("registerPayment")},"click @ui.voucher":function(){var e=this,i=e.model.toJSON(),a=e.options.rootState,t=a.getAllah({ratecode:i.ratecode});if(t){var r=!t.voucherusage;a.changeRateValue({categoryid:t.categoryid,roomtypecode:t.roomtypecode,ratecode:t.ratecode,roomid:t.roomid,voucherusage:r},{}),r?(e.ui.voucherBox.addClass("checked"),e.ui.voucherTip.addClass("holds").delay(5e3).queue(function(){jQuery(this).removeClass("holds").dequeue()})):e.ui.voucherBox.removeClass("checked")}},"click @ui.displayChild":function(e){e.stopPropagation();var i=this,a=i.model.toJSON(),t=i.options.rootState,r=t.getAllah({ratecode:a.ratecode});r&&(t.trigger("showLampBoxRoom",r),t.trigger("lightBoxAnimate",i.ui.displayChild.offset()))},"click @ui.loyaltyroomupgrade_text":function(e){e.stopPropagation();var i=this,a=i.model.toJSON(),t=i.options.rootState,r=t.getAllah({ratecode:a.ratecode});if(r){var n=!r.loyaltyroomupgradeusage,o=r.specialrequests||"",s=i18n.t("booking.loyalty_room_upgrade_special_requests");n?o&&0===o.indexOf(s)||(o=s+" "+o):o&&0===o.indexOf(s)&&(o=o.slice(s.length).replace(/^\s/,""));var l={categoryid:r.categoryid,roomtypecode:r.roomtypecode,ratecode:r.ratecode,roomid:r.roomid,loyaltyroomupgradeusage:n,specialrequests:o};t.changeRateValue(l),n?(i.ui.loyaltyroomupgrade_text.eq(0).addClass("checked-azure"),i.ui.loyaltyroomupgrade_icon.finish().trigger("mouseenter").delay(3e3).queue(function(){jQuery(this).trigger("mouseleave").dequeue()})):i.ui.loyaltyroomupgrade_text.eq(0).removeClass("checked-azure"),t.trigger("loyaltyRoomUpgrade",l)}},"mouseenter @ui.loyaltyroomupgrade_icon":function(e){e.stopPropagation(),v.addPopupTip(this,g.LOYALTYROOMUPGRADE,{},this.ui.loyaltyroomupgrade_icon)},"mouseleave @ui.loyaltyroomupgrade_icon":function(e){e.stopPropagation(),v.delPopupTip()}},getOccupancy:function(){var e=this,i=e.model.toJSON(),a=e.options.rootState,t=a.getAllah({ratecode:i.ratecode});t=t||i;var r={},n=a.getMaxChildAge();return r.maxocc=n&&(t.maxocc||0),r.adultocc=n&&(t.adultocc||0),r.childocc=n&&(t.childocc||0),r.adults=x.range(t.adultocc||0),r.children=x.range(t.childocc||0),r.maxchildage=n,r},getMember:function(){var e=this,i=e.model.toJSON(),a=e.options.rootState,t=a.getAllah({ratecode:i.ratecode});return{isLogin:a.isLogin(),isUseMoney:a.isTrade(a.VIEW_TRADES.USE_MONEY),isUsePoint:a.isTrade(a.VIEW_TRADES.USE_POINT),currency:a.getCurrency(),complete:a.getComplete(),loyalty:a.getLoyalty(),pointssaved:t?parseFloat(t.pointssaved):parseFloat(i.pointssaved),ratesaved:t?parseFloat(t.ratesaved):parseFloat(i.ratesaved),vouchervisible:t&&t.vouchervisible}},getTipShort:function(){var e=this,i=e.model.toJSON();return i},initialize:function(){var e=this.options.rootState;_.autoCreate(this),this.__renderDeferred=jQuery.Deferred(),this.listenTo(e,"redrawViewChild",this.redrawViewChild),this.listenTo(e,"changePartCount",this.changePartCount),this.listenTo(e,"turnUpgradeRate",this.changePartCount),this.__openPopupView=!1},serializeData:function(){var e=this,i=e.model.toJSON(),a=e.options.rootState,f=a.getAllah({ratecode:i.ratecode}),u=a.getHotel(),h=null,g=[];f&&(g=a.getRooms({id:f.categoryid})),g.length&&(h=g[0]);var v,_=!1,y=f&&parseFloat(f.pointssaved),b=f&&parseFloat(f.ratesaved);f&&f.voucherusage&&(v=a.getUpgradeRateByRate({categoryid:f.categoryid,roomtypecode:f.roomtypecode,ratecode:f.ratecode,roomid:f.roomid}),v&&(f=v.roomrate||f,h=v.roomtype||h,y=v.roomrate.pointssaved,b=v.upgradeddifference.savedprice.avgtotal)),f&&!f.roomupgradeavailabled&&u.loyaltyroomupgradeenable&&(_=!0);var w=a.getMaxChildAge(),k=w&&(f&&f.maxocc||"0"),S=w&&f&&f.adultocc,V=w&&f&&f.childocc,P=a.getParam().rooms,R=g[0].NumberOfUnits,C=parseInt(P)>parseInt(R),T=function(){var e="",a=null!=i.rategainresult,t=u.activatebeatthempmg,r=null!=i.rategainresult?i.rategainresult.status:!1;return a?("2"===r&&(e="PMG1_CRS lower"),"3"===r&&(e=t?"PMG3a_CRS higher and beat them":"PMG3b_CRS higher and match"),"4"===r&&(e=t?"PMG2a_CRS same and beat them":"PMG2b_CRS same and match"),"5"===r&&(e="PMG4_CRS much higher")):e="PMG5_Null",e};return{isLogin:a.isLogin(),isFinal:a.isFinal(),isManyDays:a.isManyDays(),isUseMoney:a.isTrade(a.VIEW_TRADES.USE_MONEY),isUsePoint:a.isTrade(a.VIEW_TRADES.USE_POINT),expandAll:f&&e.options.expandAll,openPopupView:e.options.openPopupView,persuasive:a.isBestDealRate({memberrate:i.memberrate}),maxchildage:w,currency:a.getCurrency(),restricted:f&&f.roomstay&&f.roomstay.RatePlan&&f.roomstay.RatePlan.restricted,complete:!(f&&f.roomstay&&f.roomstay.RatePlan&&f.roomstay.RatePlan.restricted)&&a.getComplete(),data:f||i,type:h&&h.type,badgeicon:h&&h.badgeicon,enableslashprice:a.getHotel().enableslashprice&&a.isLogin(),badgetitle:h&&h.badgetitle,bedtypes:p(f&&!f.voucherusage?a.getRates(f?{categoryid:f.categoryid,ratecode:f.ratecode}:{ratecode:i.ratecode}):h.availability?h.bedtypes:[],f||{},a.getCurrency(),a.isTrade(a.VIEW_TRADES.USE_POINT)),amenities:m(h&&h.amenities),roomsize:h&&h.features.roomsize,roomtagline:h&&h.roomtagline,image:f&&(f.roomtypeimg||"").replace(/^#+/,"")||h&&(h.imageurl3||h.imageurl)||(i.roomtypeimg||"").replace(/^#+/,""),rate:s(f||i),points:l(f||i),memberrate:c(f||i),memberpoints:d(f||i),originrate:n(f||i),originpoints:o(f||i),priceCompared:t(f||h.price),PointsCompared:r(f||h.price),showDisCount:c(f||h.price)!=n(f||h.price),pointssaved:y,ratesaved:b,pointssavedformat:Handlebars.compile("{{num-format this}}")(f&&parseFloat(f.pointssaved)),ratesavedformat:Handlebars.compile("{{price-format this}}")(f&&parseFloat(f.ratesaved)),availability:!0,vouchervisible:f&&f.roomupgradeavailabled,voucherusage:f&&f.voucherusage,upgradePoints:v&&v.upgradeddifference.avgtopprice.avgtoppoints,loyaltyroomupgradeenable:!1,loyaltyroomupgradeusage:f&&f.loyaltyroomupgradeusage,bestdeal:f&&f.badgetitle,maxocc:k,adultocc:S,childocc:V,hasocc:!!S||!!V,adults:x.range(S||0),children:x.range(V||0),pointsText:i18n.t("checkout.points"),upgradeObject:v,pmg:T(),roomsOfUnits:C}},onRender:function(){var e=this;if(e.__renderDeferred.resolve(),e.options.rootState.glintUpdatedTip({code:e.model.get("ratecode"),type:u},this),e.options.expandAll){if(h)return;e.ui.popup.eq(0).addClass("holds"),e.__timeout=setTimeout(function(){h=!0,e.__destroy||e.ui.popup.removeClass("holds")},3e3)}},onDestroy:function(){this.__destroy=!0},redrawViewChild:function(e){return this.__renderDeferred.then(jQuery.proxy(this.__redrawViewChild,this,e))},changePartCount:function(e){return this.__renderDeferred.then(jQuery.proxy(this.__changePartCount,this,e))},__redrawViewChild:function(){this.render()},__changePartCount:function(e){this.model.get("ratecode")===e.ratecode&&this.render()}})},{"../../../../../06-popping/view":343,"../../../../../common/popup":348,"../../../../../common/short":350,"./template.hbs":269,"backbone.marionette":6,underscore:42}],269:[function(e,i,a){i.exports='{{#if expandAll}}\r\n    <div class="book2-child-block x-highlight-tlr">\r\n        <!--<div  class="book2-child-image x-fs-00 x-img x-img-top x-highlight-tl" style="background-image: url(\'{{data.image}}\')"></div>-->\r\n        <div class="book2-child-theme theme-add x-fs-00 x-nowrap">\r\n            <div class="panel-3 x-di x-di-v-t x-normal">\r\n                <div>\r\n                    <h2 class="x-fs-24 x-di x-di-v-m x-lh-12 x-ff-wb">{{data.ratename}}</h2>\r\n                    {{#if bestdeal}}\r\n                        <span class="x-ff-mh x-fs-12 x-di x-di-v-m x-ml-08 x-pl-08 x-pr-08 x-lh-24 x-fc-white x-bc-peach x-upper x-nowrap">{{ bestdeal }}</span>\r\n                    {{/if}}\r\n                </div>\r\n                <div class="x-mt-08">\r\n                    {{#if data.roomstay.RatePlan.paymentType}}\r\n                        <span class="x-fs-16 x-ff-m7 x-di x-di-v-m x-upper" style="color: #202020; letter-spacing: 1px">{{local "booking.pay_now_and_save"}}</span>\r\n                    {{else}}\r\n                        <span class="x-fs-16 x-ff-m7 x-di x-di-v-m x-upper" style="color: #202020; letter-spacing: 1px">{{local "booking.book_now_and_pay_later"}}</span>\r\n                    {{/if}}\r\n                    <!--<span class="x-di x-di-v-m x-fs-16 x-ml-06 x-pointer icon-icon_B008" data-item="short"></span>-->\r\n                </div>\r\n                <!--<div class="x-mt-08">-->\r\n                    <!--<p class="x-fs-18 x-lh-12 x-ff-sm x-lh-24">-->\r\n                        <!--{{data.desc}}-->\r\n                    <!--</p>-->\r\n                <!--</div>-->\r\n                <div class="x-mt-16">\r\n                    <div class="x-fs-18 x-ff-sm x-lh-24">{{data.desc}}</div>\r\n                    <div data-line="5" class="x-mt-08 x-fs-16 x-ff-sm x-lh-22 book2-information x-short">{{{data.tipshort}}}</div>\r\n                </div>\r\n                <div class="x-mt-13">\r\n                    <span class="x-fs-14 x-di x-di-v-m x-ff-mm x-fc-azure x-default x-under" data-item="short-p">{{local "booking.view_guarantee_and_cancellation_policy"}}</span>\r\n                    <span class="x-fs-16 x-di x-di-v-m x-ml-06 x-fc-azure x-default icon-icon_B008" data-item="short"></span>\r\n                </div>\r\n            </div>\r\n            <div class="panel-4 x-di x-di-v-t x-normal">\r\n                {{#if isUseMoney}}\r\n                    {{#if ratesaved}}\r\n                        {{#if isLogin}}\r\n                            <span class="x-fs-16 x-di x-di-v-m x-ff-m7 x-fc-azure x-upper">{{local "booking.you_ve_saved"}} {{currency}} {{price-format ratesaved}}</span>\r\n                            {{#if showDisCount}}\r\n                                <span class="x-fs-16 x-di x-di-v-m x-ml-06 x-fc-azure x-default icon-icon_B008" data-item="member"></span>\r\n                            {{/if}}\r\n                        {{else}}\r\n                            {{#if complete}}\r\n                                <span class="x-fs-16 x-di x-di-v-m x-ff-m7 x-upper x-through">{{local "booking.usual_price"}}: {{currency}} {{price-format rate}}</span>\r\n                            {{else}}\r\n                                <!--<span class="x-fs-16 x-di x-di-v-m x-ff-m7 x-upper">{{local "Property.members_pay"}}: {{currency}} {{price-format memberrate}}</span>-->\r\n                                <span class="x-fs-16 x-di x-di-v-m x-ff-m7 x-upper">{{local "booking.members_save"}}: {{currency}} {{price-format ratesaved}}</span>\r\n                            {{/if}}\r\n                            <!--<span class="x-fs-16 x-di x-di-v-m x-ml-06 x-default icon-icon_B008" data-item="member"></span>-->\r\n                            <div class="x-mt-04">\r\n                                    <span style="display: inline-block; max-width: 250px; line-height: 14px">\r\n                                        {{#if complete}}\r\n                                            <span class="x-fs-14 x-fc-white x-bc-azure x-di-v-m x-mr-06 icon-icon_I009"></span>\r\n                                            <span class="x-fs-12 x-ff-mm x-fw-none x-fc-azure x-di-v-m x-under">{{local "booking.complete_then_sign"}}</span>\r\n                                        {{else}}\r\n                                            <span class="x-fs-12 x-ff-mm x-fw-none x-pointer x-fc-azure x-under" data-item="sign">{{local "booking.sign_up_to_pay" }}</span>\r\n                                        {{/if}}\r\n                                    </span>\r\n                            </div>\r\n                        {{/if}}\r\n                        <div class="x-mt-08"></div>\r\n                    {{else}}\r\n                        {{#if restricted}}\r\n                            <div class="x-fs-14 x-ff-sm x-italic x-fc-gray">{{local "booking.loyalty_discount_not_applicable"}}</div>\r\n                            <div class="x-mt-08"></div>\r\n                        {{/if}}\r\n                    {{/if}}\r\n                    {{#if rate}}\r\n                        {{#if isLogin}}\r\n                            <div class="x-fs-24 x-ff-wb x-upper">{{currency}} {{price-format memberrate}}{{#if upgradePoints}}<span class="x-fs-24 x-ff-wb x-fc-peach x-ml-04 x-mr-04">+</span><span class="x-fs-24 x-ff-wb x-upper x-fc-peach">{{num-format upgradePoints}} PTS</span>{{/if}}</div>\r\n                        {{else}}\r\n                            {{#if complete}}\r\n                                <div class="x-fs-24 x-ff-wb x-upper">{{currency}} {{price-format memberrate}}</div>\r\n                            {{else}}\r\n                                <div class="x-fs-24 x-ff-wb x-upper">{{currency}} {{price-format rate}}</div>\r\n                            {{/if}}\r\n                        {{/if}}\r\n                        {{#if isManyDays}}\r\n                            <div class="x-fs-16 x-ff-m7 x-upper x-mt-08">{{local "Property.avg_night"}}</div>\r\n                        {{else}}\r\n                            <div class="x-fs-16 x-ff-m7 x-upper x-mt-08">{{local "general.avg_night"}}</div>\r\n                        {{/if}}\r\n                        {{#if enableslashprice}}\r\n                            {{#if priceCompared}}\r\n                                <span class="x-fs-24 x-upper x-di x-di-v-m x-mt-08" style="text-decoration: line-through;">{{currency}} {{price-format originrate}}</span>\r\n                            {{/if}}\r\n                        {{/if}}\r\n                    {{/if}}\r\n                {{/if}}\r\n                {{#if isUsePoint}}\r\n                    {{#if pointssaved}}\r\n                        {{#if isLogin}}\r\n                            <span class="x-fs-16 x-di x-di-v-m x-ff-m7 x-fc-azure x-upper">{{local "booking.you_ve_saved"}} {{num-format pointssaved}} {{local \'checkout.points\'}}</span>\r\n                            {{#if showDisCount}}\r\n                                <span class="x-fs-16 x-di x-di-v-m x-ml-06 x-fc-azure x-default icon-icon_B008" data-item="member"></span>\r\n                            {{/if}}\r\n                        {{else}}\r\n                            {{#if complete}}\r\n                                <span class="x-fs-16 x-di x-di-v-m x-ff-m7 x-upper x-through">{{local "booking.usual_price"}}: {{currency}} {{price-format points}} {{local \'checkout.points\'}}</span>\r\n                            {{else}}\r\n                                <!--<span class="x-fs-16 x-di x-di-v-m x-ff-m7 x-upper">{{local "Property.members_pay"}}: {{currency}} {{price-format memberpoints}} {{local \'checkout.points\'}}</span>-->\r\n                                <span class="x-fs-16 x-di x-di-v-m x-ff-m7 x-upper">{{local "booking.members_save"}}: {{num-format pointssaved}} {{local "checkout.points"}}</span>\r\n                            {{/if}}\r\n                            <!--<span class="x-fs-16 x-di x-di-v-m x-ml-06 x-default icon-icon_B008" data-item="member"></span>-->\r\n                            <div class="x-mt-04">\r\n                                    <span style="display: inline-block; max-width: 250px; line-height: 14px">\r\n                                        {{#if complete}}\r\n                                            <span class="x-fs-14 x-fc-white x-bc-azure x-di-v-m x-mr-06 icon-icon_I009"></span>\r\n                                            <span class="x-fs-12 x-ff-mm x-fw-none x-fc-azure x-di-v-m x-under">{{local "booking.complete_then_sign"}}</span>\r\n                                        {{else}}\r\n                                            <span class="x-fs-12 x-ff-mm x-fw-none x-pointer x-fc-azure x-under" data-item="sign">{{local "booking.sign_up_to_pay" }}</span>\r\n                                        {{/if}}\r\n                                    </span>\r\n                            </div>\r\n                        {{/if}}\r\n                        <div class="x-mt-08"></div>\r\n                    {{else}}\r\n                        {{#if restricted}}\r\n                            <div class="x-fs-14 x-ff-sm x-italic x-fc-gray">{{local "booking.loyalty_discount_not_applicable"}}</div>\r\n                            <div class="x-mt-08"></div>\r\n                        {{/if}}\r\n                    {{/if}}\r\n                    {{#if points}}\r\n                        {{#if isLogin}}\r\n                            {{#if upgradePoints}}\r\n                                <div class="x-fs-24 x-ff-wb x-upper">{{num-format memberpoints}}<span class="x-fs-24 x-ff-wb x-fc-peach x-ml-04 x-mr-04">+</span><span class="x-fs-24 x-ff-wb x-upper x-fc-peach">{{num-format upgradePoints}} PTS</span></div>\r\n                            {{else}}\r\n                                <div class="x-fs-24 x-ff-wb x-upper">{{num-format memberpoints}} {{local \'account.points\'}}</div>\r\n                            {{/if}}\r\n                        {{else}}\r\n                            {{#if complete}}\r\n                                <div class="x-fs-24 x-ff-wb x-upper">{{num-format memberpoints}} {{local \'account.points\'}}</div>\r\n                            {{else}}\r\n                                <div class="x-fs-24 x-ff-wb x-upper">{{num-format points}} {{local \'account.points\'}}</div>\r\n                            {{/if}}\r\n                        {{/if}}\r\n                        {{#if isManyDays}}\r\n                            <div class="x-fs-16 x-ff-m7 x-upper x-mt-08">{{local "Property.avg_night"}}</div>\r\n                        {{else}}\r\n                            <div class="x-fs-16 x-ff-m7 x-upper x-mt-08">{{local "general.avg_night"}}</div>\r\n                        {{/if}}\r\n                        {{#if enableslashprice}}\r\n                            {{#if PointsCompared}}\r\n                                <span class="x-fs-24 x-upper x-di x-di-v-m x-mt-08" style="text-decoration: line-through;">{{num-format originpoints}} {{local \'account.points\'}}</span>\r\n                            {{/if}}\r\n                        {{/if}}\r\n                    {{/if}}\r\n                {{/if}}\r\n                <div style="max-height: 38px">\r\n                    <div class="x-mt-20">\r\n                        <span class="x-fs-15 x-di x-di-v-m x-ff-mh x-fc-azure x-upper x-default">{{ local "booking.rate_and_room_selected" }}</span>\r\n                        <span class="x-fs-32 x-di x-di-v-m x-radio x-fc-azure x-ml-08 x-default checked"></span>\r\n                    </div>\r\n                    <div class="x-mt-20 {{#if roomsOfUnits}}x2-disable{{/if}}">\r\n                        <button type="button" class="x-fs-14 x-ff-mh x-btn x-btn-azure" data-pmg="{{pmg}}" data-item="book">{{local "booking.checkout"}}</button>\r\n                    </div>\r\n                    {{#if data.priceratio.list.length}}\r\n                        <div class="x-mt-13 x-di x-al-l" style="width: 200px; font-size: 10px; opacity: .6">\r\n                            <span class="x-al-l x-di x-full" data-pmg="{{pmg}}">\r\n                                <div class="x-fs-15 x-ff-m7 x-fc-green x-upper">{{data.priceratio.title}}</div>\r\n                                <div class="x-fs-00 x-mt-10 x-nowrap x-flex">\r\n                                    <div class="x-di x-di-v-t x-cell" style="width: 68%">\r\n                                        {{#each data.priceratio.list}}\r\n                                            <div class="x-ff-sm x-lh-15 x-fs-13">{{website}}</div>\r\n                                        {{/each}}\r\n                                    </div>\r\n                                    <div class="x-di x-di-v-t x-cell">\r\n                                        {{#each data.priceratio.list}}\r\n                                            <div class="x-ff-sm x-lh-15 x-fs-13">{{currency}} {{price-format price}}</div>\r\n                                        {{/each}}\r\n                                    </div>\r\n                                </div>\r\n                                {{#if data.priceratio.rategainDisclaimer}}\r\n                                    <div class="x-fs-14 x-ff-sm x-mt-10 x-italic">{{data.priceratio.rategainDisclaimer}}</div>\r\n                                {{/if}}\r\n                            </span>\r\n                        </div>\r\n                    {{/if}}\r\n                </div>\r\n            </div>\r\n        </div>\r\n    </div>\r\n    <div class="x-pt-20 x-highlight-lr">\r\n        <div class="x-ml-20 x-mr-20">\r\n            <div class="x-pt-13 x-pb-13" style="position: relative; z-index: 1; width: calc(100% - 285px);">\r\n                <div class="x-flex">\r\n                    <span class="x-cell x-al-l x-ff-mh x-fs-18 x-upper">{{local "booking.selected_room"}}</span>\r\n                    <span class="x-cell x-al-r x-ff-sm x-fs-18">\r\n                        <span class="x-fc-azure x-pointer x-delta right" data-item="displayChild">{{ local "booking.view_all_rooms" }}</span>\r\n                    </span>\r\n                </div>\r\n            </div>\r\n            <div class="book2-short-block x-top-line x-pt-20">\r\n                <div class="x-level">\r\n                    <div class="book2-short-image x-fs-00 x-img x-img-top x-highlight-l" style="background-image: url(\'{{image}}\')">\r\n                        <div class="book2-viewgallery shrink">\r\n                            <span class="x-fs-16 x-di x-di-v-m x-fc-white x-pointer icon-icon_A004" data-item="look"></span>\r\n                            <span class="x-fs-14 x-di x-di-v-m x-fc-white x-pointer x-ml-06" data-item="look">{{local "booking.quick_look"}}</span>\r\n                        </div>\r\n                    </div>\r\n                    <div class="book2-short-theme">\r\n                        <div>\r\n                            <h2 class="x-fs-24 x-di x-di-v-m x-lh-12 x-ff-wb">{{type}}</h2>\r\n                            {{#if amenities.length}}\r\n                                <span class="x-fs-18 x-di x-di-v-m x-ml-08 x-separator"></span>\r\n                                <span class="x-fs-18 x-di x-di-v-m x-ml-04"></span>\r\n                                {{#each amenities}}\r\n                                    <span data-item="popup-p" class="x-fs-18 x-di x-di-v-m x-ml-04 x-default x-popup {{fonticon}}">\r\n                                        <div class="x-popup-wrap x-fs-00">\r\n                                            <div class="x-popup-body x-fs-16 x-ff-sm x-nowrap" style="padding: 6px 10px">{{name}}</div>\r\n                                        </div>\r\n                                    </span>\r\n                                {{/each}}\r\n                            {{/if}}\r\n                        </div>\r\n                        {{#if badgetitle}}\r\n                            <div class="x-mt-08">\r\n                                <span class="x-fs-12 x-ff-mh x-lh-24 x-pl-08 x-pr-08 x-di x-di-v-t x-upper x-nowrap x-bc-peach x-fc-white">{{badgetitle}}</span>\r\n                            </div>\r\n                        {{/if}}\r\n                        {{#if roomtagline}}\r\n                            <div class="x-mt-08">\r\n                                <span class="x-fs-16 x-di x-di-v-m x-ff-sm x-fc-black x-normal">{{roomtagline}}</span>\r\n                            </div>\r\n                        {{else}}\r\n                            {{#if roomsize}}\r\n                                <div class="x-mt-08 x-nowrap">\r\n                                    <span class="x-fs-16 x-di x-di-v-m x-fc-black icon-icon_I016"></span>\r\n                                    <span class="x-fs-16 x-di x-di-v-m x-ff-sm x-fc-black x-ml-06 x-normal">{{{specialSymbolFix roomsize}}}</span>\r\n                                </div>\r\n                            {{/if}}\r\n                            <div class="x-mt-08">\r\n                                {{#if adults.length}}\r\n                                    {{#each adults}}\r\n                                        <span class="x-fs-16 x-di x-di-v-m x-fc-black icon-icon_J013"></span>\r\n                                    {{/each}}\r\n                                    {{#equal adults.length 1}}\r\n                                        <span class="x-fs-16 x-di x-di-v-m x-ff-sm x-ml-06">{{local "booking.adult"}}</span>\r\n                                    {{else}}\r\n                                        <span class="x-fs-16 x-di x-di-v-m x-ff-sm x-ml-06">{{local "booking.adults"}}</span>\r\n                                    {{/equal}}\r\n                                    <span class="x-di x-di-v-m x-ml-06"></span>\r\n                                {{/if}}\r\n                                {{#if children.length}}\r\n                                    {{#each children}}\r\n                                        <span class="x-fs-16 x-di x-di-v-m x-fc-black icon-icon_J012"></span>\r\n                                    {{/each}}\r\n                                    {{#equal children.length 1}}\r\n                                        <span class="x-fs-16 x-di x-di-v-m x-ff-sm x-ml-06">{{local "booking.child"}}</span>\r\n                                    {{else}}\r\n                                        <span class="x-fs-16 x-di x-di-v-m x-ff-sm x-ml-06">{{local "booking.children"}}</span>\r\n                                    {{/equal}}\r\n                                {{/if}}\r\n                                {{#if hasocc}}\r\n                                    <span class="x-di x-di-v-m x-fs-16 x-ml-06 x-default x-popup icon-icon_B008" data-item="maxocc"></span>\r\n                                {{/if}}\r\n                            </div>\r\n                        {{/if}}\r\n                        \r\n                        <div class="x-mt-08">\r\n                            {{#each bedtypes}}\r\n                                <div class="x-di x-di-v-t">\r\n                                    {{#if highlight}}\r\n                                        <div class="x-nowrap x-fc-azure">\r\n                                            <span class="x-fs-16 x-di x-di-v-m {{bedtypeicon}}"></span>\r\n                                            <span class="x-fs-16 x-di x-di-v-m x-ff-wm x-ml-06 x-under">{{bedtext}}</span>\r\n                                        </div>\r\n                                    {{else}}\r\n                                        <div class="x-nowrap x-fc-black x-pointer" data-bed-type="{{bedtype}}" data-item="beds">\r\n                                            <span class="x-fs-16 x-di x-di-v-m {{bedtypeicon}}"></span>\r\n                                            <span class="x-fs-16 x-di x-di-v-m x-ff-sm x-ml-06 x-under">{{bedtext}}</span>\r\n                                        </div>\r\n                                    {{/if}}\r\n                                    <div class="book2-updated-tip x-fs-12 x-mt-08 x-fc-green x-al-c" data-bed-type="{{bedtype}}">\r\n                                        <span class="x-fs-16 x-di x-di-v-m icon-icon_I009"></span> {{local "booking.updated"}}\r\n                                    </div>\r\n                                </div>\r\n                                <div class="x-di x-di-v-t x-ml-08"></div>\r\n                            {{/each}}\r\n                        </div>\r\n                        {{#if loyaltyroomupgradeenable}}\r\n                            <!--<div class="x-mt-18">-->\r\n                                <!--{{#if loyaltyroomupgradeusage}}-->\r\n                                    <!--<span data-item="loyaltyroomupgrade_text" class="x-di x-di-v-m x-fs-16 x-pointer x-check x-check-sm checked-azure"></span>-->\r\n                                <!--{{else}}-->\r\n                                    <!--<span data-item="loyaltyroomupgrade_text" class="x-di x-di-v-m x-fs-16 x-pointer x-check x-check-sm"></span>-->\r\n                                <!--{{/if}}-->\r\n                                <!--<span data-item="loyaltyroomupgrade_text" class="x-di x-di-v-m x-fs-16 x-fc-azure x-pointer x-pl-06 x-none">{{local "booking.use_upgrade_voucher"}}</span>-->\r\n                                <!--<span data-item="loyaltyroomupgrade_icon" class="x-di x-di-v-m x-fs-16 x-fc-azure x-default x-ml-06 icon-icon_B008"></span>-->\r\n                            <!--</div>-->\r\n                        {{/if}}\r\n                    </div>\r\n                </div>\r\n            </div>\r\n        </div>\r\n    </div>\r\n{{else}}\r\n    <div class="book2-child-block x-highlight-all">\r\n        <!--<div class="book2-child-image x-fs-00 x-img x-img-top x-highlight-tlb x-pointer" data-item="hand" style="background-image: url(\'{{data.image}}\')"></div>-->\r\n        <div class="book2-child-theme theme-add x-fs-00 x-nowrap">\r\n            <div class="panel-1 x-di x-di-v-t x-normal">\r\n                <div>\r\n                    <h2 class="x-fs-24 x-di x-di-v-m x-lh-12 x-ff-wb x-pointer" data-item="hand">{{data.ratename}}</h2>\r\n                    {{#if bestdeal}}\r\n                        <span class="x-ff-mh x-fs-12 x-di x-di-v-m x-ml-08 x-pl-05 x-pr-05 x-lh-24 x-fc-white x-bc-peach x-upper x-nowrap">{{ bestdeal }}</span>\r\n                    {{/if}}\r\n                </div>\r\n                <div class="x-mt-08">\r\n                    {{#if data.roomstay.RatePlan.paymentType}}\r\n                        <span class="x-fs-16 x-ff-m7 x-di x-di-v-m x-upper" style="color: #202020; letter-spacing: 1px">{{local "booking.pay_now_and_save"}}</span>\r\n                    {{else}}\r\n                        <span class="x-fs-16 x-ff-m7 x-di x-di-v-m x-upper" style="color: #202020; letter-spacing: 1px">{{local "booking.book_now_and_pay_later"}}</span>\r\n                    {{/if}}\r\n                    <span class="x-di x-di-v-m x-fs-16 x-ml-06 x-default icon-icon_B008" data-item="short"></span>\r\n                </div>\r\n                <div class="x-mt-08">\r\n                    <p class="x-fs-18 x-lh-12 x-ff-sm x-lh-24">\r\n                        {{data.desc}}\r\n                    </p>\r\n                </div>\r\n            </div>\r\n            <div class="panel-2 x-di x-di-v-t x-normal">\r\n                {{#if isUseMoney}}\r\n                    {{#if ratesaved}}\r\n                        {{#if isLogin}}\r\n                            <span class="x-fs-16 x-di x-di-v-m x-ff-m7 x-fc-azure x-upper">{{local "booking.you_ve_saved"}} {{currency}} {{price-format ratesaved}}</span>\r\n                            {{#if showDisCount}}\r\n                                <span class="x-fs-16 x-di x-di-v-m x-ml-06 x-fc-azure x-default icon-icon_B008" data-item="member"></span>\r\n                            {{/if}}\r\n                        {{else}}\r\n                            {{#if complete}}\r\n                                <span class="x-fs-16 x-di x-di-v-m x-ff-m7 x-upper x-through">{{local "booking.usual_price"}}: {{currency}} {{price-format rate}}</span>\r\n                            {{else}}\r\n                                <!--<span class="x-fs-16 x-di x-di-v-m x-ff-m7 x-upper">{{local "Property.members_pay"}}: {{currency}} {{price-format memberrate}}</span>-->\r\n                                <span class="x-fs-16 x-di x-di-v-m x-ff-m7 x-upper">{{local "booking.members_save"}}: {{currency}} {{price-format ratesaved}}</span>\r\n                            {{/if}}\r\n                            <!--<span class="x-fs-16 x-di x-di-v-m x-ml-06 x-default icon-icon_B008" data-item="member"></span>-->\r\n                            <div class="x-mt-04">\r\n                                    <span style="display: inline-block; max-width: 250px; line-height: 14px">\r\n                                        {{#if complete}}\r\n                                            <span class="x-fs-14 x-fc-white x-bc-azure x-di-v-m x-mr-06 icon-icon_I009"></span>\r\n                                            <span class="x-fs-12 x-ff-mm x-fw-none x-fc-azure x-di-v-m x-under">{{local "booking.complete_then_sign"}}</span>\r\n                                        {{else}}\r\n                                            <span class="x-fs-12 x-ff-mm x-fw-none x-pointer x-fc-azure x-under" data-item="sign">{{local "booking.sign_up_to_pay" }}</span>\r\n                                        {{/if}}\r\n                                    </span>\r\n                            </div>\r\n                        {{/if}}\r\n                        <div class="x-mt-08"></div>\r\n                    {{else}}\r\n                        {{#if restricted}}\r\n                            <div class="x-fs-14 x-ff-sm x-italic x-fc-gray">{{local "booking.loyalty_discount_not_applicable"}}</div>\r\n                            <div class="x-mt-08"></div>\r\n                        {{/if}}\r\n                    {{/if}}\r\n                    {{#if rate}}\r\n                        {{#if isLogin}}\r\n                            <div class="x-fs-24 x-ff-wb x-upper">{{currency}} {{price-format memberrate}}{{#if upgradePoints}}<span class="x-fs-24 x-ff-wb x-fc-peach x-ml-04 x-mr-04">+</span><span class="x-fs-24 x-ff-wb x-upper x-fc-peach">{{num-format upgradePoints}} PTS</span>{{/if}}</div>\r\n                        {{else}}\r\n                            {{#if complete}}\r\n                                <div class="x-fs-24 x-ff-wb x-upper">{{currency}} {{price-format memberrate}}</div>\r\n                            {{else}}\r\n                                <div class="x-fs-24 x-ff-wb x-upper">{{currency}} {{price-format rate}}</div>\r\n                            {{/if}}\r\n                        {{/if}}\r\n                        {{#if isManyDays}}\r\n                            <div class="x-fs-16 x-ff-m7 x-upper x-mt-08">{{local "Property.avg_night"}}</div>\r\n                        {{else}}\r\n                            <div class="x-fs-16 x-ff-m7 x-upper x-mt-08">{{local "general.avg_night"}}</div>\r\n                        {{/if}}\r\n                        {{#if enableslashprice}}\r\n                            {{#if priceCompared}}\r\n                                <span class="x-fs-24 x-upper x-di x-di-v-m x-mt-08" style="text-decoration: line-through;">{{currency}} {{price-format originrate}}</span>\r\n                            {{/if}}\r\n                        {{/if}}\r\n                    {{/if}}\r\n                {{/if}}\r\n                {{#if isUsePoint}}\r\n                    {{#if pointssaved}}\r\n                        {{#if isLogin}}\r\n                            <span class="x-fs-16 x-di x-di-v-m x-ff-m7 x-fc-azure x-upper">{{local "booking.you_ve_saved"}} {{num-format pointssaved}} {{local \'checkout.points\'}}</span>\r\n                            {{#if showDisCount}}\r\n                                <span class="x-fs-16 x-di x-di-v-m x-ml-06 x-fc-azure x-default icon-icon_B008" data-item="member"></span>\r\n                            {{/if}}\r\n                        {{else}}\r\n                            {{#if complete}}\r\n                                <span class="x-fs-16 x-di x-di-v-m x-ff-m7 x-upper x-through">{{local "booking.usual_price"}}: {{num-format points}} {{local \'checkout.points\'}}</span>\r\n                            {{else}}\r\n                                <!--<span class="x-fs-16 x-di x-di-v-m x-ff-m7 x-upper">{{local "Property.members_pay"}}: {{num-format memberpoints}} {{local \'checkout.points\'}}</span>-->\r\n                                <span class="x-fs-16 x-di x-di-v-m x-ff-m7 x-upper">{{local "booking.members_save"}}: {{num-format pointssaved}} {{local "checkout.points"}}</span>\r\n                            {{/if}}\r\n                            <!--<span class="x-fs-16 x-di x-di-v-m x-ml-06 x-default icon-icon_B008" data-item="member"></span>-->\r\n                            <div class="x-mt-04">\r\n                                    <span style="display: inline-block; max-width: 250px; line-height: 14px">\r\n                                        {{#if complete}}\r\n                                            <span class="x-fs-14 x-fc-white x-bc-azure x-di-v-m x-mr-06 icon-icon_I009"></span>\r\n                                            <span class="x-fs-12 x-ff-mm x-fw-none x-fc-azure x-di-v-m x-under">{{local "booking.complete_then_sign"}}</span>\r\n                                        {{else}}\r\n                                            <span class="x-fs-12 x-ff-mm x-fw-none x-pointer x-fc-azure x-under" data-item="sign">{{local "booking.sign_up_to_pay" }}</span>\r\n                                        {{/if}}\r\n                                    </span>\r\n                            </div>\r\n                        {{/if}}\r\n                        <div class="x-mt-08"></div>\r\n                    {{else}}\r\n                        {{#if restricted}}\r\n                            <div class="x-fs-14 x-ff-sm x-italic x-fc-gray">{{local "booking.loyalty_discount_not_applicable"}}</div>\r\n                            <div class="x-mt-08"></div>\r\n                        {{/if}}\r\n                    {{/if}}\r\n                    {{#if points}}\r\n                        {{#if isLogin}}\r\n                            {{#if upgradePoints}}\r\n                                <div class="x-fs-24 x-ff-wb x-upper">{{num-format memberpoints}}<span class="x-fs-24 x-ff-wb x-fc-peach x-ml-04 x-mr-04">+</span><span class="x-fs-24 x-ff-wb x-upper x-fc-peach">{{num-format upgradePoints}} PTS</span></div>\r\n                            {{else}}\r\n                                <div class="x-fs-24 x-ff-wb x-upper">{{num-format memberpoints}} {{local \'account.points\'}}</div>\r\n                            {{/if}}\r\n                        {{else}}\r\n                            {{#if complete}}\r\n                                <div class="x-fs-24 x-ff-wb x-upper">{{num-format memberpoints}} {{local \'account.points\'}}</div>\r\n                            {{else}}\r\n                                <div class="x-fs-24 x-ff-wb x-upper">{{num-format points}} {{local \'account.points\'}}</div>\r\n                            {{/if}}\r\n                        {{/if}}\r\n                        {{#if isManyDays}}\r\n                            <div class="x-fs-16 x-ff-m7 x-upper x-mt-08">{{local "Property.avg_night"}}</div>\r\n                        {{else}}\r\n                            <div class="x-fs-16 x-ff-m7 x-upper x-mt-08">{{local "general.avg_night"}}</div>\r\n                        {{/if}}\r\n                        {{#if enableslashprice}}\r\n                            {{#if PointsCompared}}\r\n                                <span class="x-fs-24 x-upper x-di x-di-v-m x-mt-08" style="text-decoration: line-through;">{{num-format originpoints}} {{local \'account.points\'}}</span>\r\n                            {{/if}}\r\n                        {{/if}}\r\n                    {{/if}}\r\n                {{/if}}\r\n                <div style="max-height: 38px">\r\n                    <div class="x-mt-20">\r\n                        <span class="x-fs-15 x-di x-di-v-m x-ff-mh x-fc-azure x-upper x-default">{{local "booking.select_this_rate"}}</span>\r\n                        <span class="x-fs-32 x-di x-di-v-m x-radio x-fc-azure x-ml-08 x-pointer" data-item="hand"></span>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n        </div>\r\n    </div>\r\n{{/if}}';
},{}],268:[function(e,i,a){var t=e("underscore"),r=e("backbone"),n=e("backbone.marionette"),o=e("./child/view"),s=e("./empty/view");i.exports=n.CollectionView.extend({childView:o,emptyView:s,className:"book2-content-section",childViewOptions:function(e,i){return{model:e,index:i,rootState:this.options.rootState}},initialize:function(){var e=this,i=e.options.rootState,a=i.getParam().code,n=i.getRooms({hotelcode:a});n=t.sortBy(n,function(e){var a=e.id;return a===i.getParam().defaultRoom?-1:t.findIndex(n,{id:a})}),e.collection=new r.Collection(n),e.collection.comparator=function(e){var a=e.get("id");return a===i.getParam().defaultRoom?-1:t.findIndex(n,{id:a})},e.listenTo(i,"showSummaryView",e.__changeIndex)},onRender:function(){this.__defaultExpandChildView()},__changeIndex:function(){var e=this,i=e.collection,a=e.options.rootState,t=a.getParam().defaultRoom,r=i.findWhere({id:t});if(r)if(i.indexOf(r)>0)i.sort();else{var n=e.children.findByModel(r);n&&n.render()}},__defaultExpandChildView:function(){var e=this,i=e.collection,a=e.options.rootState,t=a.getParam().defaultRoom,r=null;a.isFinal()&&i.length&&(t&&(r=i.findWhere({id:t,availability:!0})),r||(r=i.findWhere({availability:!0})),r&&a.trigger("loadRatesByRoom",{categoryid:r.get("id")}))}})},{"./child/view":265,"./empty/view":267,backbone:8,"backbone.marionette":6,underscore:42}],267:[function(e,i,a){var t=e("backbone.marionette");i.exports=t.ItemView.extend({template:Handlebars.compile(e("./template.hbs")),serializeData:function(){return{disablereservation:this.options.rootState.getHotel().disablereservation}},onRender:function(){},onDestroy:function(){}})},{"./template.hbs":266,"backbone.marionette":6}],266:[function(e,i,a){i.exports='{{#if disablereservation}}\r\n    <div class="x-fs-20 x-lh-12 x-al-c" style="padding: 4em">{{local "booking.disable_reservation"}}</div>\r\n{{else}}\r\n    <div class="x-fs-20 x-lh-12 x-al-c" style="padding: 4em">{{local "Property.no_room_avaliable"}}</div>\r\n{{/if}}'},{}],265:[function(e,i,a){var t=(e("underscore"),e("backbone")),r=e("backbone.marionette"),n=e("./01-room/view"),o=e("./02-stay/view"),s=e("./03-rate/view"),l=e("../../../../06-popping/view"),c=e("../../../../common/popup"),d=!1;i.exports=r.LayoutView.extend({template:Handlebars.compile(e("./template.hbs")),regions:{room:"[data-region='room']",stay:"[data-region='stay']",rate:"[data-region='rate']"},ui:{highlight:".x-highlight",differ:"[data-item='differ']",voucherBox:"[data-item='voucherBox']",voucherTip:"[data-item='voucherTip']",voucherTxt:"[data-item='voucherTxt']",voucherText:"[data-item='voucherText']",sales:"[data-item='sales']",close:"[data-item='close']","rup2-icon":"[data-item=rup2-icon]"},events:{"click @ui.close":function(){this.options.rootState.SALES_SHOW=!0,this.ui.sales.hide()},"click @ui.voucherBox":function(){var e=this,i=e.model.toJSON(),a=e.options.rootState,t=a.getAllah({categoryid:i.id});t&&(t.voucherusage?(a.trigger("turnUpgradeRate",{categoryid:t.categoryid,roomtypecode:t.roomtypecode,ratecode:t.ratecode,roomid:t.roomid,voucherusage:!1}),a.trigger("expandChildView",t)):(a.setIGPointsWhenRup(a.getIGPoints()),a.trigger("loadUpgradeRate",t)))},"mouseenter @ui.voucherTip":function(e){e.stopPropagation(),c.addPopupTip(this,l.VOUCHER,this.serializeData(),jQuery(e.currentTarget),!1,!1,!0)},"mouseleave @ui.voucherTip":function(e){e.stopPropagation(),c.delPopupTip()}},serializeData:function(){var e,i,a=this,t=a.model.toJSON(),r=a.options.rootState,n=r.getHotel(),o=t.differentiator,s=r.getAllah({categoryid:t.id}),l=s&&s.roomupgradeavailabled;return s&&s.voucherusage&&(i=r.getUpgradeRateByRate({categoryid:s.categoryid,roomtypecode:s.roomtypecode,ratecode:s.ratecode,roomid:s.roomid}),e=i&&i.roomtype),{bookingflowgreenbarcontent:n&&n.bookingflowgreenbarcontent,isUseMoney:r.isTrade(r.VIEW_TRADES.USE_MONEY),isUsePoint:r.isTrade(r.VIEW_TRADES.USE_POINT),id:t.id,expandAll:o||l,differentiator:o,vouchervisible:l,voucherusage:s&&s.voucherusage,originRoomName:t&&t.type,targetRoomName:e&&e.type,upgradeObject:i}},initialize:function(){var e=this.options.rootState;this.__renderDeferred=jQuery.Deferred(),this.listenTo(e,"expandSelfView",this.expandChildView),this.listenTo(e,"expandPopupView",this.expandPopupView),this.listenTo(e,"hiddenPopupView",this.hiddenPopupView),this.listenTo(e,"turnUpgradeRate",this.turnUpgradeRate),this.listenTo(e,"showUpgradeTip",this.showUpgradeTip)},onRender:function(){this.__showRoomView(!1),this.__renderDeferred.resolve()},expandChildView:function(e){return this.__renderDeferred.then(jQuery.proxy(this.__expandChildView,this,e))},expandPopupView:function(e){return this.__renderDeferred.then(jQuery.proxy(this.__expandPopupView,this,e))},hiddenPopupView:function(e){return this.__renderDeferred.then(jQuery.proxy(this.__hiddenPopupView,this,e))},turnUpgradeRate:function(e){return this.__renderDeferred.then(jQuery.proxy(this.__turnUpgradeRate,this,e))},showUpgradeTip:function(e){return this.__renderDeferred.then(jQuery.proxy(this.__showUpgradeTip,this,e))},__expandChildView:function(e){this.model.get("id")===e.categoryid?(this.__holdHighlight(),this.__hideSalesItem(),this.__showStayView(!0),this.__showRoomView(!0)):(this.__freeHighlight(),this.__hideRateView(),this.__hideStayView(),this.__showRoomView(!1))},__expandPopupView:function(e){this.model.get("id")===e.categoryid?(this.__holdHighlight(),this.__showStayView(!1),this.__showRoomView(!0)):(this.__freeHighlight(),this.__hideRateView(),this.__hideStayView(),this.__showRoomView(!1))},__hiddenPopupView:function(e){this.model.get("id")===e.categoryid?(this.__holdHighlight(),this.__hideRateView(),this.__showStayView(!0),this.__showRoomView(!0)):(this.__freeHighlight(),this.__hideRateView(),this.__hideStayView(),this.__showRoomView(!1))},__showRoomView:function(e){this.getRegion("room").show(new n({model:this.model,rootState:this.options.rootState,openPopupView:this.getRegion("rate").hasView(),expandAll:e}))},__showStayView:function(e){var i=this,a=i.model.get("id"),r=i.options.rootState,n=r.getAllah({categoryid:a}),s={};n&&n.voucherusage&&(s=r.getUpgradeRateByRate({categoryid:n.categoryid,roomtypecode:n.roomtypecode,ratecode:n.ratecode,roomid:n.roomid}),s&&s.roomrate&&(n=s.roomrate||n)),this.getRegion("stay").show(new o({model:n?new t.Model(n):null,rootState:r,expandAll:e&&!this.getRegion("rate").hasView(),upgradeBeforeHero:s?r.getAllah({categoryid:a}):null}))},__showRateView:function(){this.getRegion("rate").show(new s({model:this.model,rootState:this.options.rootState}))},__hideStayView:function(){this.getRegion("stay").empty()},__hideRateView:function(){this.getRegion("rate").empty()},__holdHighlight:function(){this.ui.differ.show(),this.ui.highlight.addClass("holds")},__freeHighlight:function(){this.ui.differ.hide(),this.ui.highlight.removeClass("holds")},__hideSalesItem:function(){var e=this,i=e.options.rootState;i.isFirstLoad()&&!i.SALES_SHOW?e.ui.sales.css("display","table"):e.ui.sales.css("display","none")},__turnUpgradeRate:function(e){var i=this,a=i.model.toJSON(),t=i.options.rootState,r=t.getAllah({categoryid:a.id});r&&r.categoryid===e.categoryid&&r.roomtypecode===e.roomtypecode&&r.ratecode===e.ratecode&&r.roomid===e.roomid&&(t.changeRateValue(e),e.voucherusage?(i.ui.voucherBox.addClass("checked"),i.ui.voucherText.text(i18n.t("rup.room_upgraded"))):(i.ui.voucherBox.removeClass("checked"),i.ui.voucherText.text(i18n.t("rup.use_points_to_upgrade"))),i.__updateVoucherTxt())},__showUpgradeTip:function(){var e=this;if(e.serializeData().vouchervisible){if(d)return;d=!0,e.ui.voucherTip.length&&e.ui.voucherTip[0].clientHeight&&e.ui.voucherTip.finish().trigger("mouseenter").delay(5e3).queue(function(){jQuery(this).trigger("mouseleave").dequeue()})}},__updateVoucherTxt:function(){}})},{"../../../../06-popping/view":343,"../../../../common/popup":348,"./01-room/view":252,"./02-stay/view":257,"./03-rate/view":263,"./template.hbs":264,backbone:8,"backbone.marionette":6,underscore:42}],264:[function(e,i,a){i.exports='<div class="x-mt-13 x-ff-00 x-pl-20 x-pr-20 x-pt-13 x-pb-13 x-flex x-bc-green" style="display: none" data-item="sales">\r\n    <div class="x-cell x-al-l">\r\n        <span class="x-fs-14 x-fc-white x-di x-di-v-m">{{#if bookingflowgreenbarcontent}}{{bookingflowgreenbarcontent}}{{else}}{{local "booking.epic_sales"}}{{/if}}</span>\r\n    </div>\r\n    <div class="x-cell x-al-r">\r\n        <span class="x-fs-24 x-fc-white x-di x-di-v-m x-pointer icon-icon_B017" data-item="close"></span>\r\n    </div>\r\n</div>\r\n\r\n<div class="x-mt-13" data-id="{{id}}"></div>\r\n\r\n{{#if expandAll}}\r\n    <div class="x-pl-20 x-pr-20 x-pt-17 x-pb-17 x-bc-azure x-hide" data-item="differ">\r\n        <div class="x-flex x-fs-00">\r\n            <div class="x-cell x-al-l x-di-v-m">\r\n                {{#if vouchervisible}}\r\n                    <!--<span class="x-fs-20 x-di x-di-v-m x-fc-white icon-icon_J015"></span>-->\r\n                    <!--<span data-item="voucherTxt" class="x-fs-14 x-di x-di-v-m x-fc-white x-ml-06 x-ff-wb">-->\r\n                        <!--{{#if voucherusage}}-->\r\n                            <!--{{local "booking.you_have_been_upgraded" targetRoomName originRoomName }}-->\r\n                        <!--{{else}}-->\r\n                            <!--{{local "booking.use_your_room_upgrade_voucher"}}-->\r\n                        <!--{{/if}}-->\r\n                    <!--</span>-->\r\n\r\n                    <span class="x-fs-14 x-di x-di-v-m x-fc-white x-ff-wb">{{differentiator}}</span>\r\n                {{else}}\r\n                    <span class="x-fs-14 x-di x-di-v-m x-fc-white x-ff-wb">{{differentiator}}</span>\r\n                {{/if}}\r\n            </div>\r\n            <div class="x-cell x-al-r x-di-v-m">\r\n                {{#if vouchervisible}}\r\n                    {{#if voucherusage}}\r\n                        <span class="x-fs-16 x-di x-di-v-m x-fc-white x-check x-check-sm x-pointer checked" data-item="voucherBox"></span>\r\n                        <span class="x-fs-14 x-di x-di-v-m x-fc-white x-ml-06 x-upper x-ff-m7 x-none x-mt-02" style="letter-spacing: 0.65px;" data-item="voucherText">{{local \'rup.room_upgraded\'}}</span>\r\n                    {{else}}\r\n                        <span class="x-fs-16 x-di x-di-v-m x-fc-white x-check x-check-sm x-pointer" data-item="voucherBox"></span>\r\n                        <span class="x-fs-14 x-di x-di-v-m x-fc-white x-ml-06 x-upper x-ff-m7 x-none x-mt-02" style="letter-spacing: 0.65px;" data-item="voucherText">{{local \'rup.use_points_to_upgrade\'}}</span>\r\n                    {{/if}}\r\n                    <!--<span class="x-fs-14 x-di x-di-v-m x-fc-white x-ml-06 x-upper x-ff-mh x-none">{{local "booking.use_upgrade_voucher"}}</span>-->\r\n                    <span class="x-fs-16 x-di x-di-v-m x-fc-white x-ml-06 x-default icon-icon_B008" data-item="voucherTip"></span>\r\n                {{/if}}\r\n            </div>\r\n        </div>\r\n    </div>\r\n{{/if}}\r\n\r\n<div class="x-bc-white x-fs-00">\r\n    <div class="x-highlight">\r\n        <div data-region="room"></div>\r\n        <div data-region="stay"></div>\r\n    </div>\r\n    <div data-region="rate"></div>\r\n</div>'},{}],263:[function(e,i,a){function t(e){return r.uniq(e,function(e){return e.ratecode})}var r=e("underscore"),n=e("backbone"),o=e("backbone.marionette"),s=e("./child/view"),l=e("./empty/view");i.exports=o.CompositeView.extend({childView:s,emptyView:l,template:Handlebars.compile(e("./template.hbs")),childViewContainer:".book2-rate-container",events:{"click [data-item='close']":function(){var e=this,i=e.options.rootState;i.trigger("hiddenPopupView",{categoryid:e.model.get("id")})}},childViewOptions:function(e){var i=this,a=i.model.get("id"),t=i.options.rootState,r=t.getAllah({categoryid:a});return{model:e,expandAll:r&&r.roomtypecode===e.get("roomtypecode")&&r.ratecode===e.get("ratecode")&&r.roomid===e.get("roomid"),rootState:t}},initialize:function(){var e=this,i=e.model.get("id"),a=e.options.rootState,r=a.getAllah({categoryid:i}),o=[];r&&(o=a.getRates({categoryid:i,bedtype:r.bedtype})),e.collection=new n.Collection(t(o))}})},{"./child/view":259,"./empty/view":261,"./template.hbs":262,backbone:8,"backbone.marionette":6,underscore:42}],262:[function(e,i,a){i.exports='<div class="book2-rate-container"></div>\r\n{{#unless expandAll}}\r\n    <div class="x-ml-20 x-mr-20 x-al-c x-lh-50 x-pointer x-top-line" data-item="close">\r\n        <span class="x-fs-16 x-ff-m7 x-upper x-delta">{{local "general.close"}}</span>\r\n    </div>\r\n{{/unless}}'},{}],261:[function(e,i,a){var t=e("backbone.marionette");i.exports=t.ItemView.extend({template:Handlebars.compile(e("./template.hbs"))})},{"./template.hbs":260,"backbone.marionette":6}],260:[function(e,i,a){i.exports='<div class="x-fs-20 x-lh-12 x-al-c" style="padding: 2em">{{local "booking.no_rate_option"}}</div>'},{}],257:[function(e,i,a){var t=e("underscore"),r=e("backbone"),n=e("backbone.marionette"),o=e("../../../../../../ui/util"),s=e("../../../../../common/count"),l=e("../../../../../common/short"),c=e("./child/view"),d=e("./empty/view");i.exports=n.CompositeView.extend({childView:c,emptyView:d,template:Handlebars.compile(e("./template.hbs")),className:"x-highlight-lrb",childViewContainer:".book2-stay-container",ui:{first:"[data-item='first']",child:"[data-item='child']",other:"[data-item='other']",count:"[data-item='count']",update:".book2-updated-tip",change:"[data-item='change']"},events:{"click @ui.other":function(){var e=this,i=e.options.rootState;e.model&&(i.trigger("showLampBoxStay",e.model.toJSON()),i.trigger("lightBoxAnimate",e.ui.other.offset()))},"click @ui.change":function(){var e=this,i=e.options.rootState;i.isStyle(i.VIEW_STYLES.HOTEL_BY_ROOM)?(i.trigger("showLampBoxRate",e.options.upgradeBeforeHero||e.model.toJSON()),i.trigger("lightBoxAnimate",e.ui.change.offset())):i.isStyle(i.VIEW_STYLES.HOTEL_BY_RATE)&&(i.trigger("showLampBoxRoom",e.model.toJSON()),i.trigger("lightBoxAnimate",e.ui.change.offset()))}},childViewOptions:function(e){return{model:e,rootState:this.options.rootState}},serializeData:function(){var e=this,i=null,a=e.options.rootState;return e.collection.length&&(i=e.collection.at(0).toJSON()),{currency:a.getCurrency(),isUseMoney:a.isTrade(a.VIEW_TRADES.USE_MONEY),isUsePoint:a.isTrade(a.VIEW_TRADES.USE_POINT),isHotelByRoom:a.isStyle(a.VIEW_STYLES.HOTEL_BY_ROOM),isHotelByRate:a.isStyle(a.VIEW_STYLES.HOTEL_BY_RATE),expandAll:i&&e.options.expandAll,onlyone:1===e.collection.length&&e.options.expandAll,data:i,multiple:parseInt(a.getParam().rooms)>1}},initialize:function(){var e=this,i=e.model,a=e.options.rootState,t=[];i&&(t=a.getStays({roomtypecode:i.get("roomtypecode"),ratecode:i.get("ratecode"),roomid:i.get("roomid")})),e.collection=new r.Collection(t),e.__childVisible=!1,e.__renderDeferred=jQuery.Deferred(),e.listenTo(a,"redrawViewChild",e.redrawViewChild),e.listenTo(a,"changePartCount",e.changePartCount),l.autoCreate(this)},onRender:function(){var e=this;e.__renderDeferred.resolve(),e.__childVisible||0===e.collection.length?e.__showChild():e.__addCount(),1===e.collection.length&&e.ui.other.remove()},redrawViewChild:function(e){return this.__renderDeferred.then(jQuery.proxy(this.__redrawViewChild,this,e))},changePartCount:function(e){return this.__renderDeferred.then(jQuery.proxy(this.__changePartCount,this,e))},__redrawViewChild:function(){this.render()},__changePartCount:function(){var e=this,i=e.model,a=e.options.rootState,r=[];i&&(r=a.getStays({roomtypecode:i.get("roomtypecode"),ratecode:i.get("ratecode"),roomid:i.get("roomid")})),e.collection.length&&(e.children.forEach(function(e){var i=t.findWhere(r,{key:e.model.get("key")});i&&(e.model.set(i),e.createCountView())}),e.__addCount())},__onChangeCount:function(e){var i=this,a=i.collection.at(0),t=a.toJSON(),r={roomtypecode:t.roomtypecode,ratecode:t.ratecode,roomid:t.roomid},n=i.options.rootState;n.setStayCount({key:t.key,categoryid:t.categoryid,quantity:e}),n.trigger("changePartCount",r),1===t.maxquantity?i.__showUpdateTip():i.__fadeUpdateTip()},__showChild:function(){this.ui.first.hide(),this.ui.child.show(),this.ui.other.html(i18n.t("booking.see_less_addons")),o.tracker.trigger("change:size"),this.__childVisible=!0},__hideChild:function(){this.ui.first.show(),this.ui.child.hide(),this.ui.other.html(i18n.t("booking.see_more_addons")),o.tracker.trigger("change:size"),this.__childVisible=!1,this.collection.length&&this.__addCount()},__addCount:function(){var e=this,i=e.collection.at(0).toJSON(),a=e.options.rootState,t=parseFloat(i.maxquantity),r=a.getStayCount({key:i.key,categoryid:i.categoryid});s.autoCreate(this.ui.count,{minValue:0,maxValue:t&&t>0?t:99,value:r||0,change:jQuery.proxy(this.__onChangeCount,this),label:i18n.t("booking.add_to_booking"),single:!0})},__showUpdateTip:function(){this.ui.update.finish&&this.ui.update.finish().fadeIn(200).delay(5e3).fadeOut(400)},__fadeUpdateTip:t.debounce(function(){this.__showUpdateTip()},500)})},{"../../../../../../ui/util":2122,"../../../../../common/count":345,"../../../../../common/short":350,"./child/view":254,"./empty/view":255,"./template.hbs":256,backbone:8,"backbone.marionette":6,underscore:42}],256:[function(e,i,a){i.exports='{{#if data}}\r\n    <div class="x-ml-20 x-mr-20 x-pt-20 x-pb-20">\r\n        <div class="book2-short-block">\r\n            <div class="x-fs-00 x-default-bold">\r\n                {{#if data}}\r\n                    {{#if multiple}}\r\n                        <span class="x-fs-12 x-ff-mh x-upper" style="color: #202020; font-weight: 300;">{{local "booking.add_more_value_to_this_rate_for_each_room"}}</span>\r\n                    {{else}}\r\n                        <span class="x-fs-12 x-ff-mh x-upper" style="color: #202020; font-weight: 300;">{{local "booking.add_more_value_to_this_rate"}}</span>\r\n                    {{/if}}\r\n                {{/if}}\r\n            </div>\r\n            {{#if data}}\r\n                {{#if onlyone}}\r\n                    <div class="x-fs-00 x-mt-08 x-nowrap">\r\n                        <div class="book2-stay-image x-di x-di-v-t x-img" style="background-image: url(\'{{data.img}}\')"></div>\r\n                        <div class="book2-stay-theme x-di x-di-v-t">\r\n                            <div class="book2-stay-child x-fs-00 x-nowrap">\r\n                                <div class="panel-1 x-di x-di-v-m x-normal">\r\n                                    <div><h4 class="x-fs-18 x-ff-wb">{{data.inventorycode}}</h4></div>\r\n                                    <div style="margin-top: 12px">\r\n                                        <p class="x-fs-13 x-lh-18 x-ff-sm x-short" data-line="2">\r\n                                            {{data.desc}}\r\n                                        </p >\r\n                                    </div>\r\n                                </div>\r\n                                <div class="panel-2 x-di x-di-v-m x-normal">\r\n                                    <div>\r\n                                        {{#if isUseMoney}}\r\n                                            <span class="x-fs-18 x-ff-m7 x-di-v-t x-upper"><span class="x-fs-13 x-ff-m7 x-di-v-t x-upper">+{{data.ratecurrency}}</span> {{price-format data.avgdisplayrate}}</span>\r\n                                        {{/if}}\r\n                                        {{#if isUsePoint}}\r\n                                            <span class="x-fs-18 x-ff-m7 x-di-v-t x-upper">{{num-format data.avgcostpoints}}</span>\r\n                                        {{/if}}\r\n                                    </div>\r\n                                    <div class="x-mt-04">\r\n                                        <span class="x-fs-12 x-ff-sm x-upper">{{local "booking.price_for_all_guests"}}</span>\r\n                                    </div>\r\n                                    <div class="x-mt-10">\r\n                                        <span class="x-fs-00" data-item="count"></span>\r\n                                    </div>\r\n                                    <div class="book2-updated-tip x-fs-12 x-mt-08 x-fc-green x-al-r">\r\n                                        <span class="x-fs-16 x-di x-di-v-m icon-icon_I009"></span> {{local "booking.updated"}}\r\n                                    </div>\r\n                                </div>\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n                {{else}}\r\n                    <div class="x-mt-08" data-item="first">\r\n                        <div class="book2-stay-child x-fs-00 x-nowrap">\r\n                            <div class="panel-1 x-di x-di-v-m x-normal">\r\n                                <div><h4 class="x-fs-18 x-ff-wb">{{data.inventorycode}}</h4></div>\r\n                                {{#if expandAll}}\r\n                                    <div style="margin-top: 12px">\r\n                                        <p class="x-fs-13 x-ff-sm x-lh-18 x-short" data-line="2">\r\n                                            {{data.desc}}\r\n                                        </p >\r\n                                    </div>\r\n                                {{/if}}\r\n                            </div>\r\n                            <div class="panel-2 x-di x-di-v-m x-normal">\r\n                                <div>\r\n                                    {{#if isUseMoney}}\r\n                                        <span class="x-fs-17 x-ff-wb x-di-v-t x-upper"><span class="x-fs-13 x-ff-wb x-di-v-t x-upper">+{{data.ratecurrency}}</span> {{price-format data.avgdisplayrate}}</span>\r\n                                    {{/if}}\r\n                                    {{#if isUsePoint}}\r\n                                        <span class="x-fs-17 x-ff-wb x-di-v-t x-upper">{{num-format data.costpoints}}</span>\r\n                                    {{/if}}\r\n                                </div>\r\n                                <div class="x-mt-02">\r\n                                    <span class="x-fs-12 x-ff-mh x-upper">{{#if multiple}}{{local "booking.per_room"}} {{/if}}{{data.pricingtype}}</span>\r\n                                </div>\r\n                                {{#if expandAll}}\r\n                                    <div class="x-mt-10">\r\n                                        <span class="x-fs-00" data-item="count"></span>\r\n                                    </div>\r\n                                    <div class="book2-updated-tip x-fs-12 x-mt-08 x-fc-green x-al-r">\r\n                                        <span class="x-fs-16 x-di x-di-v-m icon-icon_I009"></span> {{local "booking.updated"}}\r\n                                    </div>\r\n                                {{/if}}\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n                {{/if}}\r\n            {{/if}}\r\n            <div class="book2-stay-container" data-item="child"></div>\r\n            {{#if expandAll}}\r\n                <div class="x-mt-08">\r\n                    <span class="x-fs-13 x-ff-mm x-fc-azure x-pointer x-under" data-item="other">{{local "booking.see_more_addons"}}</span>\r\n                </div>\r\n            {{/if}}\r\n        </div>\r\n    </div>\r\n{{else}}\r\n    <div>\r\n        <div class="book2-stay-container" data-item="child"></div>\r\n    </div>\r\n{{/if}}\r\n<div class="x-pt-17 x-pb-20 x-top-line x-ml-20 x-mr-20 x-al-c x-highlight-b x-pointer" data-item="change">\r\n    <!--([x-upper] style: text-transform: uppercase;)-->\r\n    {{#if isHotelByRoom}}\r\n        <div class="x-fs-16 x-ff-m7 x-ml-20 x-fc-azure x-delta right">{{local "booking.view_and_compare_all_rates"}}</div>\r\n    {{/if}}\r\n    {{#if isHotelByRate}}\r\n        <div class="x-fs-16 x-ff-m7 x-ml-20 x-fc-azure x-delta right">{{local "booking.view_and_compare_all_rooms"}}</div>\r\n    {{/if}}\r\n</div>'},{}],252:[function(e,i,a){function t(e){var i=e.memberrate===e.avgdisplayoriginalprice;return!i}function r(e){var i=(e.avgdisplaypoints||e.points)===e.avgdisplayoriginalpoints;return!i}function n(e){return e.avgdisplayoriginalprice}function o(e){return e.avgdisplayoriginalpoints}function s(e){return e.memberrate}function l(e){return e.avgdisplaypoints||e.points}function c(e){return e.memberrate}function d(e){return e.avgdisplaypoints||e.points}function p(e,i,a,t){var r=x.has(i,"memberrate")&&x.has(i,"avgdisplaypoints"),n=x.uniq(e,function(e){return e.bedtype});return n=x.map(n,function(a){return r&&x.findWhere(e,{ratecode:i.ratecode,bedtype:a.bedtype})||a}),n=x.map(n,function(e){var n=e.bedtype,o=e.bedtypeicon,s=parseFloat(e.memberrate),l=parseFloat(e.avgdisplaypoints),c=e.bedtype===i.bedtype;if(r&&!c)if(t){var d=l-parseFloat(i.avgdisplaypoints);d&&(n=Handlebars.compile("{{bedtype}} ({{operator}}{{num-format difference}})")({bedtype:n,currency:a,operator:d>0?"+":"-",difference:Math.abs(d)}))}else{var d=s-parseFloat(i.memberrate);d&&(n=Handlebars.compile("{{bedtype}} ({{operator}}{{currency}}{{price-format difference}})")({bedtype:n,currency:a,operator:d>0?"+":"-",difference:Math.abs(d)}))}return{bedtext:n,bedtype:e.bedtype,bedtypeicon:o,highlight:c}})}function m(e){return x.filter(e||[],function(e){return!!e.fonticon}).slice(0,4)}var x=e("underscore"),f=e("backbone.marionette"),u=e("moment"),h=e("../../../../../../ui/util"),g={},v=!1,_="YYYY-MM-DD",y=e("../../../../../06-popping/view"),b=e("../../../../../common/popup"),w=e("../../../../../common/short");i.exports=f.ItemView.extend({template:Handlebars.compile(e("./template.hbs")),ui:{voucher:"[data-item='voucher']",voucherBox:"[data-item='voucher'].x-check",voucherTip:"[data-item='voucher-popup']",otherRoom:"[data-item='other-room']",otherDate:"[data-item='other-date']",popup:"[data-item='popup']",maxocc:"[data-item='maxocc']",member:"[data-item='member']","short":"[data-item='short']",short_p:"[data-item='short-p']",readmore:"[data-item='readmore']",displayChild:"[data-item='displayChild']",loyaltyroomupgrade_text:"[data-item='loyaltyroomupgrade_text']",loyaltyroomupgrade_icon:"[data-item='loyaltyroomupgrade_icon']",ss_link:"[data-btn='ss_link']",cityUrl:"[data-link='cityUrl']"},events:{"mouseenter @ui.maxocc":function(e){e.stopPropagation(),b.addPopupTip(this,y.OCCUPANCY,this.getOccupancy(),jQuery(e.currentTarget))},"mouseleave @ui.maxocc":function(e){e.stopPropagation(),b.delPopupTip()},"mouseenter @ui.member":function(e){e.stopPropagation();this.serializeData();b.addPopupTip(this,y.MEMBER,this.getMember(),jQuery(e.currentTarget))},"mouseleave @ui.member":function(e){e.stopPropagation(),b.delPopupTip()},"mouseenter @ui.short":function(e){e.stopPropagation(),b.addPopupTip(this,y.PENALTY,this.getTipShort(),jQuery(this.ui["short"]))},"mouseleave @ui.short_p":function(e){e.stopPropagation(),b.delPopupTip()},"mouseenter @ui.short_p":function(e){e.stopPropagation(),b.addPopupTip(this,y.PENALTY,this.getTipShort(),jQuery(this.ui["short"]))},"mouseleave @ui.short":function(e){e.stopPropagation(),b.delPopupTip()},"click [data-item='look']":function(e){e.stopPropagation();var i=this,a=i.options.rootState;a.isFinal()&&a.trigger("planGalleryData",{categoryid:i.model.get("id")})},"click [data-item='beds']":function(e){var i=this;if(i.options.expandAll){var a=null,t=i.model.get("id"),r=i.options.rootState,n=r.getAllah({categoryid:t}),o=jQuery(e.currentTarget).attr("data-bed-type"),s=r.getRates({categoryid:t,bedtype:o});r.isFinal()&&s.length&&(a=n?x.findWhere(s,{ratecode:n.ratecode})||s[0]:s[0],r.setAllah({categoryid:a.categoryid,roomtypecode:a.roomtypecode,ratecode:a.ratecode,roomid:a.roomid}),r.storeUpdatedTip({type:g,code:t,name:o}),r.trigger("loadStaysByRate",a))}},"click [data-item='hand']":function(){var e=this,i=e.options.rootState;i.isFinal()&&i.trigger("loadRatesByRoom",{categoryid:e.model.get("id")})},"click [data-item='rate']":function(){var e=this,i=e.options.rootState;i.isFinal()&&(e.options.openPopupView?i.trigger("hiddenPopupView",{categoryid:e.model.get("id")}):i.trigger("expandPopupView",{categoryid:e.model.get("id")}))},"click [data-item='s-rate-calendar']":function(){var e=this,i=e.options.rootState;i.setLastStyle(i.getStyle()),i.isFinal()&&i.trigger("changeViewStyle",i.VIEW_STYLES.HOTEL_BY_CALENDAR)},"click [data-item='book']":function(){var e=this,i=e.options.rootState,a=i.getAllah({categoryid:e.model.get("id")});a&&i.trigger("addShoppingCart",a)},"click [data-item='sign']":function(){this.options.rootState.trigger("registerPayment")},"click @ui.voucher":function(){var e=this,i=e.model.toJSON(),a=e.options.rootState,t=a.getAllah({categoryid:i.id});if(t){var r=!t.voucherusage;a.changeRateValue({categoryid:t.categoryid,roomtypecode:t.roomtypecode,ratecode:t.ratecode,roomid:t.roomid,voucherusage:r}),r?(e.ui.voucherBox.addClass("checked"),e.ui.voucherTip.addClass("holds").delay(5e3).queue(function(){jQuery(this).removeClass("holds").dequeue()})):e.ui.voucherBox.removeClass("checked")}},"click @ui.otherRoom":function(){var e=jQuery(".book2-content-section").children(),i=e.has(this.el),a=null;if(i.length)for(a=i.next();a.length;){if(a.has(".x-radio[data-item='hand']").length)return void jQuery("html,body").animate({scrollTop:a.offset().top-13-71},200);a=a.next()}var t=e.has("[data-item='book']");t.length&&jQuery("html,body").animate({scrollTop:t.offset().top-13-71},200)},"click @ui.otherDate":function(e){e.stopPropagation();var i=this,a=i.options.rootState;a.trigger("expandCalendar")},"click @ui.displayChild":function(e){e.stopPropagation();var i=this,a=i.model.toJSON(),t=i.options.rootState,r=t.getAllah({categoryid:a.id});r&&(t.trigger("showLampBoxRate",r),t.trigger("lightBoxAnimate",i.ui.displayChild.offset()))},"click @ui.loyaltyroomupgrade_text":function(e){e.stopPropagation();var i=this,a=i.model.toJSON(),t=i.options.rootState,r=t.getAllah({categoryid:a.id});if(r){var n=!r.loyaltyroomupgradeusage,o=r.specialrequests||"",s=i18n.t("booking.loyalty_room_upgrade_special_requests");n?o&&0===o.indexOf(s)||(o=s+" "+o):o&&0===o.indexOf(s)&&(o=o.slice(s.length).replace(/^\s/,""));var l={categoryid:r.categoryid,roomtypecode:r.roomtypecode,ratecode:r.ratecode,roomid:r.roomid,loyaltyroomupgradeusage:n,specialrequests:o};t.changeRateValue(l),n?(i.ui.loyaltyroomupgrade_text.eq(0).addClass("checked-azure"),i.ui.loyaltyroomupgrade_icon.finish().trigger("mouseenter").delay(3e3).queue(function(){jQuery(this).trigger("mouseleave").dequeue()})):i.ui.loyaltyroomupgrade_text.eq(0).removeClass("checked-azure"),t.trigger("loyaltyRoomUpgrade",l)}},"mouseenter @ui.loyaltyroomupgrade_icon":function(e){e.stopPropagation(),b.addPopupTip(this,y.LOYALTYROOMUPGRADE,{},this.ui.loyaltyroomupgrade_icon)},"mouseleave @ui.loyaltyroomupgrade_icon":function(e){e.stopPropagation(),b.delPopupTip()},"click @ui.ss_link":function(){var e=window.mayfairFlag;if(e){var i=jQuery("body").attr("lang"),a="/bookings/?groupHotel=similar-hotels-in-london",t=window.location.protocol+"//"+window.location.host+"/"+i+a;h.redirect(t)}return!1},"click @ui.cityUrl":function(e){e=e||window.event,e.stopPropagation()}},getOccupancy:function(){var e=this,i=e.model.toJSON(),a=e.options.rootState,t=a.getAllah({categoryid:i.id}),r={},n=a.getMaxChildAge();return t&&(r.maxocc=n&&(t.maxocc||0),r.adultocc=n&&(t.adultocc||0),r.childocc=n&&(t.childocc||0),r.adults=x.range(t.adultocc||0),r.children=x.range(t.childocc||0)),r.maxchildage=n,r},getMember:function(){var e=this,i=e.model.toJSON(),a=e.options.rootState,t=a.getAllah({categoryid:i.id});return{isLogin:a.isLogin(),isUseMoney:a.isTrade(a.VIEW_TRADES.USE_MONEY),isUsePoint:a.isTrade(a.VIEW_TRADES.USE_POINT),currency:a.getCurrency(),complete:a.getComplete(),loyalty:a.getLoyalty(),pointssaved:t?parseFloat(t.pointssaved):parseFloat(i.price.pointssaved),ratesaved:t?parseFloat(t.ratesaved):parseFloat(i.price.ratesaved),vouchervisible:t&&t.vouchervisible}},getTipShort:function(){var e=this,i=e.model.toJSON(),a=e.options.rootState,t=a.getAllah({categoryid:i.id});return t;
},serializeData:function(){var e,i=this,a=i.model.toJSON(),f=i.options.rootState,h=f.getAllah({categoryid:a.id}),g=f.getHotel(),v=f.getParam(),y=(f.getSummary(),!1),b=h?parseFloat(h.pointssaved):parseFloat(a.price.pointssaved),w=h?parseFloat(h.ratesaved):parseFloat(a.price.ratesaved);h&&h.voucherusage&&(e=f.getUpgradeRateByRate({categoryid:h.categoryid,roomtypecode:h.roomtypecode,ratecode:h.ratecode,roomid:h.roomid}),e&&(h=e.roomrate||h,a=e.roomtype||a,b=e.roomrate.pointssaved,w=e.upgradeddifference.savedprice.avgtotal)),h&&!h.roomupgradeavailabled&&g.loyaltyroomupgradeenable&&(y=!0);var k=g.locationbookingurl;if(k){var S={},V=f.getParam();V.checkin&&(S.checkin=u(V.checkin).format(_)),V.checkout&&(S.checkout=u(V.checkout).format(_)),S=x.assign(S,{discountcode:V.discountcode||"",groupcode:V.groupcode||"",promocode:V.promocode||"",adults:V.adults||1,children:V.children||0,rooms:V.rooms||1,AAA:!(!V.isAmerican||!V.AAA),AARP:!(!V.isAmerican||!V.AARP),GOV:!(!V.isAmerican||!V.GOV),Accessible:!!V.Accessible}),k+=k.indexOf("?")>=0?"&"+jQuery.param(S):"?"+jQuery.param(S)}var P=f.getMaxChildAge(),R=P&&(h&&h.maxocc||"0"),C=P&&h&&h.adultocc,T=P&&h&&h.childocc,A=window.mayfairFlag,D=window.ismayfair,E=jQuery('[data-item="prev_text"]').html(),L=new Date(E).getTime(),I=new Date("30/June/2018 00:00:00").getTime(),M=function(){return I-L>0},B=f.getParam().rooms,O=a.NumberOfUnits,U=parseInt(B)>parseInt(O),z=window.CityHotelsCount,H=function(){var e="",i=null!=a.rategainresult,t=g.activatebeatthempmg,r=null!=a.rategainresult?a.rategainresult.status:!1;return i?("2"===r&&(e="PMG1_CRS lower"),"3"===r&&(e=t?"PMG3a_CRS higher and beat them":"PMG3b_CRS higher and match"),"4"===r&&(e=t?"PMG2a_CRS same and beat them":"PMG2b_CRS same and match"),"5"===r&&(e="PMG4_CRS much higher")):e="PMG5_Null",e};return{isLogin:f.isLogin(),enableslashprice:f.getHotel().enableslashprice&&f.isLogin(),isFinal:f.isFinal(),isManyDays:f.isManyDays(),isUseMoney:f.isTrade(f.VIEW_TRADES.USE_MONEY),isUsePoint:f.isTrade(f.VIEW_TRADES.USE_POINT),expandAll:h&&i.options.expandAll,openPopupView:i.options.openPopupView,maxchildage:P,currency:f.getCurrency(),restricted:h?h.roomstay&&h.roomstay.RatePlan&&h.roomstay.RatePlan.restricted:a.rateplan&&a.rateplan.restricted,complete:!(h?h.roomstay&&h.roomstay.RatePlan&&h.roomstay.RatePlan.restricted:a.rateplan&&a.rateplan.restricted)&&f.getComplete(),locationname:g.locationname,locationtitle:g.locationtitle,locationbookingurl:k,samecityhotelcount:g.samecityhotelcount-1,otheravailability:f.getRooms({availability:!0}).length,data:h,id:a.id,type:a.type,badgeicon:a.badgeicon,badgetitle:a.badgetitle,bedtypes:p(h&&!h.voucherusage?f.getRates({categoryid:a.id,ratecode:h.ratecode}):a.availability?a.bedtypes:[],i.options.expandAll?h||{}:{},f.getCurrency(),f.isTrade(f.VIEW_TRADES.USE_POINT)),amenities:m(a.amenities),roomsize:a.features.roomsize,image:h?(h.roomtypeimg||"").replace(/^#+/,"")||a.imageurl3||a.imageurl:a.imageurl3||a.imageurl,rate:s(h||a.price),points:l(h||a.price),memberrate:c(h||a.price),memberpoints:d(h||a.price),originrate:n(h||a.price),originpoints:o(h||a.price),priceCompared:t(h||a.price),PointsCompared:r(h||a.price),showDisCount:c(h||a.price)!=n(h||a.price),pointssaved:b,ratesaved:w,pointssavedformat:Handlebars.compile("{{num-format this}}")(h?parseFloat(h.pointssaved):parseFloat(a.price.pointssaved)),ratesavedformat:Handlebars.compile("{{price-format this}}")(h?parseFloat(h.ratesaved):parseFloat(a.price.ratesaved)),availability:h?!0:a.availability,vouchervisible:h&&h.roomupgradeavailabled,voucherusage:h&&h.voucherusage,upgradePoints:e&&e.upgradeddifference.avgtopprice.avgtoppoints,loyaltyroomupgradeenable:!1,loyaltyroomupgradeusage:h&&h.loyaltyroomupgradeusage,bestdeal:h&&h.badgetitle,maxocc:h&&R,adultocc:h&&C,childocc:h&&T,hasocc:!(!h||!C)||!(!h||!T),adults:x.range(h&&C||0),children:x.range(h&&T||0),pointsText:i18n.t("checkout.points"),hasRateCalendar:f.hasRateCalendar(),upgradeObject:e,mayfairFlag:A,mayfairDeadline:M(),isMayfair:D,cityHotelsCount:1>=z,calendarAndCity:i18n.t("booking.viewCalendar_and_otherCity").replace("{0}",k),pmg:H(),roomsOfUnits:U,ParamGroupCode:!(!v.groupcode||""===v.groupcode),roomtagline:a.roomtagline}},initialize:function(){var e=this.options.rootState;w.autoCreate(this),this.__renderDeferred=jQuery.Deferred(),this.listenTo(e,"redrawViewChild",this.redrawViewChild),this.listenTo(e,"changePartCount",this.changePartCount),this.listenTo(e,"turnUpgradeRate",this.changePartCount)},onRender:function(){var e=this;if(e.__renderDeferred.resolve(),e.options.rootState.glintUpdatedTip({code:this.model.get("id"),type:g},e),e.options.expandAll){if(v)return;e.ui.popup.eq(0).addClass("holds"),e.__timeout=setTimeout(function(){v=!0,e.__destroy||e.ui.popup.removeClass("holds")},3e3)}},onDestroy:function(){clearTimeout(this.__timeout),this.__destroy=!0},redrawViewChild:function(e){return this.__renderDeferred.then(jQuery.proxy(this.__redrawViewChild,this,e))},changePartCount:function(e){return this.__renderDeferred.then(jQuery.proxy(this.__changePartCount,this,e))},__redrawViewChild:function(){this.render()},__changePartCount:function(e){this.model.get("id")===e.categoryid&&this.render()}})},{"../../../../../../ui/util":2122,"../../../../../06-popping/view":343,"../../../../../common/popup":348,"../../../../../common/short":350,"./template.hbs":251,"backbone.marionette":6,moment:16,underscore:42}],251:[function(e,i,a){i.exports='{{#if expandAll}}\r\n    <div class="book2-child-block x-highlight-tlr">\r\n        <div class="book2-child-image x-fs-00 x-img x-img-top x-highlight-tl" style="background-image: url(\'{{image}}\')">\r\n			{{#unless noGallery}}\r\n		        <div class="book2-viewgallery shrink x-highlight-l">\r\n	                <span class="x-fs-16 x-di x-di-v-m x-fc-white x-pointer icon-icon_A004" data-item="look"></span>\r\n	                <span class="x-fs-14 x-di x-di-v-m x-fc-white x-pointer x-ml-06" data-item="look">{{local "booking.quick_look"}}</span>\r\n	            </div>\r\n            {{/unless}}\r\n        </div>\r\n        <div class="book2-child-theme x-fs-00 x-nowrap">\r\n            <div class="panel-1 x-di x-di-v-t x-normal">\r\n                <div>\r\n                    <h2 class="x-fs-24 x-di x-di-v-m x-lh-12 x-ff-wb">{{type}}</h2>\r\n                    {{#if amenities.length}}\r\n                        <span class="x-fs-18 x-di x-di-v-m x-ml-08 x-separator"></span>\r\n                        <span class="x-fs-18 x-di x-di-v-m x-ml-04"></span>\r\n                        {{#each amenities}}\r\n                            <span class="x-fs-18 x-di x-di-v-m x-ml-04 x-default x-popup {{fonticon}}" data-item="popup">\r\n                                <div class="x-popup-wrap x-fs-00">\r\n                                    <div class="x-popup-body x-fs-16 x-ff-sm x-nowrap" style="padding: 6px 10px">{{name}}</div>\r\n                                </div>\r\n                            </span>\r\n                        {{/each}}\r\n                    {{/if}}\r\n                </div>\r\n                {{#if badgetitle}}\r\n                    <div class="x-mt-08">\r\n                        <span class="x-fs-12 x-ff-mh x-lh-24 x-pl-08 x-pr-08 x-di x-di-v-t x-upper x-nowrap x-bc-peach x-fc-white">{{badgetitle}}</span>\r\n                    </div>\r\n                {{/if}}\r\n                {{#if roomtagline}}\r\n                    <div class="x-mt-08">\r\n                        <span class="x-fs-16 x-di x-di-v-m x-ff-sm x-fc-black x-normal">{{roomtagline}}</span>\r\n                    </div>\r\n                {{else}}\r\n                    {{#if roomsize}}\r\n                        <div class="x-mt-08 x-nowrap">\r\n                            <span class="x-fs-16 x-di x-di-v-m x-fc-black icon-icon_I016"></span>\r\n                            <span class="x-fs-16 x-di x-di-v-m x-ff-sm x-fc-black x-ml-06 x-normal">{{{specialSymbolFix roomsize}}}</span>\r\n                        </div>\r\n                    {{/if}}\r\n                    <div class="x-mt-08">\r\n                        {{#if adults.length}}\r\n                            {{#each adults}}\r\n                                <span class="x-fs-16 x-di x-di-v-m x-fc-black icon-icon_J013"></span>\r\n                            {{/each}}\r\n                            {{#equal adults.length 1}}\r\n                                <span class="x-fs-16 x-di x-di-v-m x-ff-sm x-ml-06">{{local "booking.adult"}}</span>\r\n                            {{else}}\r\n                                <span class="x-fs-16 x-di x-di-v-m x-ff-sm x-ml-06">{{local "booking.adults"}}</span>\r\n                            {{/equal}}\r\n                            <span class="x-di x-di-v-m x-ml-06"></span>\r\n                        {{/if}}\r\n                        {{#if children.length}}\r\n                            {{#each children}}\r\n                                <span class="x-fs-16 x-di x-di-v-m x-fc-black icon-icon_J012"></span>\r\n                            {{/each}}\r\n                            {{#equal children.length 1}}\r\n                                <span class="x-fs-16 x-di x-di-v-m x-ff-sm x-ml-06">{{local "booking.child"}}</span>\r\n                            {{else}}\r\n                                <span class="x-fs-16 x-di x-di-v-m x-ff-sm x-ml-06">{{local "booking.children"}}</span>\r\n                            {{/equal}}\r\n                        {{/if}}\r\n                        {{#if hasocc}}\r\n                            <span class="x-di x-di-v-m x-fs-16 x-ml-06 x-default x-popup icon-icon_B008" data-item="maxocc"></span>\r\n                        {{/if}}\r\n                    </div>     \r\n                {{/if}}\r\n\r\n                <div class="x-mt-08">\r\n                    {{#each bedtypes}}\r\n                        <div class="x-di x-di-v-t">\r\n                            {{#if highlight}}\r\n                                <div class="x-nowrap x-fc-azure">\r\n                                    <span class="x-fs-16 x-di x-di-v-m {{bedtypeicon}}"></span>\r\n                                    <span class="x-fs-16 x-di x-di-v-m x-ff-wm x-ml-06 x-under">{{bedtext}}</span>\r\n                                </div>\r\n                            {{else}}\r\n                                <div class="x-nowrap x-fc-black x-pointer" data-bed-type="{{bedtype}}" data-item="beds">\r\n                                    <span class="x-fs-16 x-di x-di-v-m {{bedtypeicon}}"></span>\r\n                                    <span class="x-fs-16 x-di x-di-v-m x-ff-sm x-ml-06 x-under">{{bedtext}}</span>\r\n                                </div>\r\n                            {{/if}}\r\n                            <div class="book2-updated-tip x-fs-12 x-mt-08 x-fc-green x-al-c" data-bed-type="{{bedtype}}">\r\n                                <span class="x-fs-16 x-di x-di-v-m icon-icon_I009"></span> {{local "booking.updated"}}\r\n                            </div>\r\n                        </div>\r\n                        <div class="x-di x-di-v-t x-ml-08"></div>\r\n                    {{/each}}\r\n                </div>\r\n                {{#if loyaltyroomupgradeenable}}\r\n                    <!--<div class="x-mt-18">-->\r\n                        <!--{{#if loyaltyroomupgradeusage}}-->\r\n                            <!--<span data-item="loyaltyroomupgrade_text" class="x-di x-di-v-m x-fs-16 x-pointer x-check x-check-sm checked-azure"></span>-->\r\n                        <!--{{else}}-->\r\n                            <!--<span data-item="loyaltyroomupgrade_text" class="x-di x-di-v-m x-fs-16 x-pointer x-check x-check-sm"></span>-->\r\n                        <!--{{/if}}-->\r\n                        <!--<span data-item="loyaltyroomupgrade_text" class="x-di x-di-v-m x-fs-16 x-fc-azure x-pointer x-pl-06 x-none">{{local "booking.use_upgrade_voucher"}}</span>-->\r\n                        <!--<span data-item="loyaltyroomupgrade_icon" class="x-di x-di-v-m x-fs-16 x-fc-azure x-default x-ml-06 icon-icon_B008"></span>-->\r\n                    <!--</div>-->\r\n                {{/if}}\r\n            </div>\r\n            <div class="panel-2 x-di x-di-v-t x-normal">\r\n                {{#if isFinal}}\r\n                    {{#if availability}}\r\n                        {{#if isUseMoney}}\r\n                            {{#if ratesaved}}\r\n                                {{#if isLogin}}\r\n                                    <span class="x-fs-16 x-di x-di-v-m x-ff-m7 x-fc-azure x-upper">{{local "booking.you_ve_saved"}} {{currency}} {{price-format ratesaved}}</span>\r\n                                    {{#if showDisCount}}\r\n                                        <span class="x-fs-16 x-di x-di-v-m x-ml-06 x-fc-azure x-default icon-icon_B008" data-item="member"></span>\r\n                                    {{/if}}\r\n                                {{else}}\r\n                                    {{#if complete}}\r\n                                        <span class="x-fs-16 x-di x-di-v-m x-ff-m7 x-upper x-through">{{local "booking.usual_price"}}: {{currency}} {{price-format rate}}</span>\r\n                                    {{else}}\r\n                                        <!--<span class="x-fs-16 x-di x-di-v-m x-ff-m7 x-upper">{{local "Property.members_pay"}}: {{currency}} {{price-format memberrate}}</span>-->\r\n                                        <span class="x-fs-16 x-di x-di-v-m x-ff-m7 x-upper">{{local "booking.members_save"}}: {{currency}} {{price-format ratesaved}}</span>\r\n                                    {{/if}}\r\n                                    <!--<span class="x-fs-16 x-di x-di-v-m x-ml-06 x-default icon-icon_B008" data-item="member"></span>-->\r\n                                    <div class="x-mt-04">\r\n                                            <span style="display: inline-block; max-width: 250px; line-height: 14px">\r\n                                                {{#if complete}}\r\n                                                    <span class="x-fs-14 x-fc-white x-bc-azure x-di-v-m x-mr-06 icon-icon_I009"></span>\r\n                                                    <span class="x-fs-12 x-ff-mm x-fw-none x-fc-azure x-di-v-m x-under">{{local "booking.complete_then_sign"}}</span>\r\n                                                {{else}}\r\n                                                    <span class="x-fs-12 x-ff-mm x-fw-none x-pointer x-fc-azure x-under" data-item="sign">{{local "booking.sign_up_to_pay" }}</span>\r\n                                                {{/if}}\r\n                                            </span>\r\n                                    </div>\r\n                                {{/if}}\r\n                                <div class="x-mt-08"></div>\r\n                            {{else}}\r\n                                {{#if restricted}}\r\n                                    <div class="x-fs-14 x-ff-sm x-italic x-fc-gray">{{local "booking.loyalty_discount_not_applicable"}}</div>\r\n                                    <div class="x-mt-08"></div>\r\n                                {{/if}}\r\n                            {{/if}}\r\n\r\n                            {{#if rate}}\r\n                                <div class="x-fs-00">\r\n                                    {{#if isLogin}}\r\n                                        <span class="x-fs-24 x-ff-wb x-upper x-di x-di-v-m">{{currency}} {{price-format memberrate}}</span>\r\n                                        {{#if upgradePoints}}\r\n                                            <span class="x-fs-24 x-ff-wb x-di x-di-v-m x-fc-peach x-ml-04 x-mr-04">+</span>\r\n                                            <span class="x-fs-24 x-ff-wb x-upper x-di x-di-v-m x-fc-peach">{{num-format upgradePoints}} PTS</span>\r\n                                        {{/if}}\r\n                                    {{else}}\r\n                                        {{#if complete}}\r\n                                            <span class="x-fs-24 x-ff-wb x-upper x-di x-di-v-m">{{currency}} {{price-format memberrate}}</span>\r\n                                        {{else}}\r\n                                            <span class="x-fs-24 x-ff-wb x-upper x-di x-di-v-m">{{currency}} {{price-format rate}}</span>\r\n                                        {{/if}}\r\n                                    {{/if}}\r\n                                </div>\r\n                                {{#if isManyDays}}\r\n                                    <div class="x-fs-16 x-ff-m7 x-upper x-mt-08">{{local "Property.avg_night"}}</div>\r\n                                {{else}}\r\n                                    <div class="x-fs-16 x-ff-m7 x-upper x-mt-08">{{local "general.avg_night"}}</div>\r\n                                {{/if}}\r\n                                {{#if enableslashprice}}\r\n                                    {{#if priceCompared}}\r\n                                        <span class="x-fs-24 x-upper x-di x-di-v-m x-mt-08" style="text-decoration: line-through;">{{currency}} {{price-format originrate}}</span>\r\n                                    {{/if}}\r\n                                {{/if}}\r\n                            {{/if}}\r\n                        {{/if}}\r\n                        {{#if isUsePoint}}\r\n                            {{#if pointssaved}}\r\n                                {{#if isLogin}}\r\n                                    <span class="x-fs-16 x-di x-di-v-m x-ff-m7 x-fc-azure x-upper">{{local "booking.you_ve_saved"}} {{num-format pointssaved}} {{local "checkout.points"}}</span>\r\n                                    {{#if showDisCount}}\r\n                                         <span class="x-fs-16 x-di x-di-v-m x-ml-06 x-fc-azure x-default icon-icon_B008" data-item="member"></span>\r\n                                    {{/if}}\r\n                                {{else}}\r\n                                    {{#if complete}}\r\n                                        <span class="x-fs-16 x-di x-di-v-m x-ff-m7 x-upper x-through">{{local "booking.usual_price"}}: {{num-format points}}</span>\r\n                                    {{else}}\r\n                                        <!--<span class="x-fs-16 x-di x-di-v-m x-ff-m7 x-upper">{{local "Property.members_pay"}}: {{num-format memberpoints}} {{local "checkout.points"}}</span>-->\r\n                                        <span class="x-fs-16 x-di x-di-v-m x-ff-m7 x-upper">{{local "booking.members_save"}}: {{num-format pointssaved}} {{local "checkout.points"}}</span>\r\n                                    {{/if}}\r\n                                    <!--<span class="x-fs-16 x-di x-di-v-m x-ml-06 x-default icon-icon_B008" data-item="member"></span>-->\r\n                                    <div class="x-mt-04">\r\n                                            <span style="display: inline-block; max-width: 250px; line-height: 14px">\r\n                                                {{#if complete}}\r\n                                                    <span class="x-fs-14 x-fc-white x-bc-azure x-di-v-m x-mr-06 icon-icon_I009"></span>\r\n                                                    <span class="x-fs-12 x-ff-mm x-fw-none x-fc-azure x-di-v-m x-under">{{local "booking.complete_then_sign"}}</span>\r\n                                                {{else}}\r\n                                                    <span class="x-fs-12 x-ff-mm x-fw-none x-pointer x-fc-azure x-under" data-item="sign">{{local "booking.sign_up_to_pay" }}</span>\r\n                                                {{/if}}\r\n                                            </span>\r\n                                    </div>\r\n                                {{/if}}\r\n                                <div class="x-mt-08"></div>\r\n                            {{else}}\r\n                                {{#if restricted}}\r\n                                    <div class="x-fs-14 x-ff-sm x-italic x-fc-gray">{{local "booking.loyalty_discount_not_applicable"}}</div>\r\n                                    <div class="x-mt-08"></div>\r\n                                {{/if}}\r\n                            {{/if}}\r\n                            {{#if points}}\r\n                                <div class="x-fs-00">\r\n                                    {{#if isLogin}}\r\n                                        {{#if upgradePoints}}\r\n                                            <span class="x-fs-24 x-ff-wb x-upper x-di x-di-v-m">{{num-format memberpoints}}</span>\r\n                                            <span class="x-fs-24 x-ff-wb x-di x-di-v-m x-fc-peach x-ml-04 x-mr-04">+</span>\r\n                                            <span class="x-fs-24 x-ff-wb x-upper x-di x-di-v-m x-fc-peach">{{num-format upgradePoints}} PTS</span>\r\n                                        {{else}}\r\n                                            <span class="x-fs-24 x-ff-wb x-upper x-di x-di-v-m">{{num-format memberpoints}} {{local \'account.points\'}}</span>\r\n                                        {{/if}}\r\n                                    {{else}}\r\n                                        {{#if complete}}\r\n                                            <span class="x-fs-24 x-ff-wb x-upper x-di x-di-v-m">{{num-format memberpoints}} {{local \'account.points\'}}</span>\r\n                                        {{else}}\r\n                                            <span class="x-fs-24 x-ff-wb x-upper x-di x-di-v-m">{{num-format points}} {{local \'account.points\'}}</span>\r\n                                        {{/if}}\r\n                                    {{/if}}\r\n                                </div>\r\n                                {{#if isManyDays}}\r\n                                    <div class="x-fs-16 x-ff-m7 x-upper x-mt-08">{{local "Property.avg_night"}}</div>\r\n                                {{else}}\r\n                                    <div class="x-fs-16 x-ff-m7 x-upper x-mt-08">{{local "general.avg_night"}}</div>\r\n                                {{/if}}\r\n                                {{#if enableslashprice}}\r\n                                    {{#if PointsCompared}}\r\n                                        <span class="x-fs-24 x-upper x-di x-di-v-m x-mt-08" style="text-decoration: line-through;">{{num-format originpoints}} {{local \'account.points\'}}</span>\r\n                                    {{/if}}\r\n                                {{/if}}\r\n                            {{/if}}\r\n                        {{/if}}\r\n                        <div style="max-height: 38px">\r\n                            <div class="x-mt-20">\r\n                                <span class="x-fs-15 x-di x-di-v-m x-ff-mh x-fc-azure x-upper x-default">{{local "booking.room_and_rate_selected"}}</span>\r\n                                <span class="x-fs-32 x-di x-di-v-m x-radio x-fc-azure x-ml-08 x-default checked"></span>\r\n                            </div>\r\n                            <div class="x-mt-20 {{#if roomsOfUnits}}x2-disable{{/if}}">\r\n                                    <button type="button" data-pmg="{{pmg}}" class="x-fs-14 x-ff-mh x-btn x-btn-azure" data-item="book">{{local "booking.checkout"}}</button>\r\n                            </div>\r\n                            {{#if data.priceratio.list.length}}\r\n                                <div class="x-mt-13 x-di x-al-l" style="width: 200px; font-size: 10px; opacity: .6">\r\n                                    <span class="x-al-l x-di x-full" data-pmg="{{pmg}}">\r\n                                        <div class="x-fs-15 x-ff-m7 x-fc-green x-upper">{{data.priceratio.title}}</div>\r\n                                        <div class="x-fs-00 x-mt-10 x-nowrap x-flex">\r\n                                            <div class="x-di x-di-v-t x-cell" style="width: 68%;">\r\n                                                {{#each data.priceratio.list}}\r\n                                                    <div class="x-ff-sm x-lh-15 x-fs-13">{{website}}</div>\r\n                                                {{/each}}\r\n                                            </div>\r\n                                            <div class="x-di x-di-v-t x-cell">\r\n                                                {{#each data.priceratio.list}}\r\n                                                    <div class="x-ff-sm x-lh-15 x-fs-13">{{currency}} {{price-format price}}</div>\r\n                                                {{/each}}\r\n                                            </div>\r\n                                        </div>\r\n                                        {{#if data.priceratio.rategainDisclaimer}}\r\n                                            <div class="x-fs-14 x-ff-sm x-mt-10 x-italic">{{data.priceratio.rategainDisclaimer}}</div>\r\n                                        {{/if}}\r\n                                    </span>\r\n                                </div>\r\n                            {{/if}}\r\n                        </div>\r\n                    {{else}}\r\n                        <div class="x-fs-16 x-lh-22 x-fc-black x-mt-45">\r\n                            <span style="display: inline-block; max-width: 250px; line-height: 2.2rem">\r\n                                {{#if hasRateCalendar}}\r\n                                    {{#if isMayfair}}\r\n                                        {{#if mayfairDeadline}}\r\n                                            <span class="x-sd-tip" data-item="s-rate-calendar">{{local \'booking.sold_out_for_calendar\'}}</span>\r\n                                            <!--MHS-2663-->\r\n                                            {{#if cityHotelsCount}}\r\n                                                 <span class="x-rc-tip" data-item="s-rate-calendar">{{local \'booking.view_dates_by_calendar\'}}</span>\r\n                                            {{else}}\r\n                                                 <span class="x-rc-tip" data-item="s-rate-calendar">{{{calendarAndCity}}}</span>\r\n                                            {{/if}}\r\n                                        {{else}}\r\n                                            {{#if mayfairFlag}}\r\n                                                <span class="x-rc-tip" data-item="s-rate-calendar">{{local \'booking.renovating_prompt\'}}<a data-btn="ss_link">{{local \'booking.see_similar_link\'}}</a></span>\r\n                                            {{else}}\r\n                                                <span class="x-rc-tip" data-item="s-rate-calendar">{{local \'booking.renovating_prompt\'}}<a data-btn="ss_link" style="color:black; text-decoration: none; cursor: initial;">{{local \'booking.see_similar_link\'}}</a></span>\r\n                                            {{/if}}\r\n                                        {{/if}}\r\n                                    {{else}}\r\n                                        <span class="x-sd-tip" data-item="s-rate-calendar">{{local \'booking.sold_out_for_calendar\'}}</span>\r\n                                        <!--MHS-2663-->\r\n                                        {{#if cityHotelsCount}}\r\n                                            <span class="x-rc-tip" data-item="s-rate-calendar">{{local \'booking.view_dates_by_calendar\'}}</span>\r\n                                        {{else}}\r\n                                            <span class="x-rc-tip" data-item="s-rate-calendar">{{{calendarAndCity}}}</span>\r\n                                        {{/if}}\r\n                                    {{/if}}\r\n                                {{else}}\r\n                                    {{#if otheravailability}}\r\n                                        {{#if samecityhotelcount}}\r\n                                            {{#if isMayfair}}\r\n                                                {{#if mayfairDeadline}}\r\n                                                    {{local "booking.missed_the_last_room"}} {{local "general.explore"}} <a class="x-link x-fc-azure x-pointer x-under" href="javascript:void(0)" data-item="other-room">{{local "booking.other_rooms"}}</a> {{local "globalsearch.link_or"}} <a class="x-link x-fc-azure x-pointer x-under" target="_self" href="{{locationbookingurl}}" target="_self">{{local "booking.other_hotels" locationname}}</a>\r\n                                                {{else}}\r\n                                                    {{#if mayfairFlag}}\r\n                                                        <span class="x-rc-tip" data-item="s-rate-calendar">{{local \'booking.renovating_prompt\'}}<a data-btn="ss_link">{{local \'booking.see_similar_link\'}}</a></span>\r\n                                                    {{else}}\r\n                                                        <span class="x-rc-tip" data-item="s-rate-calendar">{{local \'booking.renovating_prompt\'}}<a data-btn="ss_link" style="color:black; text-decoration: none; cursor: initial;">{{local \'booking.see_similar_link\'}}</a></span>\r\n                                                    {{/if}}\r\n                                                {{/if}}\r\n                                            {{else}}\r\n                                                {{#if ParamGroupCode}}\r\n                                                    {{local "booking.no_rooms_available_for_groupcode"}}\r\n                                                {{else}}\r\n                                                    {{local "booking.missed_the_last_room"}} {{local "general.explore"}} <a class="x-link x-fc-azure x-pointer x-under" href="javascript:void(0)" data-item="other-room">{{local "booking.other_rooms"}}</a> {{local "globalsearch.link_or"}} <a class="x-link x-fc-azure x-pointer x-under" target="_self" href="{{locationbookingurl}}" target="_self">{{local "booking.other_hotels" locationname}}</a>\r\n                                                {{/if}}\r\n                                            {{/if}}\r\n                                        {{else}}\r\n                                            {{#if isMayfair}}\r\n                                                {{#if mayfairDeadline}}\r\n                                                    {{local "booking.missed_the_last_room"}} {{local "general.explore"}} <a class="x-link x-fc-azure x-pointer x-under" href="javascript:void(0)" data-item="other-room">{{local "booking.other_rooms"}}</a>\r\n                                                {{else}}\r\n                                                    {{#if mayfairFlag}}\r\n                                                        <span class="x-rc-tip" data-item="s-rate-calendar">{{local \'booking.renovating_prompt\'}}<a data-btn="ss_link">{{local \'booking.see_similar_link\'}}</a></span>\r\n                                                    {{else}}\r\n                                                        <span class="x-rc-tip" data-item="s-rate-calendar">{{local \'booking.renovating_prompt\'}}<a data-btn="ss_link" style="color:black; text-decoration: none; cursor: initial;">{{local \'booking.see_similar_link\'}}</a></span>\r\n                                                    {{/if}}\r\n                                                {{/if}}\r\n                                            {{else}}\r\n                                                {{#if ParamGroupCode}}\r\n                                                    {{local "booking.no_rooms_available_for_groupcode"}}\r\n                                                {{else}}\r\n                                                    {{local "booking.missed_the_last_room"}} {{local "general.explore"}} <a class="x-link x-fc-azure x-pointer x-under" href="javascript:void(0)" data-item="other-room">{{local "booking.other_rooms"}}</a>\r\n                                                {{/if}}\r\n                                            {{/if}}\r\n                                        {{/if}}\r\n                                    {{else}}\r\n                                        {{#if samecityhotelcount}}\r\n                                            {{#if isMayfair}}\r\n                                                {{#if mayfairDeadline}}\r\n                                                    {{local "booking.missed_the_last_room"}} {{local "general.explore"}} <a class="x-link x-fc-azure x-pointer x-under" href="{{locationbookingurl}}" target="_self">{{local "booking.other_hotels" locationname}}</a>\r\n                                                {{else}}\r\n                                                    {{#if mayfairFlag}}\r\n                                                        <span class="x-rc-tip" data-item="s-rate-calendar">{{local \'booking.renovating_prompt\'}}<a data-btn="ss_link">{{local \'booking.see_similar_link\'}}</a></span>\r\n                                                    {{else}}\r\n                                                        <span class="x-rc-tip" data-item="s-rate-calendar">{{local \'booking.renovating_prompt\'}}<a data-btn="ss_link" style="color:black; text-decoration: none; cursor: initial;">{{local \'booking.see_similar_link\'}}</a></span>\r\n                                                    {{/if}}\r\n                                                {{/if}}\r\n                                            {{else}}\r\n                                                {{#if ParamGroupCode}}\r\n                                                    {{local "booking.no_rooms_available_for_groupcode"}}\r\n                                                {{else}}\r\n                                                    {{local "booking.missed_the_last_room"}} {{local "general.explore"}} <a class="x-link x-fc-azure x-pointer x-under" href="{{locationbookingurl}}" target="_self">{{local "booking.other_hotels" locationname}}</a>\r\n                                                {{/if}}\r\n                                            {{/if}}\r\n                                        {{else}}\r\n                                            {{#if isMayfair}}\r\n                                                {{#if mayfairDeadline}}\r\n                                                    {{local "booking.missed_the_last_room"}} {{local "general.explore"}} <a class="x-link x-fc-azure x-pointer x-under" href="javascript:void(0)" data-item="other-date">{{local "booking.other_dates"}}</a>\r\n                                                {{else}}\r\n                                                    {{#if mayfairFlag}}\r\n                                                        <span class="x-rc-tip" data-item="s-rate-calendar">{{local \'booking.renovating_prompt\'}}<a data-btn="ss_link">{{local \'booking.see_similar_link\'}}</a></span>\r\n                                                    {{else}}\r\n                                                        <span class="x-rc-tip" data-item="s-rate-calendar">{{local \'booking.renovating_prompt\'}}<a data-btn="ss_link" style="color:black; text-decoration: none; cursor: initial;">{{local \'booking.see_similar_link\'}}</a></span>\r\n                                                    {{/if}}\r\n                                                {{/if}}\r\n                                            {{else}}\r\n                                                {{#if ParamGroupCode}}\r\n                                                    {{local "booking.no_rooms_available_for_groupcode"}}\r\n                                                {{else}}\r\n                                                    {{local "booking.missed_the_last_room"}} {{local "general.explore"}} <a class="x-link x-fc-azure x-pointer x-under" href="javascript:void(0)" data-item="other-date">{{local "booking.other_dates"}}</a>\r\n                                                {{/if}}\r\n                                            {{/if}}\r\n                                        {{/if}}\r\n                                    {{/if}}\r\n                                {{/if}}\r\n                            </span>\r\n                        </div>\r\n                    {{/if}}\r\n                {{else}}\r\n                    <div class="x-mt-36">\r\n                        <span class="x-di x-di-v-m"><img class="x-load x-load-sm" src="/assets/img/card/Preloader3.2_RedIcon_300px.gif" alt="{{local "form.loading"}}"></span>\r\n                        <span class="x-di x-di-v-m x-fs-14">{{local "booking.price_loading"}}</span>\r\n                    </div>\r\n                {{/if}}\r\n            </div>\r\n        </div>\r\n    </div>\r\n    <div class="x-pt-20 x-highlight-lr">\r\n        <div class="x-ml-20 x-mr-20">\r\n            <div class="x-pt-13 x-pb-13" style="position: relative; z-index: 1; width: calc(100% - 285px);">\r\n                <div class="x-flex">\r\n                    <span class="x-cell x-al-l x-ff-mh x-fs-18 x-upper">{{local "booking.selected_rate"}}</span>\r\n                    <span class="x-cell x-al-r x-ff-sm x-fs-18">\r\n                        <span class="x-fc-azure x-pointer x-delta right" data-item="displayChild">{{ local "booking.view_all_rates" }}</span>\r\n                    </span>\r\n                </div>\r\n            </div>\r\n            <div class="book2-short-block x-top-line x-pt-20">\r\n                <div class="x-level">\r\n                    <!--<div class="book2-short-image x-fs-00 x-img x-img-top x-highlight-l" style="display:none;background-image: url(\'{{data.image}}\')"></div>-->\r\n                    <div >\r\n                        <div>\r\n                            <h2 class="x-fs-24 x-di x-di-v-m x-lh-12 x-ff-wb">{{data.ratename}}</h2>\r\n                            {{#if bestdeal}}\r\n                                <span class="x-ff-mh x-fs-12 x-lh-24 x-pl-08 x-pr-08 x-di x-di-v-m x-upper x-nowrap x-bc-peach x-fc-white x-ml-08">{{ bestdeal }}</span>\r\n                            {{/if}}\r\n                        </div>\r\n                        <div class="x-mt-16">\r\n                            {{#if data.roomstay.RatePlan.paymentType}}\r\n                                <span class="x-fs-16 x-ff-m7 x-di x-di-v-m x-upper" style="color: #202020; letter-spacing: 1px">{{local "booking.pay_now_and_save"}}</span>\r\n                            {{else}}\r\n                                <span class="x-fs-16 x-ff-m7 x-di x-di-v-m x-upper" style="color: #202020; letter-spacing: 1px">{{local "booking.book_now_and_pay_later"}}</span>\r\n                            {{/if}}\r\n                            <!--<span class="x-di x-di-v-m x-fs-16 x-ml-06 x-pointer icon-icon_B008" data-item="short"></span>-->\r\n                        </div>\r\n                        <div class="x-mt-16">\r\n                            <div class="x-fs-16 x-ff-sm x-lh-24">{{data.desc}}</div>\r\n                            <div data-line="5" class="x-mt-08 x-fs-14 x-ff-sm x-lh-22 book2-information x-short">{{{data.tipshort}}}</div>\r\n                        </div>\r\n                        <div class="x-mt-13 x-pb-13">\r\n                            <span class="x-fs-14 x-di x-di-v-m x-ff-mm x-fc-azure x-default x-under" data-item="short-p">{{local "booking.view_guarantee_and_cancellation_policy"}}</span>\r\n                            <span class="x-fs-16 x-di x-di-v-m x-ml-06 x-fc-azure x-default icon-icon_B008" data-item="short"></span>\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n        </div>\r\n    </div>\r\n{{else}}\r\n    <div class="book2-child-block x-highlight-all">\r\n        {{#if availability}}\r\n            <div class="book2-child-image x-fs-00 x-img x-img-top x-highlight-tlb x-pointer" data-item="hand" style="background-image: url(\'{{image}}\')">\r\n				{{#unless noGallery}}\r\n	                <div class="book2-viewgallery shrink x-highlight-lb">\r\n	                    <span class="x-fs-16 x-di x-di-v-m x-fc-white x-pointer icon-icon_A004" data-item="look"></span>\r\n	                    <span class="x-fs-14 x-di x-di-v-m x-fc-white x-pointer x-ml-06" data-item="look">{{local "booking.quick_look"}}</span>\r\n	                </div>\r\n                {{/unless}}\r\n            </div>\r\n            <div class="book2-child-theme x-fs-00 x-nowrap">\r\n                <div class="panel-1 x-di x-di-v-t x-normal">\r\n                    <div>\r\n                        <h2 class="x-fs-24 x-di x-di-v-m x-lh-12 x-ff-wb x-pointer" data-item="hand">{{type}}</h2>\r\n                        {{#if amenities.length}}\r\n                            <span class="x-fs-18 x-di x-di-v-m x-ml-08 x-separator"></span>\r\n                            <span class="x-fs-18 x-di x-di-v-m x-ml-04"></span>\r\n                            {{#each amenities}}\r\n                                <span class="x-fs-18 x-di x-di-v-m x-ml-04 x-default x-popup {{fonticon}}" data-item="popup">\r\n                                <div class="x-popup-wrap x-fs-00">\r\n                                    <div class="x-popup-body x-fs-16 x-ff-sm x-nowrap" style="padding: 6px 10px">{{name}}</div>\r\n                                </div>\r\n                            </span>\r\n                            {{/each}}\r\n                        {{/if}}\r\n                    </div>\r\n                    {{#if badgetitle}}\r\n                        <div class="x-mt-08">\r\n                            <span class="x-fs-12 x-ff-mh x-lh-24 x-pl-08 x-pr-08 x-di x-di-v-t x-upper x-nowrap x-bc-peach x-fc-white">{{badgetitle}}</span>\r\n                        </div>\r\n                    {{/if}}\r\n                    {{#if roomtagline}}\r\n                        <div class="x-mt-08">\r\n                            <span class="x-fs-16 x-di x-di-v-m x-ff-sm x-fc-black x-normal">{{roomtagline}}</span>\r\n                        </div>\r\n                    {{else}}\r\n                        {{#if roomsize}}\r\n                            <div class="x-mt-08 x-nowrap">\r\n                                <span class="x-fs-16 x-di x-di-v-m x-fc-black icon-icon_I016"></span>\r\n                                <span class="x-fs-16 x-di x-di-v-m x-ff-sm x-fc-black x-ml-06 x-normal">{{{specialSymbolFix roomsize}}}</span>\r\n                            </div>\r\n                        {{/if}}\r\n                        <div class="x-mt-08">\r\n                            {{#if adults.length}}\r\n                                {{#each adults}}\r\n                                    <span class="x-fs-16 x-di x-di-v-m x-fc-black icon-icon_J013"></span>\r\n                                {{/each}}\r\n                                {{#equal adults.length 1}}\r\n                                    <span class="x-fs-16 x-di x-di-v-m x-ff-sm x-ml-06">{{local "booking.adult"}}</span>\r\n                                {{else}}\r\n                                    <span class="x-fs-16 x-di x-di-v-m x-ff-sm x-ml-06">{{local "booking.adults"}}</span>\r\n                                {{/equal}}\r\n                                <span class="x-di x-di-v-m x-ml-06"></span>\r\n                            {{/if}}\r\n                            {{#if children.length}}\r\n                                {{#each children}}\r\n                                    <span class="x-fs-16 x-di x-di-v-m x-fc-black icon-icon_J012"></span>\r\n                                {{/each}}\r\n                                {{#equal children.length 1}}\r\n                                    <span class="x-fs-16 x-di x-di-v-m x-ff-sm x-ml-06">{{local "booking.child"}}</span>\r\n                                {{else}}\r\n                                    <span class="x-fs-16 x-di x-di-v-m x-ff-sm x-ml-06">{{local "booking.children"}}</span>\r\n                                {{/equal}}\r\n                            {{/if}}\r\n                            {{#if hasocc}}\r\n                                <span class="x-di x-di-v-m x-fs-16 x-ml-06 x-default x-popup icon-icon_B008" data-item="maxocc"></span>\r\n                            {{/if}}\r\n                        </div>\r\n                    {{/if}}\r\n\r\n                    <div class="x-mt-08">\r\n                        {{#each bedtypes}}\r\n                            <div class="x-di x-di-v-t">\r\n                                {{#if highlight}}\r\n                                    <div class="x-nowrap x-fc-azure">\r\n                                        <span class="x-fs-16 x-di x-di-v-m {{bedtypeicon}}"></span>\r\n                                        <span class="x-fs-16 x-di x-di-v-m x-ff-wm x-ml-06 x-under">{{bedtext}}</span>\r\n                                    </div>\r\n                                {{else}}\r\n                                    <div class="x-nowrap x-fc-black x-pointer" data-bed-type="{{bedtype}}" data-item="beds">\r\n                                        <span class="x-fs-16 x-di x-di-v-m {{bedtypeicon}}"></span>\r\n                                        <span class="x-fs-16 x-di x-di-v-m x-ff-sm x-ml-06 x-under">{{bedtext}}</span>\r\n                                    </div>\r\n                                {{/if}}\r\n                                <div class="book2-updated-tip x-fs-12 x-mt-08 x-fc-green x-al-c" data-bed-type="{{bedtype}}">\r\n                                    <span class="x-fs-16 x-di x-di-v-m icon-icon_I009"></span> {{local "booking.updated"}}\r\n                                </div>\r\n                            </div>\r\n                            <div class="x-di x-di-v-t x-ml-08"></div>\r\n                        {{/each}}\r\n                    </div>\r\n                </div>\r\n                <div class="panel-2 x-di x-di-v-t x-normal">\r\n                    {{#if isFinal}}\r\n                        {{#if isUseMoney}}\r\n                            {{#if ratesaved}}\r\n                                {{#if isLogin}}\r\n                                    <span class="x-fs-16 x-di x-di-v-m x-ff-m7 x-fc-azure x-upper">{{local "booking.you_ve_saved"}} {{currency}} {{price-format ratesaved}}</span>\r\n                                    {{#if showDisCount}}\r\n                                         <span class="x-fs-16 x-di x-di-v-m x-ml-06 x-fc-azure x-default icon-icon_B008" data-item="member"></span>\r\n                                    {{/if}}\r\n                                {{else}}\r\n                                    {{#if complete}}\r\n                                        <span class="x-fs-16 x-di x-di-v-m x-ff-m7 x-upper x-through">{{local "booking.usual_price"}}: {{currency}} {{price-format rate}}</span>\r\n                                    {{else}}\r\n                                        <!--<span class="x-fs-16 x-di x-di-v-m x-ff-m7 x-upper">{{local "Property.members_pay"}}: {{currency}} {{price-format memberrate}}</span>-->\r\n                                        <span class="x-fs-16 x-di x-di-v-m x-ff-m7 x-upper">{{local "booking.members_save"}}: {{currency}} {{price-format ratesaved}}</span>\r\n                                    {{/if}}\r\n                                    <!--<span class="x-fs-16 x-di x-di-v-m x-ml-06 x-default icon-icon_B008" data-item="member"></span>-->\r\n                                    <div class="x-mt-04">\r\n                                            <span style="display: inline-block; max-width: 250px; line-height: 14px">\r\n                                                {{#if complete}}\r\n                                                    <span class="x-fs-14 x-fc-white x-bc-azure x-di-v-m x-mr-06 icon-icon_I009"></span>\r\n                                            <span class="x-fs-12 x-ff-mm x-fw-none x-fc-azure x-di-v-m x-under">{{local "booking.complete_then_sign"}}</span>\r\n                                                {{else}}\r\n                                                    <span class="x-fs-12 x-ff-mm x-fw-none x-pointer x-fc-azure x-under" data-item="sign">{{local "booking.sign_up_to_pay" }}</span>\r\n                                                {{/if}}\r\n                                            </span>\r\n                                    </div>\r\n                                {{/if}}\r\n                                <div class="x-mt-08"></div>\r\n                            {{else}}\r\n                                {{#if restricted}}\r\n                                    <div class="x-fs-14 x-ff-sm x-italic x-fc-gray">{{local "booking.loyalty_discount_not_applicable"}}</div>\r\n                                    <div class="x-mt-08"></div>\r\n                                {{/if}}\r\n                            {{/if}}\r\n                            {{#if rate}}\r\n                                <div class="x-fs-00">\r\n                                    {{#if isLogin}}\r\n                                        <span class="x-fs-24 x-ff-wb x-upper x-di x-di-v-m">{{currency}} {{price-format memberrate}}</span>\r\n                                        {{#if upgradePoints}}\r\n                                            <span class="x-fs-24 x-ff-wb x-di x-di-v-m x-fc-peach x-ml-04 x-mr-04">+</span>\r\n                                            <span class="x-fs-24 x-ff-wb x-upper x-di x-di-v-m x-fc-peach">{{num-format upgradePoints}} PTS</span>\r\n                                        {{/if}}\r\n                                    {{else}}\r\n                                        {{#if complete}}\r\n                                            <span class="x-fs-24 x-ff-wb x-upper x-di x-di-v-m">{{currency}} {{price-format memberrate}}</span>\r\n                                        {{else}}\r\n                                            <span class="x-fs-24 x-ff-wb x-upper x-di x-di-v-m">{{currency}} {{price-format rate}}</span>\r\n                                        {{/if}}\r\n                                    {{/if}}\r\n                                </div>\r\n                                {{#if isManyDays}}\r\n                                    <div class="x-fs-16 x-ff-m7 x-upper x-mt-08">{{local "Property.avg_night"}}</div>\r\n                                {{else}}\r\n                                    <div class="x-fs-16 x-ff-m7 x-upper x-mt-08">{{local "general.avg_night"}}</div>\r\n                                {{/if}}\r\n                                {{#if enableslashprice}}\r\n                                    {{#if priceCompared}}\r\n                                        <span class="x-fs-24 x-upper x-di x-di-v-m x-mt-08" style="text-decoration: line-through;">{{currency}} {{price-format originrate}}</span>\r\n                                    {{/if}}\r\n                                {{/if}}\r\n                            {{/if}}\r\n                        {{/if}}\r\n                        {{#if isUsePoint}}\r\n                            {{#if pointssaved}}\r\n                                {{#if isLogin}}\r\n                                    <span class="x-fs-16 x-di x-di-v-m x-ff-m7 x-fc-azure x-upper">{{local "booking.you_ve_saved"}} {{num-format pointssaved}} {{local "checkout.points"}}</span>\r\n                                    {{#if showDisCount}}\r\n                                        <span class="x-fs-16 x-di x-di-v-m x-ml-06 x-fc-azure x-default icon-icon_B008" data-item="member"></span>\r\n                                    {{/if}}\r\n                                {{else}}\r\n                                    {{#if complete}}\r\n                                        <span class="x-fs-16 x-di x-di-v-m x-ff-m7 x-upper x-through">{{local "booking.usual_price"}}: {{num-format points}}</span>\r\n                                    {{else}}\r\n                                        <!--<span class="x-fs-16 x-di x-di-v-m x-ff-m7 x-upper">{{local "Property.members_pay"}}: {{num-format memberpoints}} {{local "checkout.points"}}</span>-->\r\n                                        <span class="x-fs-16 x-di x-di-v-m x-ff-m7 x-upper">{{local "booking.members_save"}}: {{num-format pointssaved}} {{local "checkout.points"}}</span>\r\n                                    {{/if}}\r\n                                    <!--<span class="x-fs-16 x-di x-di-v-m x-ml-06 x-default icon-icon_B008" data-item="member"></span>-->\r\n                                    <div class="x-mt-04">\r\n                                            <span style="display: inline-block; max-width: 250px; line-height: 14px">\r\n                                                {{#if complete}}\r\n                                                    <span class="x-fs-14 x-fc-white x-bc-azure x-di-v-m x-mr-06 icon-icon_I009"></span>\r\n                                            <span class="x-fs-12 x-ff-mm x-fw-none x-fc-azure x-di-v-m x-under">{{local "booking.complete_then_sign"}}</span>\r\n                                                {{else}}\r\n                                                    <span class="x-fs-12 x-ff-mm x-fw-none x-pointer x-fc-azure x-under" data-item="sign">{{local "booking.sign_up_to_pay" }}</span>\r\n                                                {{/if}}\r\n                                            </span>\r\n                                    </div>\r\n                                {{/if}}\r\n                                <div class="x-mt-08"></div>\r\n                            {{else}}\r\n                                {{#if restricted}}\r\n                                    <div class="x-fs-14 x-ff-sm x-italic x-fc-gray">{{local "booking.loyalty_discount_not_applicable"}}</div>\r\n                                    <div class="x-mt-08"></div>\r\n                                {{/if}}\r\n                            {{/if}}\r\n                            {{#if points}}\r\n                                <div class="x-fs-00">\r\n                                    {{#if isLogin}}\r\n                                        {{#if upgradePoints}}\r\n                                            <span class="x-fs-24 x-ff-wb x-upper x-di x-di-v-m">{{num-format memberpoints}}</span>\r\n                                            <span class="x-fs-24 x-ff-wb x-di x-di-v-m x-fc-peach x-ml-04 x-mr-04">+</span>\r\n                                            <span class="x-fs-24 x-ff-wb x-upper x-di x-di-v-m x-fc-peach">{{num-format upgradePoints}} PTS</span>\r\n                                        {{else}}\r\n                                            <span class="x-fs-24 x-ff-wb x-upper x-di x-di-v-m">{{num-format memberpoints}} {{local \'account.points\'}}</span>\r\n                                        {{/if}}\r\n                                    {{else}}\r\n                                        {{#if complete}}\r\n                                            <span class="x-fs-24 x-ff-wb x-upper x-di x-di-v-m">{{num-format memberpoints}} {{local \'account.points\'}}</span>\r\n                                        {{else}}\r\n                                            <span class="x-fs-24 x-ff-wb x-upper x-di x-di-v-m">{{num-format points}} {{local \'account.points\'}}</span>\r\n                                        {{/if}}\r\n                                    {{/if}}\r\n                                </div>\r\n                                {{#if isManyDays}}\r\n                                    <div class="x-fs-16 x-ff-m7 x-upper x-mt-08">{{local "Property.avg_night"}}</div>\r\n                                {{else}}\r\n                                    <div class="x-fs-16 x-ff-m7 x-upper x-mt-08">{{local "general.avg_night"}}</div>\r\n                                {{/if}}\r\n                                {{#if enableslashprice}}\r\n                                    {{#if PointsCompared}}\r\n                                        <span class="x-fs-24 x-upper x-di x-di-v-m x-mt-08" style="text-decoration: line-through;">{{num-format originpoints}} {{local \'account.points\'}}</span>\r\n                                    {{/if}}\r\n                                {{/if}}\r\n                            {{/if}}\r\n                        {{/if}}\r\n                        <div style="max-height: 38px">\r\n                            <div class="x-mt-20">\r\n                                <span class="x-fs-15 x-di x-di-v-m x-ff-mh x-fc-azure x-upper x-default">{{local "booking.select_this_room"}}</span>\r\n                                <span class="x-fs-32 x-di x-di-v-m x-radio x-fc-azure x-ml-08 x-pointer" data-item="hand"></span>\r\n                            </div>\r\n                        </div>\r\n                    {{else}}\r\n                        <div class="x-mt-36">\r\n                            <span class="x-di x-di-v-m"><img class="x-load x-load-sm" src="/assets/img/card/Preloader3.2_RedIcon_300px.gif" alt="{{local "form.loading"}}"></span>\r\n                            <span class="x-di x-di-v-m x-fs-14">{{local "booking.price_loading"}}</span>\r\n                        </div>\r\n                    {{/if}}\r\n                </div>\r\n            </div>\r\n        {{else}}\r\n            <div class="book2-child-image x-fs-00 x-img x-img-top x-highlight-tlb" style="background-image: url(\'{{image}}\')">\r\n				{{#unless noGallery}}\r\n	                <div class="book2-viewgallery shrink x-highlight-lb">\r\n	                    <span class="x-fs-16 x-di x-di-v-m x-fc-white x-pointer icon-icon_A004" data-item="look"></span>\r\n	                    <span class="x-fs-14 x-di x-di-v-m x-fc-white x-pointer x-ml-06" data-item="look">{{local "booking.quick_look"}}</span>\r\n	                </div>\r\n            	{{/unless}}\r\n            </div>\r\n            <div class="book2-child-theme x-fs-00 x-nowrap">\r\n                <div class="panel-1 x-di x-di-v-t x-normal">\r\n                    <div>\r\n                        <h2 class="x-fs-24 x-di x-di-v-m x-lh-12 x-ff-wb">{{type}}</h2>\r\n                        {{#if amenities.length}}\r\n                            <span class="x-fs-18 x-di x-di-v-m x-ml-08 x-separator"></span>\r\n                            <span class="x-fs-18 x-di x-di-v-m x-ml-04"></span>\r\n                            {{#each amenities}}\r\n                                <span class="x-fs-18 x-di x-di-v-m x-ml-04 x-default x-popup {{fonticon}}" data-item="popup">\r\n                                <div class="x-popup-wrap x-fs-00">\r\n                                    <div class="x-popup-body x-fs-16 x-ff-sm x-nowrap" style="padding: 6px 10px">{{name}}</div>\r\n                                </div>\r\n                            </span>\r\n                            {{/each}}\r\n                        {{/if}}\r\n                    </div>\r\n                    {{#if badgetitle}}\r\n                        <div class="x-mt-08">\r\n                            <span class="x-fs-12 x-ff-mh x-lh-24 x-pl-08 x-pr-08 x-di x-di-v-t x-upper x-nowrap x-bc-peach x-fc-white">{{badgetitle}}</span>\r\n                        </div>\r\n                    {{/if}}\r\n                    {{#if roomtagline}}\r\n                        <div class="x-mt-08">\r\n                            <span class="x-fs-16 x-di x-di-v-m x-ff-sm x-fc-black x-normal">{{roomtagline}}</span>\r\n                        </div>\r\n                    {{else}}\r\n                        {{#if roomsize}}\r\n                            <div class="x-mt-08 x-nowrap">\r\n                                <span class="x-fs-16 x-di x-di-v-m x-fc-black icon-icon_I016"></span>\r\n                                <span class="x-fs-16 x-di x-di-v-m x-ff-sm x-fc-black x-ml-06 x-normal">{{{specialSymbolFix roomsize}}}</span>\r\n                            </div>\r\n                        {{/if}}\r\n                        <div class="x-mt-08">\r\n                            {{#if adults.length}}\r\n                                {{#each adults}}\r\n                                    <span class="x-fs-16 x-di x-di-v-m x-fc-black icon-icon_J013"></span>\r\n                                {{/each}}\r\n                                {{#equal adults.length 1}}\r\n                                    <span class="x-fs-16 x-di x-di-v-m x-ff-sm x-ml-06">{{local "booking.adult"}}</span>\r\n                                {{else}}\r\n                                    <span class="x-fs-16 x-di x-di-v-m x-ff-sm x-ml-06">{{local "booking.adults"}}</span>\r\n                                {{/equal}}\r\n                                <span class="x-di x-di-v-m x-ml-06"></span>\r\n                            {{/if}}\r\n                            {{#if children.length}}\r\n                                {{#each children}}\r\n                                    <span class="x-fs-16 x-di x-di-v-m x-fc-black icon-icon_J012"></span>\r\n                                {{/each}}\r\n                                {{#equal children.length 1}}\r\n                                    <span class="x-fs-16 x-di x-di-v-m x-ff-sm x-ml-06">{{local "booking.child"}}</span>\r\n                                {{else}}\r\n                                    <span class="x-fs-16 x-di x-di-v-m x-ff-sm x-ml-06">{{local "booking.children"}}</span>\r\n                                {{/equal}}\r\n                            {{/if}}\r\n                            {{#if hasocc}}\r\n                                <span class="x-di x-di-v-m x-fs-16 x-ml-06 x-default x-popup icon-icon_B008" data-item="maxocc"></span>\r\n                            {{/if}}\r\n                        </div> \r\n                    {{/if}}\r\n\r\n                    <div class="x-mt-08">\r\n                        {{#each bedtypes}}\r\n                            <div class="x-di x-di-v-t">\r\n                                {{#if highlight}}\r\n                                    <div class="x-nowrap x-fc-azure">\r\n                                        <span class="x-fs-16 x-di x-di-v-m {{bedtypeicon}}"></span>\r\n                                        <span class="x-fs-16 x-di x-di-v-m x-ff-wm x-ml-06 x-under">{{bedtext}}</span>\r\n                                    </div>\r\n                                {{else}}\r\n                                    <div class="x-nowrap x-fc-black x-pointer" data-bed-type="{{bedtype}}" data-item="beds">\r\n                                        <span class="x-fs-16 x-di x-di-v-m {{bedtypeicon}}"></span>\r\n                                        <span class="x-fs-16 x-di x-di-v-m x-ff-sm x-ml-06 x-under">{{bedtext}}</span>\r\n                                    </div>\r\n                                {{/if}}\r\n                                <div class="book2-updated-tip x-fs-12 x-mt-08 x-fc-green x-al-c" data-bed-type="{{bedtype}}">\r\n                                    <span class="x-fs-16 x-di x-di-v-m icon-icon_I009"></span> {{local "booking.updated"}}\r\n                                </div>\r\n                            </div>\r\n                            <div class="x-di x-di-v-t x-ml-08"></div>\r\n                        {{/each}}\r\n                    </div>\r\n                </div>\r\n                <div class="panel-2 x-di x-di-v-t x-normal">\r\n                    {{#if isFinal}}\r\n                        <div class="x-fs-16 x-lh-22 x-fc-black x-mt-45">\r\n                            <span style="display: inline-block; max-width: 220px; line-height: 2.2rem">\r\n                                {{#if hasRateCalendar}}\r\n                                    {{#if isMayfair}}\r\n                                        {{#if mayfairDeadline}}\r\n                                            <span class="x-sd-tip" data-item="s-rate-calendar">{{local \'booking.sold_out_for_calendar\'}}</span>\r\n                                            <!--MHS-2663-->\r\n                                            {{#if cityHotelsCount}}\r\n                                                <span class="x-rc-tip" data-item="s-rate-calendar">{{local \'booking.view_dates_by_calendar\'}}</span>\r\n                                            {{else}}\r\n                                                <span class="x-rc-tip" data-item="s-rate-calendar">{{{calendarAndCity}}}</span>\r\n                                            {{/if}}\r\n                                        {{else}}\r\n                                            {{#if mayfairFlag}}\r\n                                                <span class="x-rc-tip" data-item="s-rate-calendar">{{local \'booking.renovating_prompt\'}}<a data-btn="ss_link">{{local \'booking.see_similar_link\'}}</a></span>\r\n                                            {{else}}\r\n                                                <span class="x-rc-tip" data-item="s-rate-calendar">{{local \'booking.renovating_prompt\'}}<a data-btn="ss_link" style="color:black; text-decoration: none; cursor: initial;">{{local \'booking.see_similar_link\'}}</a></span>\r\n                                            {{/if}}\r\n                                        {{/if}}\r\n                                    {{else}}\r\n                                        <span class="x-sd-tip" data-item="s-rate-calendar">{{local \'booking.sold_out_for_calendar\'}}</span>\r\n                                        <!--MHS-2663-->\r\n                                        {{#if cityHotelsCount}}\r\n                                            <span class="x-rc-tip" data-item="s-rate-calendar">{{local \'booking.view_dates_by_calendar\'}}</span>\r\n                                        {{else}}\r\n                                            <span class="x-rc-tip" data-item="s-rate-calendar">{{{calendarAndCity}}}</span>\r\n                                        {{/if}}\r\n                                    {{/if}}\r\n                                {{else}}\r\n                                    {{#if otheravailability}}\r\n                                        {{#if samecityhotelcount}}\r\n                                            {{#if isMayfair}}\r\n                                                {{#if mayfairDeadline}}\r\n                                                    {{local "booking.missed_the_last_room"}} {{local "general.explore"}} <a class="x-link x-fc-azure x-pointer x-under" href="javascript:void(0)" data-item="other-room">{{local "booking.other_rooms"}}</a> {{local "globalsearch.link_or"}} <a class="x-link x-fc-azure x-pointer x-under" target="_self" href="{{locationbookingurl}}" target="_self">{{local "booking.other_hotels" locationname}}</a>\r\n                                                {{else}}\r\n                                                    {{#if mayfairFlag}}\r\n                                                        <span class="x-rc-tip" data-item="s-rate-calendar">{{local \'booking.renovating_prompt\'}}<a data-btn="ss_link">{{local \'booking.see_similar_link\'}}</a></span>\r\n                                                    {{else}}\r\n                                                        <span class="x-rc-tip" data-item="s-rate-calendar">{{local \'booking.renovating_prompt\'}}<a data-btn="ss_link" style="color:black; text-decoration: none; cursor: initial;">{{local \'booking.see_similar_link\'}}</a></span>\r\n                                                    {{/if}}\r\n                                                {{/if}}\r\n                                            {{else}}\r\n                                                {{#if ParamGroupCode}}\r\n                                                    {{local "booking.no_rooms_available_for_groupcode"}}\r\n                                                {{else}}\r\n                                                    {{local "booking.missed_the_last_room"}} {{local "general.explore"}} <a class="x-link x-fc-azure x-pointer x-under" href="javascript:void(0)" data-item="other-room">{{local "booking.other_rooms"}}</a> {{local "globalsearch.link_or"}} <a class="x-link x-fc-azure x-pointer x-under" target="_self" href="{{locationbookingurl}}" target="_self">{{local "booking.other_hotels" locationname}}</a>\r\n                                                {{/if}}\r\n                                            {{/if}}\r\n                                        {{else}}\r\n                                            {{#if isMayfair}}\r\n                                                {{#if mayfairDeadline}}\r\n                                                    {{local "booking.missed_the_last_room"}} {{local "general.explore"}} <a class="x-link x-fc-azure x-pointer x-under" href="javascript:void(0)" data-item="other-room">{{local "booking.other_rooms"}}</a>\r\n                                                {{else}}\r\n                                                    {{#if mayfairFlag}}\r\n                                                        <span class="x-rc-tip" data-item="s-rate-calendar">{{local \'booking.renovating_prompt\'}}<a data-btn="ss_link">{{local \'booking.see_similar_link\'}}</a></span>\r\n                                                    {{else}}\r\n                                                        <span class="x-rc-tip" data-item="s-rate-calendar">{{local \'booking.renovating_prompt\'}}<a data-btn="ss_link" style="color:black; text-decoration: none; cursor: initial;">{{local \'booking.see_similar_link\'}}</a></span>\r\n                                                    {{/if}}\r\n                                                {{/if}}\r\n                                            {{else}}\r\n                                                {{#if ParamGroupCode}}\r\n                                                    {{local "booking.no_rooms_available_for_groupcode"}}\r\n                                                {{else}}\r\n                                                    {{local "booking.missed_the_last_room"}} {{local "general.explore"}} <a class="x-link x-fc-azure x-pointer x-under" href="javascript:void(0)" data-item="other-room">{{local "booking.other_rooms"}}</a>\r\n                                                {{/if}}\r\n                                            {{/if}}\r\n                                        {{/if}}\r\n                                    {{else}}\r\n                                        {{#if samecityhotelcount}}\r\n                                            {{#if isMayfair}}\r\n                                                {{#if mayfairDeadline}}\r\n                                                    {{local "booking.missed_the_last_room"}} {{local "general.explore"}} <a class="x-link x-fc-azure x-pointer x-under" href="{{locationbookingurl}}" target="_self">{{local "booking.other_hotels" locationname}}</a>\r\n                                                {{else}}\r\n                                                    {{#if mayfairFlag}}\r\n                                                        <span class="x-rc-tip" data-item="s-rate-calendar">{{local \'booking.renovating_prompt\'}}<a data-btn="ss_link">{{local \'booking.see_similar_link\'}}</a></span>\r\n                                                    {{else}}\r\n                                                        <span class="x-rc-tip" data-item="s-rate-calendar">{{local \'booking.renovating_prompt\'}}<a data-btn="ss_link" style="color:black; text-decoration: none; cursor: initial;">{{local \'booking.see_similar_link\'}}</a></span>\r\n                                                    {{/if}}\r\n                                                {{/if}}\r\n                                            {{else}}\r\n                                                {{#if ParamGroupCode}}\r\n                                                    {{local "booking.no_rooms_available_for_groupcode"}}\r\n                                                {{else}}\r\n                                                    {{local "booking.missed_the_last_room"}} {{local "general.explore"}} <a class="x-link x-fc-azure x-pointer x-under" href="{{locationbookingurl}}" target="_self">{{local "booking.other_hotels" locationname}}</a>\r\n                                                {{/if}}\r\n                                            {{/if}}\r\n                                        {{else}}\r\n                                            {{#if isMayfair}}\r\n                                                {{#if mayfairDeadline}}\r\n                                                    {{local "booking.missed_the_last_room"}} {{local "general.explore"}} <a class="x-link x-fc-azure x-pointer x-under" href="javascript:void(0)" data-item="other-date">{{local "booking.other_dates"}}</a>\r\n                                                {{else}}\r\n                                                    {{#if mayfairFlag}}\r\n                                                        <span class="x-rc-tip" data-item="s-rate-calendar">{{local \'booking.renovating_prompt\'}}<a data-btn="ss_link">{{local \'booking.see_similar_link\'}}</a></span>\r\n                                                    {{else}}\r\n                                                        <span class="x-rc-tip" data-item="s-rate-calendar">{{local \'booking.renovating_prompt\'}}<a data-btn="ss_link" style="color:black; text-decoration: none; cursor: initial;">{{local \'booking.see_similar_link\'}}</a></span>\r\n                                                    {{/if}}\r\n                                                {{/if}}\r\n                                            {{else}}\r\n                                                {{#if ParamGroupCode}}\r\n                                                    {{local "booking.no_rooms_available_for_groupcode"}}\r\n                                                {{else}}\r\n                                                    {{local "booking.missed_the_last_room"}} {{local "general.explore"}} <a class="x-link x-fc-azure x-pointer x-under" href="javascript:void(0)" data-item="other-date">{{local "booking.other_dates"}}</a>\r\n                                                {{/if}}\r\n                                            {{/if}}\r\n                                        {{/if}}\r\n                                    {{/if}}\r\n                                {{/if}}\r\n                            </span>\r\n                        </div>\r\n                    {{else}}\r\n                        <div class="x-mt-36">\r\n                            <span class="x-di x-di-v-m"><img class="x-load x-load-sm" src="/assets/img/card/Preloader3.2_RedIcon_300px.gif" alt="{{local "form.loading"}}"></span>\r\n                            <span class="x-di x-di-v-m x-fs-14">{{local "booking.price_loading"}}</span>\r\n                        </div>\r\n                    {{/if}}\r\n                </div>\r\n            </div>\r\n        {{/if}}\r\n    </div>\r\n{{/if}}';
},{}],250:[function(e,i,a){var t=e("underscore"),r=e("backbone"),n=e("backbone.marionette"),o=e("./gmap/maps"),s=e("./gmap/icon");i.exports=n.LayoutView.extend({template:Handlebars.compile(e("./template.hbs")),className:"book2-content-section full-screen x-level x-level-0",regions:{maps:".book2-maps"},events:{"click [data-item='added']":function(){var e=this;e.mapView.getZoom().then(function(i){e.mapView.setZoom(parseInt(i)+1)})},"click [data-item='minus']":function(){var e=this;e.mapView.getZoom().then(function(i){e.mapView.setZoom(parseInt(i)-1)})}},initialize:function(){var e=this.options.rootState;this.__markerDeferred=jQuery.Deferred(),this.listenTo(e,"showProtagonist",this.showProtagonist)},onRender:function(){this.__initializeMaps()},showProtagonist:function(e){return this.__markerDeferred.then(jQuery.proxy(this.__showProtagonist,this,e))},__initializeMaps:function(){var e=this,i=e.options.rootState,a=i.getVille().hotels||[];a.length&&(e.mapView=new o,e.mapView.removeAll(),e.mapView.pushMarker(t.map(a,function(e){return{model:e.hotelid,position:{lat:e.lat,lng:e.lng},content:new s({model:new r.Model({rgba:"#b71233",icon:"icon-icon_N010",label:e.name})})}})).then(function(){e.__markerDeferred.resolve(),1===a.length?(e.mapView.setZoom(18),e.mapView.setCenter({lat:a[0].lat,lng:a[0].lng})):(e.mapView.fitBounds({}),e.mapView.getZoom().then(function(i){i>18&&e.mapView.setZoom(18)}))}),e.listenTo(e.mapView,"marker:click",e.__resetQueryParam),e.getRegion("maps").show(e.mapView))},__showProtagonist:function(e){this.mapView.setConst(e),this.mapView.fadeMarker({})},__resetQueryParam:function(e){this.options.rootState.trigger("resetQueryParam",{code:e.model,type:"hotel"})}})},{"./gmap/icon":247,"./gmap/maps":248,"./template.hbs":249,backbone:8,"backbone.marionette":6,underscore:42}],249:[function(e,i,a){i.exports='<div class="book2-maps"></div>\r\n<div class="book2-zoom">\r\n    <div>\r\n        <span class="x-fs-18 x-di x-zoom x-pointer icon-icon_B023" data-item="added"></span>\r\n    </div>\r\n    <div style="margin-top: 1px">\r\n        <span class="x-fs-18 x-di x-zoom x-pointer icon-icon_B024" data-item="minus"></span>\r\n    </div>\r\n</div>'},{}],248:[function(e,i,a){i.exports=e("../../../../../maps/api/google/google.maps.view")},{"../../../../../maps/api/google/google.maps.view":1127}],247:[function(e,i,a){i.exports=e("../../../../../maps/views/icon/view")},{"../../../../../maps/views/icon/view":1174}],246:[function(e,i,a){var t=e("backbone"),r=e("backbone.marionette"),n=e("./child/view"),o=e("./empty/view");i.exports=r.CollectionView.extend({childView:n,emptyView:o,className:"book2-content-section",childViewOptions:function(e){return{model:e,rootState:this.options.rootState}},initialize:function(){var e=this,i=e.options.rootState,a=i.getVille().hotels;e.collection=new t.Collection(a)}})},{"./child/view":243,"./empty/view":245,backbone:8,"backbone.marionette":6}],245:[function(e,i,a){var t=e("backbone.marionette");i.exports=t.ItemView.extend({template:Handlebars.compile(e("./template.hbs"))})},{"./template.hbs":244,"backbone.marionette":6}],244:[function(e,i,a){i.exports='<div class="x-fs-20 x-lh-12 x-al-c" style="padding: 4em">{{local "booking.invalid_destination"}}</div>'},{}],243:[function(e,i,a){var t=(e("underscore"),e("backbone.marionette")),r=e("../../../../../ui/util"),n=e("../../../../06-popping/view"),o=e("../../../../common/popup");i.exports=t.ItemView.extend({template:Handlebars.compile(e("./template.hbs")),className:"x-highlight",ui:{rate:"[data-item='rate']",hand:".book2-child-hands button"},events:{"click [data-item='look']":function(){var e=this,i=e.options.rootState;i.isFinal()&&i.trigger("planGalleryData",{hotelid:e.model.get("hotelid")})},"click [data-item='maps']":function(){var e=this,i=e.options.rootState;i.isFinal()&&(i.trigger("changeViewStyle",i.VIEW_STYLES.VILLE_BY_MAPS),i.trigger("showProtagonist",e.model.get("hotelid")))},"click [data-item='hand']":function(){var e=this,i=e.options.rootState;i.isFinal()&&i.trigger("resetQueryParam",{code:e.model.get("hotelid"),type:"hotel"})},"mouseenter @ui.rate":function(e){e.stopPropagation();var i=jQuery(e.target),a=i.width(),t=i.offset().left,s=this.serializeData(),l=o.addPopupTip(this,n.SAVINGSRATE,s,jQuery(e.currentTarget));r.isRTL()?l.css({left:t+a+"px",right:"auto"}).removeClass("left").addClass("right"):l.css({left:t+"px"}).removeClass("right").addClass("left")},"mouseleave @ui.rate":function(e){e.stopPropagation(),o.delPopupTip()}},serializeData:function(){var e=this,i=e.model.toJSON(),a=e.options.rootState,t=0;window.BookingFlowNotice&&1===window.BookingFlowNotice.tag&&(t=1);var r=this.model.get("compareavgrate"),n=this.model.get("comparenextdayrate"),o=this.model.get("price"),s=o&&o.currency,l=r&&r.guestcompareprice,c=r&&r.membercompareprice,d=r&&r.guestcomparepercent,p=r&&r.membercomparepercent,m=n&&n.guestcompareprice,x=n&&n.membercompareprice,f=n&&n.guestcomparepercent,u=n&&n.membercomparepercent,h=this.model.get("paywithpoints");return{disable:t,isFinal:a.isFinal(),isLogin:a.isLogin(),isManyDays:a.isManyDays(),isUseMoney:a.isTrade(a.VIEW_TRADES.USE_MONEY),isUsePoint:a.isTrade(a.VIEW_TRADES.USE_POINT),data:i,RateText:i18n.t("booking.price_rate").replace("{0}","<b>"+d+"</b>").replace("{1}","<b>"+s+"&nbsp;&nbsp;"+accounting.formatNumber(l,2)+"</b>"),ILRateText:i18n.t("booking.price_rate").replace("{0}","<b>"+p+"</b>").replace("{1}","<b>"+s+"&nbsp;&nbsp;"+accounting.formatNumber(c,2)+"</b>"),exRateText:i18n.t("booking.price_rate").replace("{0}","<b>"+f+"</b>").replace("{1}","<b>"+s+"&nbsp;&nbsp;"+accounting.formatNumber(m,2)+"</b>"),exILRateText:i18n.t("booking.price_rate").replace("{0}","<b>"+u+"</b>").replace("{1}","<b>"+s+"&nbsp;&nbsp;"+accounting.formatNumber(x,2)+"</b>"),memberpoints:i.price&&(a.isLogin()?parseFloat(i.price.points):parseFloat(i.price.points)-parseFloat(i.price.pointssaved)),paywithpoints:h}},initialize:function(){var e=this.options.rootState;this.__renderDeferred=jQuery.Deferred(),this.listenTo(e,"redrawViewChild",this.redrawViewChild)},onRender:function(){var e=this;this.__renderDeferred.resolve(),window.CRSNotice&&1===window.CRSNotice.tag&&e.ui.hand.hide()},redrawViewChild:function(e){return this.__renderDeferred.then(jQuery.proxy(this.__redrawViewChild,this,e))},__redrawViewChild:function(){this.render()}})},{"../../../../../ui/util":2122,"../../../../06-popping/view":343,"../../../../common/popup":348,"./template.hbs":242,"backbone.marionette":6,underscore:42}],242:[function(e,i,a){i.exports='<div class="x-mt-13"></div>\r\n<div class="book2-child-block x-bc-white x-highlight-all">\r\n    {{#if isFinal}}\r\n        <div class="book2-child-image x-fs-00 x-img x-highlight-tlb x-pointer" data-item="hand" style="background-image: url(\'{{data.carouselimage3}}\')">\r\n            {{#if data.badgetitle}}\r\n                <span class="x-fs-12 x-ff-mh x-lh-24 x-pl-08 x-pr-08 x-di x-di-v-t x-upper x-nowrap x-bc-azure x-fc-white x-highlight-tl">{{data.badgetitle}}</span>\r\n            {{/if}}\r\n        </div>\r\n    {{else}}\r\n        <div class="book2-child-image x-fs-00 x-img x-highlight-tlb" style="background-image: url(\'{{data.carouselimage3}}\')">\r\n            {{#if data.badgetitle}}\r\n                <span class="x-fs-12 x-ff-mh x-lh-24 x-pl-08 x-pr-08 x-di x-di-v-t x-upper x-nowrap x-bc-azure x-fc-white x-highlight-tl">{{data.badgetitle}}</span>\r\n            {{/if}}\r\n        </div>\r\n    {{/if}}\r\n\r\n    <div class="book2-child-theme x-fs-00 x-nowrap">\r\n        <div class="panel-1 x-di x-di-v-t x-normal">\r\n            {{#equal data.reevoo.ReviewFlag 1}}\r\n                <div>\r\n                    <span class="x-fs-16 x-fc-peach x-di x-di-v-m x-ff-wb icon-icon_E009"></span>\r\n                    <span class="x-fs-14 x-fc-peach x-di-v-m x-ff-wb x-ml-08">{{data.reevoo.ReviewScore}} {{data.reevoo.ReviewMessage}}</span>\r\n                    {{#if data.reevoo.ReviewUrl}}\r\n                        <a class="x-link x-di x-di-v-m x-fs-12 x-ff-sm x-under x-ml-08" href="{{data.reevoo.ReviewUrl}}" target="_blank">\r\n                            {{num-format data.reevoo.ReviewCount}} {{local "tours.reviews"}}\r\n                        </a>\r\n                    {{/if}}\r\n                </div>\r\n                <div class="x-mt-06"></div>\r\n            {{/equal}}\r\n            {{#equal data.reevoo.ReviewFlag 2}}\r\n                <div>\r\n                    <span class="x-fs-16 x-fc-peach x-di x-di-v-m x-ff-wb icon-icon_E009"></span>\r\n                    <span class="x-fs-14 x-fc-peach x-di-v-m x-ff-wb x-ml-08">{{data.reevoo.ReviewScore}}/10 {{data.reevoo.ReviewMessage}}</span>\r\n                    {{#if data.reevoo.ReviewUrl}}\r\n                        <a class="x-link x-di x-di-v-m x-fs-12 x-ff-sm x-under x-ml-08" href="{{data.reevoo.ReviewUrl}}" target="_blank">\r\n                            {{num-format data.reevoo.ReviewCount}} {{local "tours.reviews"}}\r\n                        </a>\r\n                    {{/if}}\r\n                </div>\r\n                <div class="x-mt-06"></div>\r\n            {{/equal}}\r\n            {{#equal data.reevoo.ReviewFlag 3}}\r\n                <div>\r\n                    <span class="x-fs-16 x-fc-peach x-di x-di-v-m x-ff-wb icon-icon_E009"></span>\r\n                    <span class="x-fs-14 x-fc-peach x-di-v-m x-ff-wb x-ml-08">{{data.reevoo.ReviewMessage}}</span>\r\n                </div>\r\n                <div class="x-mt-06"></div>\r\n            {{/equal}}\r\n            <div>\r\n                {{#if isFinal}}\r\n                    <h2 class="x-fs-24 x-di x-lh-12 x-di x-di-v-m x-ff-wb x-pointer" data-item="hand">{{data.name}}</h2>\r\n                {{else}}\r\n                    <h2 class="x-fs-24 x-di x-lh-12 x-di x-di-v-m x-ff-wb">{{data.name}}</h2>\r\n                {{/if}}\r\n            </div>\r\n            {{#if data.close2locations}}\r\n                <div class="x-mt-06 x-nowrap">\r\n                    <span class="x-fs-16 x-di x-di-v-m icon-icon_H001"></span>\r\n                    <span class="x-fs-13 x-di x-di-v-m x-ff-sm x-ml-08">{{data.close2locations}}</span>\r\n                </div>\r\n            {{/if}}\r\n        </div>\r\n        <div class="panel-2 x-di x-di-v-t x-normal">\r\n            {{#if isFinal}}\r\n                {{#if isUseMoney}}\r\n                    {{#if data.price.ratesaved}}\r\n                        {{#if isLogin}}\r\n                            <!--MHS-2774-->\r\n                            <div class="x-fs-16 x-ff-m7 x-upper">{{local "booking.you_ve_saved"}} {{data.price.currency}} {{price-format data.price.avgratesaved}}</div>\r\n                        {{else}}\r\n                            <div class="x-fs-16 x-ff-m7 x-upper">{{local "Property.members_pay"}}: {{data.price.currency}} {{price-format data.price.memberAvgpriceTax}}</div>\r\n                        {{/if}}\r\n                        <div class="x-mt-08"></div>\r\n                    {{/if}}\r\n                    {{#if data.price.rate}}\r\n                        {{#if data.price.finalpriceAvgTax}}\r\n                            <div class="x-fs-24 x-ff-wb x-upper" >{{data.price.currency}} {{price-format data.price.finalpriceAvgTax}}</div>\r\n                        {{/if}}\r\n                        {{#if isManyDays}}\r\n                            <div class="x-fs-16 x-ff-m7 x-upper x-mt-08">{{local "Property.avg_night"}}</div>\r\n                        {{else}}\r\n                            <div class="x-fs-16 x-ff-m7 x-upper x-mt-08">{{local "general.avg_night"}}</div>\r\n                        {{/if}}\r\n                    {{/if}}\r\n                {{/if}}\r\n                {{#if isUsePoint}}\r\n                    {{#if data.price.pointssaved}}\r\n                        {{#if paywithpoints}}\r\n                            {{#if isLogin}}\r\n                                <div class="x-fs-16 x-ff-m7 x-upper">{{local "booking.you_ve_saved"}} {{num-format data.price.pointssaved}} {{local "checkout.points"}}</div>\r\n                            {{else}}\r\n                                <div class="x-fs-16 x-ff-m7 x-upper">{{local "Property.members_pay"}}: {{num-format data.price.memberCostpointTax}} {{local "checkout.points"}}</div>\r\n                            {{/if}}\r\n                        {{else}}\r\n                            {{#if isLogin}}\r\n                                <!--MHS-2774-->\r\n                                <div class="x-fs-16 x-ff-m7 x-upper">{{local "booking.you_ve_saved"}} {{data.price.currency}} {{price-format data.price.avgratesaved}}</div>\r\n                            {{else}}\r\n                                <div class="x-fs-16 x-ff-m7 x-upper">{{local "Property.members_pay"}}: {{data.price.currency}} {{price-format data.price.memberAvgpriceTax}}</div>\r\n                            {{/if}}\r\n                        {{/if}}\r\n                        <div class="x-mt-08"></div>\r\n                    {{/if}}\r\n                    {{#if data.price.points}}\r\n                        {{#if paywithpoints}}\r\n                            <div class="x-fs-24 x-ff-wb x-upper" >{{num-format data.price.points}}</div>\r\n                        {{else}}\r\n                            <div class="x-fs-24 x-ff-wb x-upper" >{{data.price.currency}} {{price-format data.price.finalpriceAvgTax}}</div>\r\n                        {{/if}}\r\n                        {{#if isManyDays}}\r\n                            <div class="x-fs-16 x-ff-m7 x-upper x-mt-08">{{local "Property.avg_night"}}</div>\r\n                        {{else}}\r\n                            <div class="x-fs-16 x-ff-m7 x-upper x-mt-08">{{local "general.avg_night"}}</div>\r\n                        {{/if}}\r\n                    {{/if}}\r\n                {{/if}}\r\n            {{else}}\r\n                <div class="x-mt-36">\r\n                    <span class="x-di x-di-v-m"><img class="x-load x-load-sm" src="/assets/img/card/Preloader3.2_RedIcon_300px.gif" alt="{{local "form.loading"}}"></span>\r\n                    <span class="x-di x-di-v-m x-fs-14">{{local "booking.price_loading"}}</span>\r\n                </div>\r\n            {{/if}}\r\n        </div>\r\n    </div>\r\n\r\n    <div class="book2-child-rate x-fs-00 x-nowrap x-level-2">\r\n        {{#if isFinal}}\r\n            {{#unless data.comparenextdayrate}}\r\n                {{#if data.compareavgrate }}\r\n                    {{#if isLogin}}\r\n                        <div class="rate-1 x-fs-14 x-di x-di-v-m x-ff-sm x-lh-22 x-pointer" data-item="rate">\r\n                            <u>%</u>\r\n                            {{local "booking.savings_alert"}}: {{data.compareavgrate.membercomparepercent}} {{local "booking.below_avg_rate"}}\r\n                        </div>\r\n                    {{else}}\r\n                        <div class="rate-1 x-fs-14 x-di x-di-v-m x-ff-sm x-lh-22 x-pointer" data-item="rate">\r\n                            <u>%</u>\r\n                            {{local "booking.savings_alert"}}: {{data.compareavgrate.guestcomparepercent}} {{local "booking.below_avg_rate"}}\r\n                        </div>\r\n                    {{/if}}\r\n                {{/if}}\r\n            {{else}}\r\n                {{#if isLogin}}\r\n                    <div class="rate-1 x-fs-14 x-di x-di-v-m x-ff-sm x-lh-22 x-pointer" data-item="rate">\r\n                        <u>%</u>\r\n                        {{local "booking.savings_alert"}}: {{data.comparenextdayrate.membercomparepercent}} {{local "booking.below_avg_rate"}}\r\n                    </div>\r\n                {{else}}\r\n                    <div class="rate-1 x-fs-14 x-di x-di-v-m x-ff-sm x-lh-22 x-pointer" data-item="rate">\r\n                        <u>%</u>\r\n                        {{local "booking.savings_alert"}}: {{data.comparenextdayrate.guestcomparepercent}} {{local "booking.below_avg_rate"}}\r\n                    </div>\r\n                {{/if}}\r\n            {{/unless}}\r\n        {{/if}}\r\n    </div>\r\n\r\n    <div class="book2-child-hands x-fs-00 x-nowrap x-level-1">\r\n        <div class="panel-1 x-di x-di-v-b x-normal">\r\n            {{#if data.testimonial}}\r\n                <div class="book2-testimonial x-fs-13">{{{data.testimonial}}}</div>\r\n                <div class="x-mt-06"></div>\r\n            {{/if}}\r\n            <div>\r\n                <!--<span class="x-fs-16 x-di x-di-v-b x-ff-wb x-fc-azure x-under x-pointer" data-item="look">{{local "Property.gallery"}}</span>-->\r\n                <!--<span class="x-fs-16 x-di x-di-v-b x-ff-wb x-fc-azure x-ml-08">|</span>-->\r\n                <span class="x-fs-16 x-di x-di-v-b x-ff-wb x-fc-azure x-under x-pointer x-ml-08" data-item="maps">{{local "general.map"}}</span>\r\n                <span class="x-fs-16 x-di x-di-v-b x-ff-wb x-fc-azure x-ml-08">|</span>\r\n                <span class="x-fs-16 x-di x-di-v-b x-ff-wb x-fc-azure x-under x-pointer x-ml-08" data-item="look">{{local "booking.quick_look"}}</span>\r\n            </div>\r\n        </div>\r\n        <div class="panel-2 x-di x-di-v-b x-normal">\r\n            {{#if isFinal}}\r\n                <button class="x-fs-14 x-ff-mh x-btn x-btn-azure {{#equal disable \'1\'}}disable-crs{{/equal}}" style="width: 210px;" type="button" data-item="hand">{{local "booking.check_rooms_rates"}}</button>\r\n            {{/if}}\r\n        </div>\r\n    </div>\r\n</div>'},{}],241:[function(e,i,a){var t=e("backbone.marionette"),r=e("underscore");i.exports=t.ItemView.extend({template:Handlebars.compile(e("./template.hbs")),events:{"click [data-item='city']":function(){var e=this,i=e.options.rootState;i.isFinal()&&i.trigger("changeViewStyle",i.VIEW_STYLES.VILLE_BY_CITY)},"click [data-item='maps']":function(){var e=this,i=e.options.rootState;i.isFinal()&&i.trigger("changeViewStyle",i.VIEW_STYLES.VILLE_BY_MAPS)},"click [data-item='room']":function(){var e=this,i=e.options.rootState;i.isFinal()&&i.trigger("changeViewStyle",i.VIEW_STYLES.HOTEL_BY_ROOM)},"click [data-item='rate']":function(){var e=this,i=e.options.rootState;i.isFinal()&&i.trigger("changeViewStyle",i.VIEW_STYLES.HOTEL_BY_RATE)},"click [data-item='all']":function(){var e=this,i=e.options.rootState;i.isFinal()&&i.trigger("changeViewStyle",i.VIEW_STYLES.HOTEL_BY_ALL)},"click [data-item='rate-calendar']":function(){var e=this,i=e.options.rootState;i.setLastStyle(i.getStyle()),i.isFinal()&&i.trigger("changeViewStyle",i.VIEW_STYLES.HOTEL_BY_CALENDAR)},"click [data-item='cancel-rate-calendar']":function(){var e=this,i=e.options.rootState,a=i.getLastStyle();i.isFinal()&&a&&i.trigger("changeViewStyle",a)},"click [data-item='money']":function(){var e=this,i=e.options.rootState;i.isFinal()&&i.trigger("changeViewTrade",i.VIEW_TRADES.USE_MONEY)},"click [data-item='point']":function(){var e=this,i=e.options.rootState;i.isFinal()&&i.trigger("changeViewTrade",i.VIEW_TRADES.USE_POINT)}},serializeData:function(){var e=this,i=e.options.rootState,a=null;(i.isStyle(i.VIEW_STYLES.VILLE_BY_CITY)||i.isStyle(i.VIEW_STYLES.VILLE_BY_MAPS))&&(a="VILLE"),(i.isStyle(i.VIEW_STYLES.HOTEL_BY_ROOM)||i.isStyle(i.VIEW_STYLES.HOTEL_BY_RATE)||i.isStyle(i.VIEW_STYLES.HOTEL_BY_ALL)||i.isStyle(i.VIEW_STYLES.HOTEL_BY_CALENDAR))&&(a="HOTEL");var t=i.getPromoDetail(),r=e.payWithPointsFun(),n=i.getHotel().paywithpoints;return{type:a,isFinal:i.isFinal(),isLogin:i.isLogin(),isUseMoney:i.isTrade(i.VIEW_TRADES.USE_MONEY),isUsePoint:i.isTrade(i.VIEW_TRADES.USE_POINT),isVilleByCity:i.isStyle(i.VIEW_STYLES.VILLE_BY_CITY),isVilleByMaps:i.isStyle(i.VIEW_STYLES.VILLE_BY_MAPS),isHotelByRoom:i.isStyle(i.VIEW_STYLES.HOTEL_BY_ROOM),isHotelByRate:i.isStyle(i.VIEW_STYLES.HOTEL_BY_RATE),isHotelByAll:i.isStyle(i.VIEW_STYLES.HOTEL_BY_ALL),isHotelByRateCalendar:i.isStyle(i.VIEW_STYLES.HOTEL_BY_CALENDAR),loyalty:i.getLoyalty(),hasRateCalendar:i.hasRateCalendar()&&(!t||1!=t.hideOtherRates),isCityPoints:r,isHotelPoints:n}},initialize:function(){this.__scrollHandleProxy=jQuery.proxy(this.__scrollHandle,this)},onRender:function(){var e=this.options.rootState;e.getLoyalty()&&e.trigger("resetLoyaltyTip",e.getLoyalty()+"%"),this.__attachScroll()},payWithPointsFun:function(){var e=this,i=e.options.rootState,a=i.getVille().hotels,t=!1;return r.each(a,function(e){return t?!1:void(e.paywithpoints&&(t=!0))}),t},onBeforeRender:function(){this.__detachScroll()},onDestroy:function(){this.__detachScroll()},__scrollHandle:function(){jQuery(window).scrollTop()>299?this.$el.addClass("book2-toolbar-fixed"):this.$el.removeClass("book2-toolbar-fixed")},__attachScroll:function(){jQuery(window).on("scroll",this.__scrollHandleProxy)},__detachScroll:function(){jQuery(window).off("scroll",this.__scrollHandleProxy)}})},{"./template.hbs":240,"backbone.marionette":6,underscore:42}],240:[function(e,i,a){i.exports='{{#equal type "VILLE"}}\r\n    <div class="book2-toolbar-section x-level x-level-9">\r\n        <div class="x-flt-l x-fs-00 x-mt-26 x-pl-36">\r\n            <span class="x-di x-di-v-m x-fs-14 x-upper x-mr-08">{{local "booking.view_by"}}:</span>\r\n            {{#if isVilleByCity}}\r\n                <span class="book2-viewpattern book2-width-auto x-di x-di-v-m x-none x-fc-ashen x-bc-black x-upper">{{local "booking.city_list"}}</span>\r\n                {{#if isFinal}}\r\n                    <span class="book2-viewpattern book2-width-auto x-di x-di-v-m x-none x-fc-black x-bc-ashen x-pointer x-upper" data-item="maps">{{local "booking.city_map"}}</span>\r\n                {{else}}\r\n                    <span class="book2-viewpattern book2-width-auto x-di x-di-v-m x-none x-fc-black x-bc-ashen x-upper">{{local "booking.city_map"}}</span>\r\n                {{/if}}\r\n            {{/if}}\r\n            {{#if isVilleByMaps}}\r\n                {{#if isFinal}}\r\n                    <span class="book2-viewpattern book2-width-auto x-di x-di-v-m x-none x-fc-black x-bc-ashen x-pointer x-upper" data-item="city">{{local "booking.city_list"}}</span>\r\n                {{else}}\r\n                    <span class="book2-viewpattern book2-width-auto x-di x-di-v-m x-none x-fc-black x-bc-ashen x-upper">{{local "booking.city_list"}}</span>\r\n                {{/if}}\r\n                <span class="book2-viewpattern book2-width-auto x-di x-di-v-m x-none x-fc-ashen x-bc-black x-upper">{{local "booking.city_map"}}</span>\r\n            {{/if}}\r\n        </div>\r\n        <div class="book2-viewloyalty x-flt-r x-fs-00 x-mt-26 x-pr-36 x-nowrap">\r\n            {{#if isVilleByCity}}\r\n                {{#if isLogin}}\r\n                    {{#if isCityPoints}}\r\n                        {{#if isUseMoney}}\r\n                            {{#if isFinal}}\r\n                                <span class="x-di x-di-v-m x-fs-16 x-check x-pointer x-check-sm x-mt-02" data-item="point"></span>\r\n                                <span class="x-di x-di-v-m x-fs-14 x-ff-m7 x-ml-06 x-none x-pointer x-mt-02" data-item="point">{{local "booking.view_prices_in_points"}}</span>\r\n                            {{else}}\r\n                                <span class="x-di x-di-v-m x-fs-16 x-check x-check-sm x-mt-02"></span>\r\n                                <span class="x-di x-di-v-m x-fs-14 x-ff-m7 x-ml-06 x-none x-mt-02">{{local "booking.view_prices_in_points"}}</span>\r\n                            {{/if}}\r\n                        {{/if}}\r\n                        {{#if isUsePoint}}\r\n                            {{#if isFinal}}\r\n                                <span class="x-di x-di-v-m x-fs-16 x-check x-pointer x-check-sm checked x-mt-02" data-item="money"></span>\r\n                                <span class="x-di x-di-v-m x-fs-14 x-ff-m7 x-ml-06 x-none x-pointer x-mt-02" data-item="money">{{local "booking.view_prices_in_points"}}</span>\r\n                            {{else}}\r\n                                <span class="x-di x-di-v-m x-fs-16 x-check x-check-sm checked x-mt-02"></span>\r\n                                <span class="x-di x-di-v-m x-fs-14 x-ff-m7 x-ml-06 x-none x-mt-02">{{local "booking.view_prices_in_points"}}</span>\r\n                            {{/if}}\r\n                        {{/if}}\r\n                    {{/if}}\r\n                {{else}}\r\n                    <span class="x-di x-di-v-m x-ff-m7 x-al-r x-lh-12 x-fs-14 x-normal">{{local "booking.get_a_loyalty_discount"}}</span>\r\n                {{/if}}\r\n            {{/if}}\r\n        </div>\r\n    </div>\r\n{{/equal}}\r\n\r\n{{#equal type "HOTEL"}}\r\n    <div class="book2-toolbar-section x-level x-level-0">\r\n        <div class="x-flt-l x-fs-00 x-mt-26 x-pl-36">\r\n            <span class="x-di x-di-v-m x-fs-14 x-upper">{{local "booking.view_by"}}:</span>\r\n            {{#if isHotelByRoom}}\r\n                <button class="x-ff-sm x-di x-di-v-m x-fs-14 x-btn x-btn-black x-default x-none checked x-upper x-ml-08">{{local "booking.rooms"}}</button>\r\n                <button class="x-ff-sm x-di x-di-v-m x-fs-14 x-btn x-btn-black x-pointer x-none x-upper x-btn-br-none" data-item="rate">{{local "booking.rates"}}</button>\r\n                <button class="x-ff-sm x-di x-di-v-m x-fs-14 x-btn x-btn-black x-pointer x-none x-upper" data-item="all">{{local "general.all"}}</button>\r\n                {{#if hasRateCalendar}}\r\n                    <span class="x-di x-di-v-m x-fs-16 x-check x-pointer x-check-sm x-ml-40 x-mb-03" data-item="rate-calendar" style="padding:2.3px;"></span>\r\n                    <span class="x-lh-15 x-ff-sm x-di x-di-v-m x-fs-16 x-ml-06 x-none x-pointer x-rc-tip x-mb-05 x-rc-text" data-item="rate-calendar">{{local \'booking.try_rate_calendar\'}}</span>\r\n                {{/if}}\r\n            {{/if}}\r\n            {{#if isHotelByRate}}\r\n                <button class="x-ff-sm x-di x-di-v-m x-fs-14 x-btn x-btn-black x-pointer x-none x-upper x-ml-08" data-item="room">{{local "booking.rooms"}}</button>\r\n                <button class="x-ff-sm x-di x-di-v-m x-fs-14 x-btn x-btn-black x-default x-none checked x-upper">{{local "booking.rates"}}</button>\r\n                <button class="x-ff-sm x-di x-di-v-m x-fs-14 x-btn x-btn-black x-pointer x-none x-upper" data-item="all">{{local "general.all"}}</button>\r\n                {{#if hasRateCalendar}}\r\n                    <span class="x-di x-di-v-m x-fs-16 x-check x-pointer x-check-sm x-ml-40 x-mb-03" data-item="rate-calendar" style="padding:2.3px;"></span>\r\n                    <span class="x-lh-15 x-ff-sm x-di x-di-v-m x-fs-16 x-ml-06 x-none x-pointer x-rc-tip x-mb-05 x-rc-text" data-item="rate-calendar">{{local \'booking.try_rate_calendar\'}}</span>\r\n                {{/if}}\r\n            {{/if}}\r\n            {{#if isHotelByAll}}\r\n                <button class="x-ff-sm x-di x-di-v-m x-fs-14 x-btn x-btn-black x-pointer x-none x-upper x-ml-08 x-btn-br-none"data-item="room">{{local "booking.rooms"}}</button>\r\n                <button class="x-ff-sm x-di x-di-v-m x-fs-14 x-btn x-btn-black x-pointer x-none x-upper x-btn-br-none" data-item="rate">{{local "booking.rates"}}</button>\r\n                <button class="x-ff-sm x-di x-di-v-m x-fs-14 x-btn x-btn-black x-default x-none checked x-upper">{{local "general.all"}}</button>\r\n                {{#if hasRateCalendar}}\r\n                    <span class="x-di x-di-v-m x-fs-16 x-check x-pointer x-check-sm x-ml-40 x-mb-03" data-item="rate-calendar" style="padding:2.3px;"></span>\r\n                    <span class="x-lh-15 x-ff-sm x-di x-di-v-m x-fs-16 x-ml-06 x-none x-pointer x-rc-tip x-mb-05 x-rc-text" data-item="rate-calendar">{{local \'booking.try_rate_calendar\'}}</span>\r\n                {{/if}}\r\n            {{/if}}\r\n            {{#if isHotelByRateCalendar}}\r\n                <button class="x-ff-sm x-di x-di-v-m x-fs-14 x-btn x-btn-black x-btn-br-none x-pointer x-none x-upper x-ml-08" data-item="room">{{local "booking.rooms"}}</button>\r\n                <button class="x-ff-sm x-di x-di-v-m x-fs-14 x-btn x-btn-black x-btn-br-none x-pointer x-none x-upper" data-item="rate">{{local "booking.rates"}}</button>\r\n                <button class="x-ff-sm x-di x-di-v-m x-fs-14 x-btn x-btn-black x-pointer x-none x-upper" data-item="all">{{local "general.all"}}</button>\r\n                <span class="x-di x-di-v-m x-fs-16 x-check x-pointer x-check-sm checked-azure x-ml-40 x-mb-03" data-item="cancel-rate-calendar" style="padding:2.3px;"></span>\r\n                <span class="x-lh-15 x-ff-sm x-di x-di-v-m x-fs-16 x-ml-06 x-none x-pointer x-rc-tip x-mb-05 x-rc-text" data-item="cancel-rate-calendar">{{local \'booking.try_rate_calendar\'}}</span>\r\n            {{/if}}\r\n        </div>\r\n        <div class="book2-viewloyalty x-flt-r x-fs-00 x-mt-26 x-pr-36 x-nowrap">\r\n            {{#if isLogin}}\r\n                {{#if isHotelPoints}}\r\n                    {{#if isUseMoney}}\r\n                        {{#if isFinal}}\r\n                            <span class="x-di x-di-v-m x-fs-16 x-check x-pointer x-check-sm x-mt-02" data-item="point"></span>\r\n                            <span class="x-di x-di-v-m x-fs-14 x-ff-m7 x-ml-06 x-none x-pointer x-mt-02" data-item="point">{{local "booking.view_prices_in_points"}}</span>\r\n                        {{else}}\r\n                            <span class="x-di x-di-v-m x-fs-16 x-check x-check-sm x-mt-02"></span>\r\n                            <span class="x-di x-di-v-m x-fs-14 x-ff-m7 x-ml-06 x-none x-mt-02">{{local "booking.view_prices_in_points"}}</span>\r\n                        {{/if}}\r\n                    {{/if}}\r\n                    {{#if isUsePoint}}\r\n                        {{#if isFinal}}\r\n                            <span class="x-di x-di-v-m x-fs-16 x-check x-pointer x-check-sm checked x-mt-02" data-item="money"></span>\r\n                            <span class="x-di x-di-v-m x-fs-14 x-ff-m7 x-ml-06 x-none x-pointer x-mt-02" data-item="money">{{local "booking.view_prices_in_points"}}</span>\r\n                        {{else}}\r\n                            <span class="x-di x-di-v-m x-fs-16 x-check x-check-sm checked x-mt-02"></span>\r\n                            <span class="x-di x-di-v-m x-fs-14 x-ff-m7 x-ml-06 x-none x-mt-02">{{local "booking.view_prices_in_points"}}</span>\r\n                        {{/if}}\r\n                    {{/if}}\r\n                {{/if}}\r\n            {{else}}\r\n                {{#if loyalty}}\r\n                    <span class="x-di x-di-v-m x-ff-m7 x-al-r x-lh-12 x-fs-14 x-normal">{{local "booking.get_extra_off" loyalty}}</span>\r\n                {{/if}}\r\n            {{/if}}\r\n        </div>\r\n    </div>\r\n{{/equal}}'},{}],239:[function(e,i,a){var t=e("backbone.marionette");i.exports=t.ItemView.extend({template:Handlebars.compile(e("./template.hbs")),events:{"click [data-item='look']":function(){var e=this,i=e.options.rootState;i.isFinal()&&i.trigger("planGalleryData",{hotelid:i.getHotel().hotelid})}},serializeData:function(){var e=this,i=e.options.rootState,a=null,t=null;return(i.isStyle(i.VIEW_STYLES.VILLE_BY_CITY)||i.isStyle(i.VIEW_STYLES.VILLE_BY_MAPS))&&(a=i.getVille(),t="VILLE"),(i.isStyle(i.VIEW_STYLES.HOTEL_BY_ROOM)||i.isStyle(i.VIEW_STYLES.HOTEL_BY_RATE)||i.isStyle(i.VIEW_STYLES.HOTEL_BY_ALL)||i.isStyle(i.VIEW_STYLES.HOTEL_BY_CALENDAR))&&(a=i.getHotel(),t="HOTEL"),{data:a,type:t,samecityhotelcount:a.samecityhotelcount-1,explore:i18n.t(0==a.type?"booking.learn_more":1==a.type?"booking.explore_neighbourhood":"booking.explore_city")}}})},{"./template.hbs":238,"backbone.marionette":6}],238:[function(e,i,a){i.exports='{{#equal type "VILLE"}}\r\n    <div class="book2-caption-section x-img x-img-mask" style="background-image: url(\'{{data.backgroundimage}}\')">\r\n        <div class="book2-caption-content x-db x-db-v-m x-pl-36 x-fc-white">\r\n            <div>\r\n                <h1 class="x-fs-28 x-fw-bold">{{data.citytitle}}</h1>\r\n            </div>\r\n            <div class="x-fs-13 x-mt-08">\r\n                {{data.description}}\r\n            </div>\r\n            <div class="x-fs-00 x-mt-45">\r\n                {{#if data.cityurl}}\r\n                    <a class="x-link x-fs-14 x-btn x-btn-white" href="{{data.cityurl}}">{{explore}}</a>\r\n                {{/if}}\r\n            </div>\r\n        </div>\r\n    </div>\r\n{{/equal}}\r\n\r\n{{#equal type "HOTEL"}}\r\n    <div class="book2-caption-section x-img x-img-mask" style="background-image: url(\'{{data.carouselimage}}\')">\r\n        <div class="book2-caption-content x-db x-db-v-m x-pl-36 x-fc-white">\r\n            <div class="x-fs-00">\r\n                <h1 class="x-fs-28 x-fw-bold">{{data.name}}</h1>\r\n            </div>\r\n            {{#equal data.reevoo.ReviewFlag 1}}\r\n                <div class="x-fs-00 x-mt-08">\r\n                    <span class="x-fs-20 x-di icon-icon_E011"></span>\r\n                    <span class="x-fs-16 x-di x-ml-06 x-ff-mm x-shadow">{{data.reevoo.ReviewScore}} {{data.reevoo.ReviewMessage}}</span>\r\n                    {{#if data.reevoo.ReviewUrl}}\r\n                        <a class="x-link x-di x-ml-06 x-shadow x-fs-14 x-ff-sm x-under x-pointer" href="{{data.reevoo.ReviewUrl}}" target="_blank">\r\n                            {{num-format data.reevoo.ReviewCount}} {{local "tours.reviews"}}\r\n                        </a>\r\n                    {{/if}}\r\n                </div>\r\n            {{/equal}}\r\n            {{#equal data.reevoo.ReviewFlag 2}}\r\n                <div class="x-fs-00 x-mt-08">\r\n                    <span class="x-fs-20 x-di icon-icon_E011"></span>\r\n                    <span class="x-fs-16 x-di x-ml-06 x-ff-mm x-shadow">{{data.reevoo.ReviewScore}}/10 {{data.reevoo.ReviewMessage}}</span>\r\n                    {{#if data.reevoo.ReviewUrl}}\r\n                        <a class="x-link x-di x-ml-06 x-shadow x-fs-14 x-ff-sm x-under x-pointer" href="{{data.reevoo.ReviewUrl}}" target="_blank">\r\n                            {{num-format data.reevoo.ReviewCount}} {{local "tours.reviews"}}\r\n                        </a>\r\n                    {{/if}}\r\n                </div>\r\n            {{/equal}}\r\n            {{#equal data.reevoo.ReviewFlag 3}}\r\n                <div class="x-fs-00 x-mt-08">\r\n                    <span class="x-fs-20 x-di icon-icon_E011"></span>\r\n                    <span class="x-fs-16 x-di x-ml-06 x-ff-mm x-shadow">{{data.reevoo.ReviewMessage}}</span>\r\n                </div>\r\n            {{/equal}}\r\n            <div class="x-fs-00 x-mt-08">\r\n                <!--MHS-2653-->\r\n                {{#if data.address.Address1}}\r\n                    <div class="x-pb-05">\r\n                        <span class="x-fs-16 x-di x-di-v-m icon-icon_F0272"></span>\r\n                        <span class="x-fs-15 x-di x-di-v-m x-ff-mm x-ml-06">{{data.address.Address1}}</span>\r\n                    </div>\r\n                {{/if}}\r\n                {{#if data.telphone}}\r\n                    <div class="x-pb-05">\r\n                        <span class="x-fs-16 x-di x-di-v-m icon-icon_H002"></span>\r\n                        <span class="x-fs-15 x-di x-di-v-m x-ff-mm x-ml-06">{{data.telphone}}</span>\r\n                    </div>\r\n                {{/if}}\r\n                {{#if data.email}}\r\n                    <div class="x-pb-05">\r\n                        <span class="x-fs-16 x-di x-di-v-m icon-icon_H003"></span>\r\n                        <span class="x-fs-15 x-di x-di-v-m x-ff-mm x-ml-06">{{data.email}}</span>\r\n                    </div>\r\n                {{/if}}\r\n            </div>\r\n            <div class="x-fs-00 x-mt-36">\r\n                <div class="book2-testimonial x-fs-15 x-ff-mm">{{{data.testimonial}}}</div>\r\n            </div>\r\n            <div class="x-fs-00 x-mt-08">\r\n                {{#if data.hotelurl}}\r\n                    <a class="x-link x-fs-14 x-btn x-btn-white" href="{{data.hotelurl}}">{{local "booking.visit_hotel"}}</a>\r\n                    <span class="x-ml-13"></span>\r\n                {{/if}}\r\n                {{#if samecityhotelcount}}\r\n                    {{#if data.locationbookingurl}}\r\n                        <a class="x-link x-fs-14 x-btn x-btn-white" href="{{data.locationbookingurl}}">{{data.locationtitle}}</a>\r\n                    {{/if}}\r\n                {{/if}}\r\n            </div>\r\n        </div>\r\n        <div class="book2-viewgallery x-fs-00 x-fc-white">\r\n            <span class="x-fs-20 x-di x-di-v-m x-pointer icon-icon_A004" data-item="look"></span>\r\n            <span class="x-fs-16 x-di x-di-v-m x-pointer x-ff-mm x-ml-08" data-item="look">{{local "booking.view_Gallery"}}</span>\r\n        </div>\r\n    </div>\r\n{{/equal}}';
},{}],237:[function(e,i,a){var t=e("backbone.marionette"),r=e("./01-inquire/view"),n=e("./02-summary/view"),o=e("../common/scroll"),s=e("../common/popup"),l=e("../06-popping/view");i.exports=t.LayoutView.extend({template:Handlebars.compile(e("./template.hbs")),ui:{cart:"[data-item='cart']"},regions:{inquire:".book2-inquire",summary:".book2-summary"},events:{"mouseenter @ui.cart":function(e){e.stopPropagation();var i=this,a=i.options.rootState;s.addPopupTip(i,l.BOOKINGCART,a.getBookingCart(),i.ui.cart,!0,!1)},"mouseleave @ui.cart":function(e){e.stopPropagation(),s.delPopupTip()}},serializeData:function(){var e=this,i=e.options.rootState;return{isHotel:"hotel"===i.getParam().type,bookingCart:i.getBookingCart(),ifcart:this.__bookingcartShow(i.getBookingCart())}},initialize:function(){var e=this.options.rootState;this.__renderDeferred=jQuery.Deferred(),this.listenTo(e,"showInquireView",this.showInquireView),this.listenTo(e,"showSummaryView",this.showSummaryView),this.listenTo(e,"hideSummaryView",this.hideSummaryView),o.autoCreate(this)},onRender:function(){this.__renderDeferred.resolve()},showInquireView:function(e){return this.__renderDeferred.then(jQuery.proxy(this.__showInquireView,this,e))},showSummaryView:function(e){return this.__renderDeferred.then(jQuery.proxy(this.__showSummaryView,this,e))},hideSummaryView:function(e){return this.__renderDeferred.then(jQuery.proxy(this.__hideSummaryView,this,e))},__showInquireView:function(){this.getRegion("inquire").show(new r({rootState:this.options.rootState}))},__showSummaryView:function(){this.getRegion("summary").show(new n({rootState:this.options.rootState}))},__hideSummaryView:function(){this.getRegion("summary").empty()},__bookingcartShow:function(e){return e.listcheckoutroom&&e.listcheckoutroom[0]||e.listcheckoutproduct&&e.listcheckoutproduct[0]||e.listcheckoutingresso&&e.listcheckoutingresso[0]}})},{"../06-popping/view":343,"../common/popup":348,"../common/scroll":349,"./01-inquire/view":228,"./02-summary/view":235,"./template.hbs":236,"backbone.marionette":6}],236:[function(e,i,a){i.exports='{{#if isHotel}}\r\n    <div class="book2-inquire-caption x-fs-20 x-ff-vv x-bc-azure x-fc-white">{{local "booking.your_booking_summary"}}</div>\r\n{{else}}\r\n    <div class="book2-inquire-caption x-fs-20 x-ff-vv x-bc-azure x-fc-white">{{local "booking.check_availability"}}</div>\r\n{{/if}}\r\n\r\n<div class="x-level">\r\n    <div class="x-scroll">\r\n        <div class="x-scroll-body">\r\n            <div class="book2-inquire"></div>\r\n            <div class="book2-summary"></div>\r\n            <div class="book2-cart">\r\n                {{#if ifcart}}\r\n                    <div class="x-ml-23 x-mr-23 x-pt-20 x-mt-20 x-top-line">\r\n                        <div class="x-flex">\r\n                            <span class="x-cell x-al-l x-fs-18 x-ff-m7 x-upper">{{local "booking.cart_total"}}</span>\r\n                            <span class="x-cell x-al-r">\r\n                                <span class="x-di-v-m x-fs-18 x-ff-wb x-upper">{{bookingCart.currencycode}} {{price-format bookingCart.totalprice}}</span>\r\n                                <span class="x-di-v-m x-fs-16 x-ml-06 x-default icon-icon_B008 down" data-item="cart"></span>\r\n                            </span>\r\n                        </div>\r\n                    </div>\r\n                {{/if}}\r\n            </div>\r\n        </div>\r\n    </div>\r\n    <div class="x-runner">\r\n        <div class="x-slider"></div>\r\n    </div>\r\n</div>'},{}],235:[function(e,i,a){var t=(e("underscore"),e("backbone"),e("backbone.marionette")),r=e("./child/view"),n=e("./total/view");i.exports=t.LayoutView.extend({template:Handlebars.compile(e("./template.hbs")),regions:{child:"[data-region='child']",total:"[data-region='total']",cart:"[data-region='cart']"},events:{"click [data-item='book']":function(){var e=this,i=e.options.rootState;i.trigger("addShoppingCart",i.getSummary())}},serializeData:function(){for(var e=this,i=e.options.rootState,a=i.getSummary(),t=i.getHotel(),r=!1,n=i.getParam().rooms,o=a[0].roomstay.NumberOfUnits,s=parseInt(n)>parseInt(o),l=0;l<a.length;l++){var c=a[l];if(r|=!!(c&&c.roomstay&&c.roomstay.RatePlan&&c.roomstay.RatePlan.paymentType))break}var d=function(){var e="",i=null!=a[0].rategainresult,r=t.activatebeatthempmg,n=null!=a[0].rategainresult?a[0].rategainresult.status:!1;return i?("2"===n&&(e="PMG1_CRS lower"),"3"===n&&(e=r?"PMG3a_CRS higher and beat them":"PMG3b_CRS higher and match"),"4"===n&&(e=r?"PMG2a_CRS same and beat them":"PMG2b_CRS same and match"),"5"===n&&(e="PMG4_CRS much higher")):e="PMG5_Null",e};return{payment:r,pmg:d(),roomsOfUnits:s}},onRender:function(){this.__showChildView(),this.__showTotalView()},__showChildView:function(){this.getRegion("child").show(new r({rootState:this.options.rootState}))},__showTotalView:function(){this.getRegion("total").show(new n({rootState:this.options.rootState}))}})},{"./child/view":231,"./template.hbs":232,"./total/view":234,backbone:8,"backbone.marionette":6,underscore:42}],234:[function(e,i,a){function t(e){return e.displaymemberrate}function r(e){return e.displaypoints}function n(e){return e.displaymemberrate}function o(e){return e.displaypoints}function s(e){return e.upgradeddifference.avgtopprice.avgtoppoints}var l=e("underscore"),c=e("backbone.marionette");i.exports=c.ItemView.extend({template:Handlebars.compile(e("./template.hbs")),serializeData:function(){var e=this,i=e.options.rootState,a=i.getSummary(),c=0,d=0,p=0,m=0,x=!1,f=0,u=i.getIGPoints(),h=!1;return u>0&&(x=!0),a.forEach(function(e){var a=e;if(a.voucherusage){var u=i.getUpgradeRateByRate({categoryid:e.categoryid,roomtypecode:e.roomtypecode,ratecode:e.ratecode,roomid:e.roomid});u&&(a=u.roomrate||a,x=!0,f+=s(u)*i.getParam().rooms)}c+=t(a),d+=r(a),p+=n(a),m+=o(a),h|=!(e&&e.roomstay&&e.roomstay.RatePlan&&e.roomstay.RatePlan.restricted),l.forEach(i.getStays({categoryid:a.categoryid,roomtypecode:a.roomtypecode,ratecode:a.ratecode,roomid:a.roomid}),function(e){var a=i.getStayCount({categoryid:e.categoryid,key:e.key})||0;a>0&&(c+=a*parseFloat(e.displayrate),p+=a*parseFloat(e.displayrate),d+=a*parseFloat(e.costpoints),m+=a*parseFloat(e.costpoints))})}),{isLogin:i.isLogin(),isFinal:i.isFinal(),isUseMoney:i.isTrade(i.VIEW_TRADES.USE_MONEY),isUsePoint:i.isTrade(i.VIEW_TRADES.USE_POINT),currency:i.getCurrency(),complete:i.getComplete()&&h,rate:c,points:d,memberrate:p,memberpoints:m,roomcount:i.getParam().rooms,multiple:parseInt(i.getParam().rooms)>1,upgraded:x,upgradePoints:f+u}},initialize:function(){var e=this.options.rootState;this.__renderDeferred=jQuery.Deferred(),this.listenTo(e,"redrawViewChild",this.redrawViewChild),this.listenTo(e,"changePartCount",this.redrawViewChild),this.listenTo(e,"turnUpgradeRate",this.redrawViewChild),this.listenTo(e,"redrawForIGConfirm",this.redrawViewChild)},onRender:function(){this.__renderDeferred.resolve()},redrawViewChild:function(e){return this.__renderDeferred.then(jQuery.proxy(this.__redrawViewChild,this,e))},__redrawViewChild:function(){this.render()}})},{"./template.hbs":233,"backbone.marionette":6,underscore:42}],233:[function(e,i,a){i.exports='<div class="x-flex">\r\n    {{#if multiple}}\r\n        <span class="x-cell x-al-l x-fs-18 x-ff-m7 x-upper">{{local "booking.total_for_rooms" roomcount}}</span>\r\n    {{else}}\r\n        <span class="x-cell x-al-l x-fs-18 x-ff-m7 x-upper">{{local "checkout.total_charge_all"}}</span>\r\n    {{/if}}\r\n    {{#if isUseMoney}}\r\n        {{#if isLogin}}\r\n            <div class="x-cell x-al-r x-fs-18 x-ff-wb x-upper">{{currency}} {{price-format memberrate}}{{#if upgraded}}<span class="x-fc-peach"> + {{num-format upgradePoints}} {{local \'account.points\'}}</span>{{/if}}</div>\r\n        {{else}}\r\n            {{#if complete}}\r\n                <span class="x-cell x-al-r x-fs-18 x-ff-wb x-upper x-through">{{currency}} {{price-format rate}}</span>\r\n            {{else}}\r\n                <span class="x-cell x-al-r x-fs-18 x-ff-wb x-upper">{{currency}} {{price-format rate}}</span>\r\n            {{/if}}\r\n        {{/if}}\r\n    {{/if}}\r\n    {{#if isUsePoint}}\r\n        {{#if isLogin}}\r\n            {{#if upgraded}}\r\n                <div class="x-cell x-al-r x-fs-18 x-ff-wb x-upper">{{num-format memberpoints}}<span class="x-fc-peach"> + {{num-format upgradePoints}} {{local \'account.points\'}}</span></div>\r\n            {{else}}\r\n                <div class="x-cell x-al-r x-fs-18 x-ff-wb x-upper">{{num-format memberpoints}} {{local \'account.points\'}}</div>\r\n            {{/if}}\r\n        {{else}}\r\n            {{#if complete}}\r\n                <span class="x-cell x-al-r x-fs-18 x-ff-wb x-upper x-through">{{num-format points}} {{local \'account.points\'}}</span>\r\n            {{else}}\r\n                <span class="x-cell x-al-r x-fs-18 x-ff-wb x-upper">{{num-format points}} {{local \'account.points\'}}</span>\r\n            {{/if}}\r\n        {{/if}}\r\n    {{/if}}\r\n</div>\r\n{{#if complete}}\r\n    {{#unless isLogin}}\r\n        <div class="x-flex">\r\n            <span class="x-cell x-al-l x-fs-18 x-ff-m7 x-upper"></span>\r\n            {{#if isUseMoney}}\r\n                <span class="x-cell x-al-r x-fs-18 x-ff-wb x-upper">{{currency}} {{price-format memberrate}}</span>\r\n            {{/if}}\r\n            {{#if isUsePoint}}\r\n                <span class="x-cell x-al-r x-fs-18 x-ff-wb x-upper">{{num-format memberpoints}} {{local \'account.points\'}}</span>\r\n            {{/if}}\r\n        </div>\r\n        <div class="x-flex">\r\n            <span class="x-cell x-al-l x-fs-12 x-ff-sm"></span>\r\n            <span class="x-cell x-al-r x-fs-12 x-ff-sm">{{local "booking.member_price_applied"}}</span>\r\n        </div>\r\n    {{/unless}}\r\n{{/if}}'},{}],232:[function(e,i,a){i.exports='<div class="x-ml-23 x-mr-23 x-mt-20 x-top-line" data-region="child"></div>\r\n<div class="x-ml-23 x-mr-23 x-mt-20"            data-region="total"></div>\r\n\r\n<div class="x-ml-23 x-mr-23 x-mt-20 {{#if roomsOfUnits}}x-disable{{/if}}">\r\n    <button class="x-btn x-btn-vague x-fs-14 x-ff-mh x-full" data-pmg="{{pmg}}" type="button" data-item="book">{{local "booking.checkout"}}</button>\r\n</div>\r\n{{#if roomsOfUnits}}\r\n    <div class="x-ml-23 x-mr-23 x-pt-10 x-pb-20 x-mt-20">\r\n        <span class="x-fs-12 x-lh-12 x-fc-green">\r\n            {{local "booking.rooms_of_units"}}\r\n        </span>\r\n    </div>\r\n{{/if}}\r\n<div class="x-ml-23 x-mr-23 x-pt-10 x-pb-20">\r\n    {{#if payment}}\r\n        <span class="x-fs-12 x-lh-12 x-fc-green">\r\n            {{local "booking.summary_prompt_payment"}}\r\n        </span>\r\n    {{else}}\r\n        <span class="x-fs-12 x-lh-12 x-fc-green">\r\n            {{local "booking.summary_prompt"}}\r\n        </span>\r\n    {{/if}}\r\n</div>\r\n\r\n'},{}],231:[function(e,i,a){var t=(e("underscore"),e("backbone")),r=e("backbone.marionette"),n=e("./item/view");i.exports=r.CollectionView.extend({childView:n,childViewOptions:function(e,i){return{model:e,index:i,total:this.collection.length,rootState:this.options.rootState,expandAll:!1}},initialize:function(){var e=this,i=e.options.rootState,a=e.__getSummary();e.collection=new t.Collection(a),e.listenTo(i,"turnUpgradeRate",e.changePartCount)},changePartCount:function(){this.collection.set(this.__getSummary())},__getSummary:function(){return this.options.rootState.getSummary()}})},{"./item/view":230,backbone:8,"backbone.marionette":6,underscore:42}],230:[function(e,i,a){function t(e,i){return s.map(s.filter(s.map(e,function(e){return{inventorycode:e.inventorycode,avgdisplayrate:e.avgdisplayrate,avgcostpoints:e.avgcostpoints,quantity:i.getStayCount({key:e.key,categoryid:e.categoryid})||0}}),function(e){return e.quantity>0}),function(e){return{inventorycode:e.inventorycode,quantity:e.quantity,avgdisplayrate:e.quantity*parseFloat(e.avgdisplayrate),avgcostpoints:e.quantity*parseFloat(e.avgcostpoints)}})}function r(e,i,a,t){var r=s.has(i,"memberrate")&&s.has(i,"avgdisplaypoints");return e=s.uniq(e,function(e){return e.bedtype}),e=s.map(e,function(e){var n=e.bedtype,o=e.bedtypeicon,s=parseFloat(e.memberrate),l=parseFloat(e.avgdisplaypoints),c=e.bedtype===i.bedtype;if(r&&!c)if(t){var d=l-parseFloat(i.avgdisplaypoints);d&&(n=Handlebars.compile("{{bedtype}} ({{operator}}{{num-format difference}})")({bedtype:n,currency:a,operator:d>0?"+":"-",difference:Math.abs(d)}))}else{var d=s-parseFloat(i.memberrate);d&&(n=Handlebars.compile("{{bedtype}} ({{operator}}{{currency}}{{price-format difference}})")({bedtype:n,currency:a,operator:d>0?"+":"-",difference:Math.abs(d)}))}return{bedtext:n,bedtype:e.bedtype,bedtypeicon:o,highlight:c}})}function n(e){return s.findWhere(x,e)||{item1:!0}}function o(e,i){var a=s.findIndex(x,e);-1!==a?x[a]=i:x.push(s.assign(e,i))}var s=e("underscore"),l=e("backbone.marionette"),c=e("../../../../06-popping/view"),d=e("../../../../common/popup"),p=e("../../../../stores"),m=e("../../../../../ui/util"),x=[];i.exports=l.ItemView.extend({template:Handlebars.compile(e("./template.hbs")),ui:{list:".book2-summary-listing",type:"[data-item='type']",rate:"[data-item='rate']",stay:"[data-item='stay']",beds:"[data-item='beds']",item:"[data-item='item']",error:"[data-item='error']",popup:"[data-item='popup']",adult:"[data-item='adult']",child:"[data-item='child']",target:"[data-item='target']",special:"[data-item='special']",roomname:"[data-item='roomname']",instant:"[data-item='instant']"},events:{"click @ui.type":function(){this.options.expandAll=!this.options.expandAll,this.render()},"click @ui.rate":function(){var e=this,i=e.options.rootState;i.trigger("showLampBoxRate",e.model.toJSON()),i.trigger("lightBoxAnimate",e.ui.rate.offset())},"click @ui.stay":function(){var e=this,i=e.options.rootState,a=e.model.toJSON();a.voucherusage&&(upgradeObject=i.getUpgradeRateByRate({categoryid:a.categoryid,roomtypecode:a.roomtypecode,ratecode:a.ratecode,roomid:a.roomid}),upgradeObject&&(a=upgradeObject.roomrate||a)),i.trigger("showLampBoxStay",a),i.trigger("lightBoxAnimate",e.ui.stay.offset())},"click @ui.instant":function(){var e=this,i=e.options.rootState;i.trigger("loadIGVouchers",e.model.toJSON())},"click @ui.beds":function(e){var i=this,a=i.model.toJSON(),t=i.options.rootState,r=jQuery(e.currentTarget).attr("data-bed-type"),l=t.getRates({categoryid:a.categoryid,ratecode:a.ratecode,bedtype:r}),c=null,d=null;l.length&&(c=l[0],d=n({roomtypecode:a.roomtypecode,ratecode:a.ratecode,roomid:a.roomid}),o({roomtypecode:c.roomtypecode,ratecode:c.ratecode,roomid:c.roomid},s.assign({},d,{roomtypecode:c.roomtypecode,ratecode:c.ratecode,roomid:c.roomid})),t.isStyle(t.VIEW_STYLES.HOTEL_BY_ROOM)&&t.setAllah({categoryid:c.categoryid,roomtypecode:c.roomtypecode,ratecode:c.ratecode,roomid:c.roomid}),t.isStyle(t.VIEW_STYLES.HOTEL_BY_ALL)&&t.setAllah({categoryid:c.categoryid,roomtypecode:c.roomtypecode,ratecode:c.ratecode,roomid:c.roomid,byAll:!0}),t.isStyle(t.VIEW_STYLES.HOTEL_BY_RATE)&&t.setAllah({roomtypecode:c.roomtypecode,ratecode:c.ratecode,roomid:c.roomid}),t.trigger("loadStaysByRate",c))},"click @ui.item":function(e){var i=this.model.toJSON(),a=jQuery(e.currentTarget),t=a.closest(".book2-summary-listing"),r=t.attr("data-state");this.ui.error.hide(),t.hasClass("holds")?(t.removeClass("holds"),o({roomtypecode:i.roomtypecode,ratecode:i.ratecode,roomid:i.roomid},s.object([[r,!1]]))):(t.addClass("holds"),o({roomtypecode:i.roomtypecode,ratecode:i.ratecode,roomid:i.roomid},s.object([[r,!0]])))},"mouseenter @ui.popup":function(e){e.stopPropagation(),this.ui.target.has(":visible").length&&d.addPopupTip(this,c.TIPSHORT,this.model.toJSON(),this.ui.target.has(":visible"),!1,!0)},"mouseleave @ui.popup":function(e){e.stopPropagation(),d.delPopupTip()},"input @ui.special":function(){var e=this,i=e.model.toJSON(),a=e.options.rootState,t={categoryid:i.categoryid,roomtypecode:i.roomtypecode,ratecode:i.ratecode,roomid:i.roomid,specialrequests:e.ui.special.val()};a.changeRateValue(t)},"mouseenter @ui.roomname":function(e){},"mouseleave @ui.roomname":function(e){}},serializeData:function(){var e=this,i=null,a=e.model.toJSON(),o=e.options.rootState,l=o.getRooms({id:a.categoryid}),c=m.getUser().attributes;e.userPoints=c.points&&c.points.balance,l.length&&(i=l[0]);var d,x=a.voucherusage;a.voucherusage&&(d=o.getUpgradeRateByRate({categoryid:a.categoryid,roomtypecode:a.roomtypecode,ratecode:a.ratecode,roomid:a.roomid}),d&&(a=d.roomrate||a,i=d.roomtype||i));var f=t(o.getStays({categoryid:a.categoryid,roomtypecode:a.roomtypecode,ratecode:a.ratecode,roomid:a.roomid}),o),u=parseFloat(a.displaymemberrate)+s.reduce(f,function(e,i){return e+i.displayrate},0),h=parseFloat(a.displaypoints)+s.reduce(f,function(e,i){return e+i.costpoints},0),g=p.getIGVouchersList();return g.length&&(g=s.filter(g,function(e){return e.checked})),{isLogin:o.isLogin(),isFinal:o.isFinal(),isUseMoney:o.isTrade(o.VIEW_TRADES.USE_MONEY),isUsePoint:o.isTrade(o.VIEW_TRADES.USE_POINT),maxchildage:o.getMaxChildAge(),currency:o.getCurrency(),index:e.options.index+1,total:e.options.total,type:i&&i.type,bedtypes:r(a&&!a.voucherusage?o.getRates({categoryid:a.categoryid,ratecode:a.ratecode}):i.availability?i.bedtypes:[],a,o.getCurrency(),o.isTrade(o.VIEW_TRADES.USE_POINT)),cancelpenalty:a.cancelpenalty,shortpolicy:a.shortpolicy,ratename:a.ratename,roomstay:a.roomstay,tipshort:a.tipshort,bedtype:a.bedtype,desc:a.desc,memberrate:parseFloat(a.memberrate),points:parseFloat(a.avgdisplaypoints),ratesaved:parseFloat(a.ratesaved),pointssaved:parseFloat(a.pointssaved),specialrequests:a.specialrequests||"",services:f,totalPrice:u,totalPoint:h,showIG:o.isLogin()&&!!(e.userPoints>=3e3)&&o.getHotel().hasbookingrewards,expandAll:e.options.expandAll,itemState:n({roomtypecode:a.roomtypecode,ratecode:a.ratecode,roomid:a.roomid}),voucherusage:x,upgradeObject:d,roomcount:o.getParam().rooms||1,multiple:parseInt(o.getParam().rooms)>1,IGItems:g}},initialize:function(){var e=this,i=e.options.rootState;e.__renderDeferred=jQuery.Deferred(),e.listenTo(i,"redrawViewChild",this.redrawViewChild),e.listenTo(i,"changePartCount",this.changePartCount),e.listenTo(i,"loyaltyRoomUpgrade",this.changePartCount),e.listenTo(i,"updateIGState",this.redrawViewChild)},onRender:function(){this.__renderDeferred.resolve()},redrawViewChild:function(e){return this.__renderDeferred.then(jQuery.proxy(this.__redrawViewChild,this,e))},changePartCount:function(e){return this.__renderDeferred.then(jQuery.proxy(this.__changePartCount,this,e))},__redrawViewChild:function(){this.render()},__changePartCount:function(e){var i=this.options.rootState,a=this.model.toJSON();a.voucherusage&&(upgradeObject=i.getUpgradeRateByRate({categoryid:a.categoryid,roomtypecode:a.roomtypecode,ratecode:a.ratecode,roomid:a.roomid}),upgradeObject&&(a=upgradeObject.roomrate||a)),a.roomtypecode===e.roomtypecode&&a.ratecode===e.ratecode&&a.roomid===e.roomid&&(a.voucherusage||this.model.set(e),this.render())}})},{"../../../../../ui/util":2122,"../../../../06-popping/view":343,"../../../../common/popup":348,"../../../../stores":356,"./template.hbs":229,"backbone.marionette":6,underscore:42}],356:[function(e,i,a){function t(e){return-1!==f.findIndex(y,e)}function r(e){y.push(e)}function n(e,i){return t(e)?m({}):(r(e),i())}function o(e){return f.object(f.filter(f.map(e.slice(1).split("&"),function(e){return f.map(e.split("="),function(e){return decodeURIComponent(e.replace("+","%20"))})}),function(e){return 2===e.length}))}function s(e,i){return new Date(e.getFullYear(),e.getMonth(),e.getDate()+i)}function l(e){return function(i){return f.assign(i,{roomid:e.roomid})}}function c(e){return function(i){return f.assign(i,{code:e.promocode})}}function d(e){return function(i){return f.assign(i,{code:e.groupcode})}}function p(e){return function(i){return f.assign(i,{code:e.discountcode})}}function m(e){var i=jQuery.Deferred();return i.resolve(e),i.promise()}function x(e){var i=jQuery.Deferred();return i.reject(e),i.promise()}var f=e("underscore"),u=e("moment"),h=e("./storage/book"),g=e("./storage/cart"),v=e("./storage/code"),_="YYYY-MM-DD",y=[],b=0,w=1,k=2,S=3,V=4,P=5,R=6,C=7,T=8,A=[];i.exports={VIEW_TYPE:{VILLE:"destination",GROUP:"group",HOTEL:"hotel"},delCache:function(){y=[]},toShoppingCart:function(e){var i={fromrate:e.fromrate,isusesignup:e.isusesignup,checkin:u(e.param.checkin).format(_),checkout:u(e.param.checkout).format(_),adults:e.param.adults||1,children:e.param.children||0,rooms:e.param.rooms||1,currency:e.currency,currencymark:e.currencymark,hotelcode:e.value.hotelcode,promocode:e.value.promocode,groupcode:e.value.groupcode,discountcode:e.value.discountcode,ratecode:e.value.ratecode,roomtype:e.value.roomtypecode,roomid:e.value.roomid,AAA:!(!e.param.isAmerican||!e.param.AAA),AARP:!(!e.param.isAmerican||!e.param.AARP),GOV:!(!e.param.isAmerican||!e.param.GOV),Accessible:!(!e.param.Accessible||!e.param.AccessibleRoom),servicedata:f.map(e.services,function(e){return f.omit(e,["hotelcode","categoryid","roomtypecode","ratecode","roomid"])}),voucherusage:e.value.loyaltyroomupgradeusage?1:0,specialrequests:e.value.specialrequests||"",upgradespecified:0,isroomupgrade:!!e.value.voucherusage,islowest:!!e.value.islowest,upgradedroomtypecode:e.upgraderate&&e.upgraderate.roomtypecode,upgradedrateplancode:e.upgraderate&&e.upgraderate.ratecode,pointsupgraderebuilddays:e.pointsupgraderebuilddays||0,redeemrewards:e.redeemrewards||[]};return g.toShoppingCart(i)},setSearchParam:function(e,i){var a={};e.type===this.VIEW_TYPE.HOTEL&&(a.hotelcode=e.code),e.type===this.VIEW_TYPE.GROUP&&(a.groupHotel=e.code),e.type===this.VIEW_TYPE.VILLE&&(a.city=e.code),e.checkin&&(a.checkin=u(e.checkin).format(_)),e.checkout&&(a.checkout=u(e.checkout).format(_)),a=f.assign(a,{discountcode:e.discountcode||"",groupcode:e.groupcode||"",promocode:e.promocode||"",adults:e.adults||1,children:e.children||0,rooms:e.rooms||1,AAA:!(!e.isAmerican||!e.AAA),AARP:!(!e.isAmerican||!e.AARP),GOV:!(!e.isAmerican||!e.GOV),Accessible:!!e.Accessible}),e.viewrates&&(a.viewrates=e.viewrates);var t=location.protocol+"//"+location.host+location.pathname+"?"+jQuery.param(a);return window.history&&window.history.pushState&&i?(window.history.pushState(null,null,t),m(t)):x(t)},getSearchParam:function(){function e(e,i){return f.isString(e)&&e.toLowerCase()===i}var i=f.assign(o(location.hash||""),o(location.search||""));i.promocode=i.promo=i.promocode||i.promo;var a=i.hotelcode,t=i.city,r=i.groupHotel,n=i.categoryid,l=i.ratecode,c=u(i.checkin,_).toDate(),d=u(i.checkout,_).toDate(),p=s(new Date,0);(a||t||r)&&(isNaN(+c)||p>c)&&(c=s(new Date,0)),(a||t||r)&&(isNaN(+d)||c>=d)&&(d=s(c,1));var m={defaultRoom:n,defaultRate:l,code:a||t||r,type:a?this.VIEW_TYPE.HOTEL:t?this.VIEW_TYPE.VILLE:r?this.VIEW_TYPE.GROUP:"",checkin:isNaN(+c)?null:c,checkout:isNaN(+d)?null:d,discountcode:i.discountcode||"",groupcode:i.groupcode||"",promocode:i.promocode||"",adults:i.adults||1,children:i.children||0,rooms:i.rooms||1,AAA:"true"==i.AAA,AARP:"true"==i.AARP,GOV:"true"==i.GOV,Accessible:"true"==i.Accessible,calendarFirst:"true"==i.rateCalendar,viewrates:e(i.viewrates,"all")?"All":e(i.viewrates,"rooms")?"Rooms":e(i.viewrates,"rates")?"Rates":null,pricestyle:1};return m},getSimpleVille:function(e){var i={checkin:u(e.param.checkin).format(_),checkout:u(e.param.checkout).format(_),discountcode:e.param.discountcode||"",groupcode:e.param.groupcode||"",promo:e.param.promocode||"",promocode:e.param.promocode||"",adults:e.param.adults||1,children:e.param.children||0,rooms:e.param.rooms||1,AAA:!(!e.param.isAmerican||!e.param.AAA),AARP:!(!e.param.isAmerican||!e.param.AARP),GOV:!(!e.param.isAmerican||!e.param.GOV),Accessible:!(!e.param.Accessible||!e.param.AccessibleRoom),price:!1,iscompareratecalendar:!0,pricestyle:1};return e.param.type===this.VIEW_TYPE.GROUP?(i.group=e.param.code,h.getHotelsByGroup(i)):(i.city=e.param.code,h.getHotelsByVille(i))},getIntactVille:function(e){var i={checkin:u(e.param.checkin).format(_),checkout:u(e.param.checkout).format(_),discountcode:e.param.discountcode||"",groupcode:e.param.groupcode||"",promo:e.param.promocode||"",promocode:e.param.promocode||"",adults:e.param.adults||1,children:e.param.children||0,rooms:e.param.rooms||1,AAA:!(!e.param.isAmerican||!e.param.AAA),AARP:!(!e.param.isAmerican||!e.param.AARP),GOV:!(!e.param.isAmerican||!e.param.GOV),Accessible:!(!e.param.Accessible||!e.param.AccessibleRoom),price:!0,iscompareratecalendar:!0,pricestyle:1};return e.param.type===this.VIEW_TYPE.GROUP?(i.group=e.param.code,h.getHotelsByGroup(i)):(i.city=e.param.code,h.getHotelsByVille(i))},getHotelDetail:function(e){var i={hotelcode:e.param.code};return h.getHotelDetails(i)},getBookingCart:function(){return h.getBookingCartData()},getSimpleRooms:function(e){var i={hotelcode:e.param.code,checkin:u(e.param.checkin).format(_),checkout:u(e.param.checkout).format(_),discountcode:e.param.discountcode||"",groupcode:e.param.groupcode||"",promo:e.param.promocode||"",promocode:e.param.promocode||"",adults:e.param.adults||1,children:e.param.children||0,rooms:e.param.rooms||1,AAA:!(!e.param.isAmerican||!e.param.AAA),AARP:!(!e.param.isAmerican||!e.param.AARP),GOV:!(!e.param.isAmerican||!e.param.GOV),Accessible:!(!e.param.Accessible||!e.param.AccessibleRoom),price:!1,pricestyle:1};return n({type:b,code:e.param.code},function(){return h.getRoomsByHotel(i)})},getIntactRooms:function(e){var i={hotelcode:e.param.code,checkin:u(e.param.checkin).format(_),checkout:u(e.param.checkout).format(_),discountcode:e.param.discountcode||"",groupcode:e.param.groupcode||"",promo:e.param.promocode||"",promocode:e.param.promocode||"",adults:e.param.adults||1,children:e.param.children||0,rooms:e.param.rooms||1,AAA:!(!e.param.isAmerican||!e.param.AAA),AARP:!(!e.param.isAmerican||!e.param.AARP),GOV:!(!e.param.isAmerican||!e.param.GOV),Accessible:!(!e.param.Accessible||!e.param.AccessibleRoom),price:!0,pricestyle:1};return n({type:w,code:e.param.code},function(){return h.getRoomsByHotel(i)})},getAllRoomsAllRates:function(e){var i={hotelcode:e.param.code,checkin:u(e.param.checkin).format(_),checkout:u(e.param.checkout).format(_),discountcode:e.param.discountcode||"",groupcode:e.param.groupcode||"",promo:e.param.promocode||"",promocode:e.param.promocode||"",adults:e.param.adults||1,children:e.param.children||0,rooms:e.param.rooms||1,AAA:!(!e.param.isAmerican||!e.param.AAA),AARP:!(!e.param.isAmerican||!e.param.AARP),GOV:!(!e.param.isAmerican||!e.param.GOV),Accessible:!(!e.param.Accessible||!e.param.AccessibleRoom),price:!0,pricestyle:1};return n({type:C,code:e.param.code},function(){return h.getAllRoomsAllRates(i)})},getEntireRates:function(e){var i={hotelcode:e.param.code,checkin:u(e.param.checkin).format(_),checkout:u(e.param.checkout).format(_),discountcode:e.param.discountcode||"",groupcode:e.param.groupcode||"",promo:e.param.promocode||"",promocode:e.param.promocode||"",adults:e.param.adults||1,children:e.param.children||0,rooms:e.param.rooms||1,AAA:!(!e.param.isAmerican||!e.param.AAA),AARP:!(!e.param.isAmerican||!e.param.AARP),GOV:!(!e.param.isAmerican||!e.param.GOV),Accessible:!(!e.param.Accessible||!e.param.AccessibleRoom),pricestyle:1};return n({type:k,code:e.param.code},function(){return h.getRatesByCode(i)})},getRateCalendar:function(e){var i={hotelcode:e.param.code};return n({type:R,code:e.param.code},function(){return h.getRateCalendar(i)})},getEntireStays:function(e){var i={hotelcode:e.param.code,rateplancode:e.value.ratecode,roomtypecode:e.value.roomtypecode,checkin:u(e.param.checkin).format(_),checkout:u(e.param.checkout).format(_),discountcode:e.param.discountcode||"",groupcode:e.param.groupcode||"",promo:e.param.promocode||"",promocode:e.param.promocode||"",adults:e.param.adults||1,children:e.param.children||0,rooms:e.param.rooms||1,AAA:!(!e.param.isAmerican||!e.param.AAA),AARP:!(!e.param.isAmerican||!e.param.AARP),GOV:!(!e.param.isAmerican||!e.param.GOV),Accessible:!(!e.param.Accessible||!e.param.AccessibleRoom),pricestyle:1};return n({type:S,code:e.param.code,arg1:e.value.roomid,arg2:e.value.ratecode,arg3:e.value.roomtypecode},function(){return h.getStaysByRate(i).then(l(e.value))})},getRatesByRoom:function(e,i){var a={categoryid:e.value.categoryid,hotelcode:e.param.code,checkin:u(e.param.checkin).format(_),checkout:u(e.param.checkout).format(_),discountcode:e.param.discountcode||"",groupcode:e.param.groupcode||"",promo:e.param.promocode||"",promocode:e.param.promocode||"",adults:e.param.adults||1,children:e.param.children||0,rooms:e.param.rooms||1,AAA:!(!e.param.isAmerican||!e.param.AAA),AARP:!(!e.param.isAmerican||!e.param.AARP),GOV:!(!e.param.isAmerican||!e.param.GOV),Accessible:!(!e.param.Accessible||!e.param.AccessibleRoom),pricestyle:1};return n({type:V,code:e.param.code,arg1:e.value.categoryid},function(){return h.getRatesByRoom(a)})},getRatesByCode:function(e){var i={ratecode:e.value.ratecode,hotelcode:e.param.code,checkin:u(e.param.checkin).format(_),checkout:u(e.param.checkout).format(_),discountcode:e.param.discountcode||"",groupcode:e.param.groupcode||"",promo:e.param.promocode||"",promocode:e.param.promocode||"",adults:e.param.adults||1,children:e.param.children||0,rooms:e.param.rooms||1,AAA:!(!e.param.isAmerican||!e.param.AAA),AARP:!(!e.param.isAmerican||!e.param.AARP),GOV:!(!e.param.isAmerican||!e.param.GOV),Accessible:!(!e.param.Accessible||!e.param.AccessibleRoom),pricestyle:1};return n({type:P,code:e.param.code,arg1:e.value.ratecode},function(){return h.getRatesByCode(i)})},getUpgradeRate:function(e){var i={hotelcode:e.param.code,rateplancode:e.value.ratecode,roomtypecode:e.value.roomtypecode,checkin:u(e.param.checkin).format(_),checkout:u(e.param.checkout).format(_),discountcode:e.param.discountcode||"",groupcode:e.param.groupcode||"",promo:e.param.promocode||"",promocode:e.param.promocode||"",adults:e.param.adults||1,children:e.param.children||0,rooms:e.param.rooms||1,AAA:!(!e.param.isAmerican||!e.param.AAA),AARP:!(!e.param.isAmerican||!e.param.AARP),GOV:!(!e.param.isAmerican||!e.param.GOV),Accessible:!(!e.param.Accessible||!e.param.AccessibleRoom),isroomupgrade:!0,pricestyle:0,pointsupgrademinuspoints:e.pointsupgrademinuspoints||0};return n({type:T,code:e.param.code,arg1:e.value.roomid,arg2:e.value.ratecode,arg3:e.value.roomtypecode,arg4:e.pointsupgrademinuspoints},function(){return h.getUpgradeRate(i)})},getIGVouchers:function(){if(A.length)return m(A);var e=f.assign(o(location.hash||""),o(location.search||"")),i={hotelid:e&&e.hotelcode};return h.getIGVouchers(i)},getIGVouchersList:function(){return A},setIGVouchersList:function(e){A=e},retrieveByKey:function(e){return v.retrieveByKey({keyword:e})},validateDisco:function(e){var i={discountcode:e.discountcode,hotelcode:e.code,localdate:u().format(_),checkin:u(e.checkin).format(_),checkout:u(e.checkout).format(_),adults:e.adults||1,children:e.children||0,rooms:e.rooms||1};return v.validateDisco(i).then(p(e))},validateGroup:function(e){var i={groupcode:e.groupcode,hotelcode:e.code};return v.validateGroup(i).then(d(e))},validatePromo:function(e){var i={promocode:e.promocode,hotelcode:e.code};return v.validatePromo(i).then(c(e))}}},{"./storage/book":353,"./storage/cart":354,"./storage/code":355,moment:16,underscore:42}],355:[function(e,i,a){function t(e){var i=jQuery.Deferred();return i.resolve(e),i.promise()}var r=(e("underscore"),e("../../../../config/host")),n=null,o=null,s=null,l=null;i.exports={retrieveByKey:function(e){return n&&n.abort(),n=jQuery.getJSON(r.getURL("api","book2/search"),e),n.then(function(e){return t(e.success?[].concat(e.data.hotel,e.data.city):[])})},validatePromo:function(e){return o&&o.abort(),o=jQuery.getJSON(r.getURL("api","promocheck"),e),o.then(function(e){return t({valid:e.valid,message:e.message||i18n.t(e.valid?"booking.promocode_valid":"booking.promocode_invalid")})},function(){return t({valid:!1,message:i18n.t("general.network_error")})})},validateGroup:function(e){return s&&s.abort(),s=jQuery.getJSON(r.getURL("api","groupcodecheck"),e),s.then(function(e){return t({valid:e.valid,message:e.message||i18n.t(e.valid?"booking.groupcode_valid":"booking.groupcode_invalid")
})},function(){return t({valid:!1,message:i18n.t("general.network_error")})})},validateDisco:function(e){return l&&l.abort(),l=jQuery.getJSON(r.getURL("api","discountcodecheck"),e),l.then(function(e){return t({valid:e.valid,message:e.message||i18n.t(e.valid?"booking.discount_code_valid":"booking.discount_code_invalid")})},function(){return t({valid:!1,message:i18n.t("general.network_error")})})}}},{"../../../../config/host":45,underscore:42}],354:[function(e,i,a){function t(e){var i=jQuery.Deferred();return i.resolve(e),i.promise()}function r(e){var i=jQuery.Deferred();return i.reject(e),i.promise()}var n=e("../../../../config/host");i.exports={toShoppingCart:function(e){return jQuery.ajax({url:n.getURL("mapi","roombooking/add"),type:"POST",data:JSON.stringify(e),contentType:"application/json; charset=utf-8",processData:!1,dataType:"json"}).then(function(e){return e.success?t("/"+n.getLanguage()+"/checkout"):r(e)},function(){return i18n.t("general.network_error")})}}},{"../../../../config/host":45}],229:[function(e,i,a){i.exports='<div class="x-mt-20">\r\n    <span class="x-fs-12 x-ff-mh x-fc-black x-upper">{{ roomcount }} {{local "booking.room_and_rooms"}}</span>\r\n    <!--<span class="x-fs-12 x-ff-mh x-fc-black x-upper">{{local "booking.room"}} {{local "checkout.confirmation_of" index total}}</span>-->\r\n</div>\r\n\r\n<div class="x-mt-10">\r\n    <div class="x-flex x-pointer" data-item="type">\r\n        <span class="x-cell x-al-l" style="vertical-align: top;">\r\n            <div class="x-fs-20 x-ff-wb" data-item="roomname">{{type}}</div>\r\n        </span>\r\n        {{#if expandAll}}\r\n            <span class="x-cell x-al-r x-delta x-under" style="width: 10rem; vertical-align: top;">{{local "checkout.hide_details"}}</span>\r\n        {{else}}\r\n            <span class="x-cell x-al-r x-delta x-under down" style="width: 10rem; vertical-align: top;">{{local "checkout.see_details"}}</span>\r\n        {{/if}}\r\n    </div>\r\n    {{#if voucherusage}}\r\n        <div class="mm2-rup-summary-caption">\r\n            <span class="icon-icon_I009"></span>\r\n            <span>{{local \'rup.room_upgrade_applied\'}}</span>\r\n        </div>\r\n    {{/if}}\r\n</div>\r\n\r\n{{#if expandAll}}\r\n    <div class="x-mt-10">\r\n        {{#if multiple}}\r\n            <div class="book2-summary-listing holds">\r\n                <div class="x-fs-12 x-ff-mh x-mt-08">{{local "booking.per_room_price_shown_below"}}</div>\r\n            </div>\r\n        {{/if}}\r\n        <div class="book2-summary-listing holds">\r\n            <div class="x-flex">\r\n                <span class="x-cell x-al-l x-fs-12 x-ff-mh x-fc-black x-upper">{{local "checkout.rate_selection"}}</span>\r\n            <span class="x-cell x-al-r">\r\n                <span class="x-fs-00 x-nowrap x-pointer" data-item="rate">\r\n                    <span class="x-fs-12 x-fc-azure x-di x-di-v-m icon-icon_J006"></span>\r\n                    <span class="x-fs-12 x-fc-azure x-di x-di-v-m x-ff-wm x-none x-ml-04 x-under">{{local "checkout.edit"}}</span>\r\n                </span>\r\n            </span>\r\n            </div>\r\n            <div class="x-flex x-mt-10">\r\n                <span class="x-cell x-al-l x-fs-14 x-ff-wm">{{ratename}}</span>\r\n                {{#if isUseMoney}}\r\n                    {{#if memberrate}}\r\n                        <span class="x-cell x-al-r x-fs-12 x-ff-sm x-upper">{{currency}} {{price-format memberrate}}</span>\r\n                    {{/if}}\r\n                {{/if}}\r\n                {{#if isUsePoint}}\r\n                    {{#if points}}\r\n                        <span class="x-cell x-al-r x-fs-12 x-ff-sm x-upper">{{num-format points}}</span>\r\n                    {{/if}}\r\n                {{/if}}\r\n            </div>\r\n            {{#if shortpolicy}}\r\n                <div class="book2-information x-mt-04 x-pl-10 x-fs-13 x-ff-sm x-mt-04">\r\n                    {{{shortpolicy}}}\r\n                </div>\r\n                <div class="x-mt-08">\r\n                    <span class="x-default" data-item="target">\r\n                        <span class="x-fs-12 x-ff-mh x-fc-azure x-upper" style="font-size: 1.1rem" data-item="popup">{{local "maps.see_details"}}</span>\r\n                    </span>\r\n                </div>\r\n            {{/if}}\r\n            {{#if upgradeObject}}\r\n                <div class="x-flex x-mt-10">\r\n                    <span class="x-cell x-al-l x-fs-12 x-ff-sm x-f-upper" style="color: #363636">{{local \'rup.points_redeemed\'}}</span>\r\n                    <span class="x-cell x-al-r x-fs-12 x-ff-sm">{{num-format upgradeObject.upgradeddifference.avgtopprice.avgtoppoints}} {{local \'general.points_lower\'}}</span>\r\n                </div>\r\n            {{/if}}\r\n        </div>\r\n\r\n        <div data-state="item3"\r\n            {{#if itemState.item3}}\r\n             class="book2-summary-listing holds"\r\n            {{else}}\r\n             class="book2-summary-listing"\r\n            {{/if}}>\r\n            <div class="x-flex">\r\n                <span class="x-cell x-al-l x-fs-12 x-ff-mh x-fc-black x-upper">{{local "checkout.bed_type"}}</span>\r\n            <span class="x-cell x-al-r">\r\n                <span class="x-fs-00 x-nowrap x-pointer" data-item="item">\r\n                    <span class="x-fs-12 x-fc-azure x-di x-di-v-m icon-icon_J006"></span>\r\n                    <span class="x-fs-12 x-fc-azure x-di x-di-v-m x-ff-wm x-none x-ml-04 x-under">{{local "checkout.edit"}}</span>\r\n                </span>\r\n            </span>\r\n            </div>\r\n            <div class="x-mt-10 x-fs-00 x-show">\r\n                <span class="x-fs-14 x-ff-wm">{{bedtype}}</span>\r\n            </div>\r\n            {{#each bedtypes}}\r\n                <div class="x-mt-10 x-fs-00 x-hide">\r\n                    {{#if highlight}}\r\n                        <div class="x-di">\r\n                            <span class="x-di x-di-v-m x-fs-14 x-check x-check-sm checked x-fc-azure"></span>\r\n                            <span class="x-di x-di-v-m x-fs-14 x-ff-wm x-ml-08 x-under">{{bedtext}}</span>\r\n                        </div>\r\n                    {{else}}\r\n                        <div class="x-di" data-bed-type="{{bedtype}}" data-item="beds">\r\n                            <span class="x-di x-di-v-m x-fs-14 x-pointer x-check x-check-sm x-fc-azure"></span>\r\n                            <span class="x-di x-di-v-m x-fs-14 x-pointer x-ff-wm x-ml-08 x-under">{{bedtext}}</span>\r\n                        </div>\r\n                    {{/if}}\r\n                </div>\r\n            {{/each}}\r\n        </div>\r\n\r\n        <div class="book2-summary-listing">\r\n            <div class="x-flex">\r\n                <span class="x-cell x-al-l x-fs-12 x-ff-mh x-fc-black x-upper">{{local "checkout.add_ons"}}</span>\r\n            <span class="x-cell x-al-r">\r\n                <span class="x-fs-00 x-nowrap x-pointer" data-item="stay">\r\n                    <span class="x-fs-12 x-fc-azure x-di x-di-v-m icon-icon_J006"></span>\r\n                    <span class="x-fs-12 x-fc-azure x-di x-di-v-m x-ff-wm x-none x-ml-04 x-under">{{local "checkout.edit"}}</span>\r\n                </span>\r\n            </span>\r\n            </div>\r\n            {{#each services}}\r\n                <div class="x-flex x-mt-10">\r\n                <span class="x-cell x-al-l x-fs-14 x-ff-wm">\r\n                    <span class="x-di x-di-v-m book2-summary-add-ons">{{inventorycode}}</span>\r\n                    <span class="x-di x-di-v-m x-ml-04">(x{{quantity}})</span>\r\n                </span>\r\n                    {{#if ../isUseMoney}}\r\n                        <span class="x-cell x-al-r x-fs-12 x-ff-sm x-upper">{{../../currency}} {{price-format avgdisplayrate}}</span>\r\n                    {{/if}}\r\n                    {{#if ../isUsePoint}}\r\n                        <span class="x-cell x-al-r x-fs-12 x-ff-sm x-upper">{{num-format avgcostpoints}}</span>\r\n                    {{/if}}\r\n                </div>\r\n            {{/each}}\r\n        </div>\r\n\r\n        <div class="book2-summary-listing">\r\n            <div>\r\n                <span class="x-fs-12 x-ff-mh x-fc-black x-upper">{{local "checkout.special_requests"}}</span>\r\n            </div>\r\n            <div class="x-mt-10 x-fs-00 x-nowrap">\r\n                {{#if specialrequests}}\r\n                    <label class="x-fs-12 x-ff-sm x-di x-di-v-t x-water x-pt-08" style="text-indent: 5px">{{local "booking.special_assistance_etc"}}</label>\r\n                {{else}}\r\n                    <label class="x-fs-12 x-ff-sm x-di x-di-v-t x-water x-pt-08" style="text-indent: 5px; display: inline-block">{{local "booking.special_assistance_etc"}}</label>\r\n                {{/if}}\r\n                <textarea class="x-fs-12 x-ff-sm x-di x-di-v-t x-input x-input-multi x-normal x-full" rows="4" maxlength="150" data-item="special">{{specialrequests}}</textarea>\r\n            </div>\r\n        </div>\r\n\r\n        <!--\r\n        <div class="book2-summary-listing">\r\n            <div class="x-flex">\r\n                <span class="x-cell x-fs-12 x-ff-mh x-upper">{{local "checkout.total_charge_all"}}</span>\r\n                {{#if isUseMoney}}\r\n                    <span class="x-cell x-al-r x-fs-14 x-ff-wm x-upper">{{currency}} {{price-format totalPrice}}</span>\r\n                {{/if}}\r\n                {{#if isUsePoint}}\r\n                    <span class="x-cell x-al-r x-fs-14 x-ff-wm x-upper">{{num-format totalPoint}}</span>\r\n                {{/if}}\r\n            </div>\r\n        </div>\r\n        -->\r\n\r\n    </div>\r\n{{/if}}\r\n{{#if showIG}}\r\n    <div class="mm2-ig-block">\r\n        <p class="mm2-ig-block-title">{{local \'rup.claim_rewards\'}}</p>\r\n        {{#if IGItems}}\r\n            <div class="x-flex x-fs-00 x-pointer x-mt-16">\r\n                <div class="x-cell x-al-l">\r\n                    <span class="x-fs-12 x-lh-14 x-fc-azure x-di x-di-v-m x-upper x-ff-mh xx-none">{{local \'rup.instant_redemption\'}}</span>\r\n                </div>\r\n                <div class="x-cell x-al-r">\r\n                <span class="x-fs-00 x-nowrap x-pointer">\r\n                    <span class="x-fs-12 x-fc-azure x-di x-di-v-m icon-icon_J006"></span>\r\n                    <span class="x-fs-12 x-fc-azure x-di x-di-v-m x-ff-wm x-none x-ml-04 x-under" data-item="instant">{{local "checkout.edit"}}</span>\r\n                </span>\r\n                </div>\r\n            </div>\r\n            {{#each IGItems}}\r\n                <p class="mm2-ig-block-name">{{title}}</p>\r\n                <div class="x-flex x-fs-00 x-pointer x-mt-08">\r\n                    <div class="x-cell x-al-l">\r\n                        <span class="x-fs-12 x-lh-14 x-fc-l-grey x-di x-di-v-m x-f-upper x-ff-sm xx-none">{{local \'rup.points_redeemed\'}}</span>\r\n                    </div>\r\n                    <div class="x-cell x-al-r">\r\n                        <span class="x-fs-12 x-lh-14 x-fc-l-grey x-di x-di-v-m x-ff-sm xx-none">{{num-format requiredPoints}} {{local \'general.points_lower\'}}</span>\r\n                    </div>\r\n                </div>\r\n            {{/each}}\r\n        {{/if}}\r\n        <span class="mm2-ig-block-btn" data-item="instant">{{local \'rup.view_rewards\'}}</span>\r\n        {{#if IGItems}}\r\n            <p class="mm2-ig-block-caption">\r\n                {{local \'rup.reward_tip\'}}\r\n            </p>\r\n        {{/if}}\r\n    </div>\r\n{{/if}}\r\n\r\n'},{}],228:[function(e,i,a){var t=e("backbone"),r=e("backbone.marionette"),n=e("./01-retrieve/view"),o=e("./02-calendar/view"),s=e("./03-populace/view"),l=e("./03-q-multiple/view"),c=e("./04-discount/view");i.exports=r.LayoutView.extend({template:Handlebars.compile(e("./template.hbs")),regions:{retrieve:"[data-region='retrieve']",calendar:"[data-region='calendar']",populace:"[data-region='populace']",multiple:"[data-region='multiple']",discount:"[data-region='discount']"},ui:{commit:"[data-item='commit']"},events:{"click @ui.commit":function(){this.__updateResults()}},serializeData:function(){return{extendAll:this.model.hasChanged()&&this.__validateData()}},initialize:function(){var e=this,i=e.options.rootState,a=i.getParam();e.model=new t.Model({type:a.type,code:a.code,name:a.name||"",checkin:a.checkin,checkout:a.checkout,maxocc:i.getMaxOCC(),adultocc:i.getAdultOCC(),childocc:i.getChildOCC(),maxroom:i.getMaxRoom(),adults:parseInt(a.adults)||1,children:parseInt(a.children)||0,rooms:parseInt(a.rooms)||1,promocode:a.promocode||"",groupcode:a.groupcode||"",discountcode:a.discountcode||"",AAA:a.AAA||!1,AARP:a.AARP||!1,GOV:a.GOV||!1,Accessible:a.Accessible||!1,isAmerican:a.isAmerican||!1,AccessibleRoom:a.AccessibleRoom||!1}),e.__renderDeferred=jQuery.Deferred(),e.listenTo(e.model,"change",e.showSubmitButton),e.listenTo(i,"rateCalendarClick",e.showSubmitButton),e.listenTo(i,"updateResults",e.updateResults)},onRender:function(){this.__showRetrieveView(),this.__showCalendarView(),this.__showPopulaceView(),this.__showMultipleView(),this.__showDiscountView(),this.__renderDeferred.resolve()},showSubmitButton:function(e){return this.__renderDeferred.then(jQuery.proxy(this.__showSubmitButton,this,e))},updateResults:function(){return this.__renderDeferred.then(jQuery.proxy(this.__updateResults,this))},__showSubmitButton:function(){this.__validateData()&&this.ui.commit.show()},__updateResults:function(){var e=this,i=e.model.toJSON(),a=e.options.rootState;a.isFinal()&&a.trigger("resetQueryParam",i)},__showRetrieveView:function(){this.getRegion("retrieve").show(new n({model:this.model,rootState:this.options.rootState}))},__showCalendarView:function(){this.getRegion("calendar").show(new o({model:this.model,rootState:this.options.rootState}))},__showMultipleView:function(){this.getRegion("multiple").show(new l({model:this.model,rootState:this.options.rootState}))},__showPopulaceView:function(){this.getRegion("populace").show(new s({model:this.model,rootState:this.options.rootState}))},__showDiscountView:function(){this.getRegion("discount").show(new c({model:this.model,rootState:this.options.rootState}))},__validateData:function(){var e=this.model.toJSON();return e.code&&e.type&&e.checkin&&+e.checkin&&e.checkout&&+e.checkout}})},{"./01-retrieve/view":218,"./02-calendar/view":220,"./03-populace/view":222,"./03-q-multiple/view":224,"./04-discount/view":226,"./template.hbs":227,backbone:8,"backbone.marionette":6}],227:[function(e,i,a){i.exports='<div class="x-pt-17 x-pb-13 x-ml-23 x-mr-23" data-region="retrieve"></div>\r\n<div data-region="calendar"></div>\r\n<div class="x-pt-17 x-pb-17 x-ml-23 x-mr-23 x-top-line" data-region="populace"></div>\r\n<div class="x-pt-17 x-pb-17 x-ml-23 x-mr-23 x-top-line" data-region="multiple"></div>\r\n<div class="x-pt-17 x-ml-23 x-mr-23 x-top-line" data-region="discount"></div>\r\n\r\n<div class="x-ml-23 x-mr-23">\r\n    {{#if extendAll}}\r\n        <button class="x-mt-20 x-fs-14 x-ff-mh x-btn x-btn-azure x-full" type="button" data-item="commit">{{local "booking.update_results"}}</button>\r\n    {{else}}\r\n        <button class="x-mt-20 x-fs-14 x-ff-mh x-btn x-btn-azure x-full x-hide" type="button" data-item="commit">{{local "booking.update_results"}}</button>\r\n    {{/if}}\r\n</div>'},{}],226:[function(e,i,a){var t=e("underscore"),r=e("backbone.marionette"),n=!1,o="",s="",l="",c=["change:isAmerican","change:AccessibleRoom"].join(" "),d=["change:code","change:rooms","change:checkin","change:checkout"].join(" "),p=["change:promocode","change:groupcode","change:discountcode","change:AccessibleRoom","change:Accessible"].join(" ");i.exports=r.ItemView.extend({template:Handlebars.compile(e("./template.hbs")),ui:{code_hold:"[data-item='code_hold'],[data-item='format']",code_body:"[data-item='code_body']",format:"[data-item='format']",promo:"[data-item='promo']",promo_right:"[data-item='promo_right']",promo_error:"[data-item='promo_error']",group:"[data-item='group']",group_right:"[data-item='group_right']",group_error:"[data-item='group_error']",disco:"[data-item='disco']",disco_right:"[data-item='disco_right']",disco_error:"[data-item='disco_error']",AAA:"[data-item='AAA']",AARP:"[data-item='AARP']",GOV:"[data-item='GOV']",Accessible:"[data-item='Accessible']",AAA_check:"[data-item='AAA'].x-check",AARP_check:"[data-item='AARP'].x-check",GOV_check:"[data-item='GOV'].x-check",Accessible_check:"[data-item='Accessible'].x-check"},events:{"click @ui.code_hold":function(){(n=!n)?this.__showCodeInput():this.__hideCodeInput()},"click @ui.AAA":function(){var e=!this.model.get("AAA");this.model.set("AAA",e),e?this.ui.AAA_check.addClass("checked"):this.ui.AAA_check.removeClass("checked")},"click @ui.AARP":function(){var e=!this.model.get("AARP");this.model.set("AARP",e),e?this.ui.AARP_check.addClass("checked"):this.ui.AARP_check.removeClass("checked")},"click @ui.GOV":function(){var e=!this.model.get("GOV");this.model.set("GOV",e),e?this.ui.GOV_check.addClass("checked"):this.ui.GOV_check.removeClass("checked")},"click @ui.Accessible":function(){var e=!this.model.get("Accessible");this.model.set("Accessible",e),e?this.ui.Accessible_check.addClass("checked"):this.ui.Accessible_check.removeClass("checked")},"input @ui.promo":function(e){e.originalEvent&&(this.__resetPromoStyle(),this.__changePromoCode(o=(this.ui.promo.val()||"").trim()),this.options.rootState.setFirstValidRes("promocode",null))},"input @ui.group":function(e){e.originalEvent&&(this.__resetGroupStyle(),this.__changeGroupCode(s=(this.ui.group.val()||"").trim()),this.options.rootState.setFirstValidRes("groupcode",null))},"input @ui.disco":function(e){e.originalEvent&&(this.__resetDiscoStyle(),this.__changeDiscoCode(l=(this.ui.disco.val()||"").trim()),this.options.rootState.setFirstValidRes("discountcode",null))}},serializeData:function(){var e=this,i=e.model.toJSON(),a=e.options.rootState.getPromoMsg();return{codeformattext:e.__getCodeFormat(),promocode:o,groupcode:s,discountcode:l,AAA:i.AAA,AARP:i.AARP,GOV:i.GOV,Accessible:i.Accessible,isAmerican:i.isAmerican,AccessibleRoom:i.AccessibleRoom,expandAll:n,promosuccess:a&&a.code&&a.mode,promofailure:a&&a.code&&!a.mode}},initialize:function(){var e=this,i=e.model.toJSON(),a=e.options.rootState;n=!1,o=i.promocode||"",s=i.groupcode||"",l=i.discountcode||"",e.__renderDeferred=jQuery.Deferred(),e.listenTo(a,"revealPromoCode",this.revealPromoCode),e.listenTo(a,"revealGroupCode",this.revealGroupCode),e.listenTo(a,"revealDiscoCode",this.revealDiscoCode),e.listenTo(e.model,c,e.render),e.listenTo(e.model,d,e.__validateAllCode),e.listenTo(e.model,p,e.__updateFormatTxt);var t=a.getFirstValidRes();t.promocode&&(n=!0,o=t.promocode.code,e.revealPromoCode(t.promocode)),t.groupcode&&(n=!0,s=t.groupcode.code,e.revealGroupCode(t.groupcode)),t.discountcode&&(n=!0,l=t.discountcode.code,e.revealDiscoCode(t.discountcode))},onRender:function(){this.__renderDeferred.resolve()},revealPromoCode:function(e){return this.__renderDeferred.then(jQuery.proxy(this.__revealPromoCode,this,e))},revealGroupCode:function(e){return this.__renderDeferred.then(jQuery.proxy(this.__revealGroupCode,this,e))},revealDiscoCode:function(e){return this.__renderDeferred.then(jQuery.proxy(this.__revealDiscoCode,this,e))},__canValidateCode:function(){return"hotel"===this.model.get("type")},__validateAllCode:function(){this.__changePromoCode(o),this.__changeGroupCode(s),this.__changeDiscoCode(l)},__updateFormatTxt:function(){this.ui.format.html(this.__getCodeFormat())},__changePromoCode:function(e){this.__canValidateCode()&&e?this.__triggerValidate("changePromoCode",{promocode:e}):this.model.set("promocode",e)},__changeGroupCode:function(e){this.__canValidateCode()&&e?this.__triggerValidate("changeGroupCode",{groupcode:e}):this.model.set("groupcode",e)},__changeDiscoCode:function(e){this.__canValidateCode()&&e?this.__triggerValidate("changeDiscoCode",{discountcode:e}):this.model.set("discountcode",e)},__revealPromoCode:function(e){this.__resetPromoStyle(),e.code===o&&(e.valid?(this.ui.promo.addClass("x-input-right"),this.ui.promo_right.html(e.message).show(),this.model.set("promocode",e.code)):(n=!0,this.__showCodeInput(),this.ui.promo.addClass("x-input-error"),this.ui.promo_error.html(e.message).show(),this.model.set("promocode","")))},__revealGroupCode:function(e){this.__resetGroupStyle(),e.code===s&&(e.valid?(this.ui.group.addClass("x-input-right"),this.ui.group_right.html(e.message).show(),this.model.set("groupcode",e.code)):(n=!0,this.__showCodeInput(),this.ui.group.addClass("x-input-error"),this.ui.group_error.html(e.message).show(),this.model.set("groupcode","")))},__revealDiscoCode:function(e){this.__resetDiscoStyle(),e.code===l&&(e.valid?(this.ui.disco.addClass("x-input-right"),this.ui.disco_right.html(e.message).show(),this.model.set("discountcode",e.code)):(n=!0,this.__showCodeInput(),this.ui.disco.addClass("x-input-error"),this.ui.disco_error.html(e.message).show(),this.model.set("discountcode","")))},__resetPromoStyle:function(){this.ui.promo.removeClass("x-input-right"),this.ui.promo.removeClass("x-input-error"),this.ui.promo_right.hide(),this.ui.promo_error.hide()},__resetGroupStyle:function(){this.ui.group.removeClass("x-input-right"),this.ui.group.removeClass("x-input-error"),this.ui.group_right.hide(),this.ui.group_error.hide()},__resetDiscoStyle:function(){this.ui.disco.removeClass("x-input-right"),this.ui.disco.removeClass("x-input-error"),this.ui.disco_right.hide(),this.ui.disco_error.hide()},__triggerValidate:function(e,i){this.options.rootState.trigger(e,t.assign({},this.model.toJSON(),i))},__getCodeFormat:function(){var e=this.model.toJSON(),i=[];return e.promocode&&i.push(e.promocode.toUpperCase()),e.groupcode&&i.push(e.groupcode.toUpperCase()),e.discountcode&&i.push(e.discountcode.toUpperCase()),i.join(", ")},__showCodeInput:function(){this.ui.code_body.show()},__hideCodeInput:function(){this.ui.code_body.hide()}})},{"./template.hbs":225,"backbone.marionette":6,underscore:42}],225:[function(e,i,a){i.exports='<div class="x-flex x-fs-00 x-pointer" data-item="code_hold">\r\n    <div class="x-cell x-al-l">\r\n        <span class="x-fs-16 x-fc-azure x-di x-di-v-m icon-icon_P006"></span>\r\n        <span class="x-fs-14 x-fc-azure x-di x-di-v-m x-ml-08 x-upper x-ff-mh x-none">{{local "quickbook.codes_options"}}</span>\r\n    </div>\r\n    <div class="x-cell x-al-r">\r\n        <span class="x-fs-00 x-nowrap x-pointer">\r\n            <span class="x-fs-12 x-fc-azure x-di x-di-v-m icon-icon_J006"></span>\r\n            <span class="x-fs-12 x-fc-azure x-di x-di-v-m x-ff-wm x-none x-ml-04 x-under">{{local "checkout.edit"}}</span>\r\n        </span>\r\n    </div>\r\n</div>\r\n\r\n<div class="x-pt-05 x-fs-12 x-ff-wm x-fc-black x-pointer" data-item="format" style="text-indent: 24px">\r\n    {{{codeformattext}}}\r\n</div>\r\n\r\n{{#if promofailure}}\r\n    <div class="m4b-b2-article-item-desc right">\r\n        <span class="icon icon-icon_I009"></span>\r\n        <span class="text">{{ local "m4b.promo_apply_success" }}</span>\r\n    </div>\r\n{{/if}}\r\n{{#if promosuccess}}\r\n    <div class="m4b-b2-article-item-desc error">\r\n        <span class="icon">i</span>\r\n        <span class="text">{{ local "m4b.promo_apply_failure" }}</span>\r\n    </div>\r\n{{/if}}\r\n\r\n<div class="x-hide" data-item="code_body" {{#if expandAll}}style="display: block"{{/if}}>\r\n    <div class="x-mt-10">\r\n        <div class="x-fs-00 x-nowrap">\r\n            <label class="x-fs-15 x-di x-di-v-m x-water" {{#unless promocode}}style="display: inline-block"{{/unless}}>\r\n                <span class="x-ml-18">{{local "booking.add_a_promo_code"}}</span>\r\n            </label>\r\n            <input class="x-fs-15 x-di x-di-v-m x-pt-08 x-pb-08 x-input x-upper x-pl-17 x-pr-36 x-full" data-item="promo" value="{{promocode}}">\r\n            <label class="x-fs-22 x-di x-di-v-m x-stamp">\r\n                <span class="x-mr-08 x-fc-white x-bc-green x-valid-right icon-icon_I009"></span>\r\n                <span class="x-mr-08 x-fc-white x-bc-peach x-valid-error icon-icon_I010"></span>\r\n            </label>\r\n        </div>\r\n        <div class="x-fs-12 x-mt-04 x-fc-green x-hide" data-item="promo_right">{{local "booking.promocode_valid"}}</div>\r\n        <div class="x-fs-12 x-mt-04 x-fc-peach x-hide" data-item="promo_error">{{local "booking.promocode_invalid"}}</div>\r\n    </div>\r\n    <div class="x-mt-10">\r\n        <div class="x-fs-00 x-nowrap">\r\n            <label class="x-fs-15 x-di x-di-v-m x-water" {{#unless groupcode}}style="display: inline-block"{{/unless}}>\r\n                <span class="x-ml-18">{{local "booking.enter_a_group_code"}}</span>\r\n            </label>\r\n            <input class="x-fs-15 x-di x-di-v-m x-pt-08 x-pb-08 x-input x-upper x-pl-17 x-pr-36 x-full" data-item="group" value="{{groupcode}}">\r\n            <label class="x-fs-22 x-di x-di-v-m x-stamp">\r\n                <span class="x-mr-08 x-fc-white x-bc-green x-valid-right icon-icon_I009"></span>\r\n                <span class="x-mr-08 x-fc-white x-bc-peach x-valid-error icon-icon_I010"></span>\r\n            </label>\r\n        </div>\r\n        <div class="x-fs-12 x-mt-04 x-fc-green x-hide" data-item="group_right">{{local "booking.groupcode_valid"}}</div>\r\n        <div class="x-fs-12 x-mt-04 x-fc-peach x-hide" data-item="group_error">{{local "booking.groupcode_invalid"}}</div>\r\n    </div>\r\n    <div class="x-mt-10">\r\n        <div class="x-fs-00 x-nowrap">\r\n            <label class="x-fs-15 x-di x-di-v-m x-water" {{#unless discountcode}}style="display: inline-block"{{/unless}}>\r\n                <span class="x-ml-18">{{local "booking.add_a_discount_code"}}</span>\r\n            </label>\r\n            <input class="x-fs-15 x-di x-di-v-m x-pt-08 x-pb-08 x-input x-upper x-pl-17 x-pr-36 x-full" data-item="disco" value="{{discountcode}}">\r\n            <label class="x-fs-22 x-di x-di-v-m x-stamp">\r\n                <span class="x-mr-08 x-fc-white x-bc-green x-valid-right icon-icon_I009"></span>\r\n                <span class="x-mr-08 x-fc-white x-bc-peach x-valid-error icon-icon_I010"></span>\r\n            </label>\r\n        </div>\r\n        <div class="x-fs-12 x-mt-04 x-fc-green x-hide" data-item="disco_right">{{local "booking.discount_code_valid"}}</div>\r\n        <div class="x-fs-12 x-mt-04 x-fc-peach x-hide" data-item="disco_error">{{local "booking.discount_code_invalid"}}</div>\r\n    </div>\r\n    <div class="x-fs-00">\r\n        {{#if isAmerican}}\r\n            <div class="book2-inquire-options x-mt-10">\r\n                {{#if AAA}}\r\n                    <span class="x-fs-16 x-di-v-m x-check x-check-sm x-pointer checked" data-item="AAA"></span>\r\n                {{else}}\r\n                    <span class="x-fs-16 x-di-v-m x-check x-check-sm x-pointer" data-item="AAA"></span>\r\n                {{/if}}\r\n                <span class="x-fs-12 x-di-v-m x-ml-04 x-none x-pointer" data-item="AAA">{{local "booking.AAA_CAA"}}</span>\r\n            </div>\r\n            <div class="book2-inquire-options x-mt-10">\r\n                {{#if AARP}}\r\n                    <span class="x-fs-16 x-di-v-m x-check x-check-sm x-pointer checked" data-item="AARP"></span>\r\n                {{else}}\r\n                    <span class="x-fs-16 x-di-v-m x-check x-check-sm x-pointer" data-item="AARP"></span>\r\n                {{/if}}\r\n                <span class="x-fs-12 x-di-v-m x-ml-04 x-none x-pointer" data-item="AARP">{{local "booking.Senior_AARP"}}</span>\r\n            </div>\r\n            <div class="book2-inquire-options x-mt-10">\r\n                {{#if GOV}}\r\n                    <span class="x-fs-16 x-di-v-m x-check x-check-sm x-pointer checked" data-item="GOV"></span>\r\n                {{else}}\r\n                    <span class="x-fs-16 x-di-v-m x-check x-check-sm x-pointer" data-item="GOV"></span>\r\n                {{/if}}\r\n                <span class="x-fs-12 x-di-v-m x-ml-04 x-none x-pointer" data-item="GOV">{{local "booking.Government"}}</span>\r\n            </div>\r\n        {{/if}}\r\n    </div>\r\n</div>\r\n\r\n{{#if AccessibleRoom}}\r\n    <div class="x-fs-00 x-mt-16">\r\n        <div>\r\n            {{#if Accessible}}\r\n                <span class="x-fs-16 x-di-v-m x-check x-check-sm x-pointer checked" data-item="Accessible"></span>\r\n            {{else}}\r\n                <span class="x-fs-16 x-di-v-m x-check x-check-sm x-pointer" data-item="Accessible"></span>\r\n            {{/if}}\r\n            <span class="x-fs-14 x-di-v-m x-ml-08 x-none x-ff-mm x-fc-azure x-pointer" data-item="Accessible">{{local "booking.show_accessible_rooms"}}</span>\r\n        </div>\r\n    </div>\r\n{{/if}}'},{}],224:[function(e,i,a){var t=e("backbone.marionette"),r=e("../../../common/count"),n=!1,o=["change:maxroom"].join(" "),s=["change:rooms"].join(" ");i.exports=t.ItemView.extend({template:Handlebars.compile(e("./template.hbs")),ui:{code_hold:"[data-item='code_hold'],[data-item='format']",code_body:"[data-item='code_body']",format:"[data-item='format']",rooms:"[data-item='rooms']"},events:{"click @ui.code_hold":function(){(n=!n)?this.__showCodeInput():this.__hideCodeInput()}},initialize:function(){var e=this;e.listenTo(e.model,o,e.render),e.listenTo(e.model,s,e.__changeFormatText),n=!!e.options.rootState.getErrorMessage()},serializeData:function(){var e=this,i=e.options.rootState,a=e.model.toJSON(),t=Math.min(a.maxroom,a.rooms||1);return{codeformattext:t+" "+i18n.t(1>=t?"booking.room":"booking.rooms"),expandAll:n,errormessage:t>1&&i.getErrorMessage(),isHotel:!i.isStyle(i.VIEW_STYLES.VILLE_BY_CITY)&&!i.isStyle(i.VIEW_STYLES.VILLE_BY_MAPS),maxroom:a.maxroom}},onRender:function(){this.__addRoomsCount()},__showCodeInput:function(){this.ui.code_body.show()},__hideCodeInput:function(){this.ui.code_body.hide()},__addRoomsCount:function(){var e=this.model.get("maxroom"),i=this.model.get("rooms");i>e&&this.model.set("rooms",i=e),r.autoCreate(this.ui.rooms,{minValue:1,maxValue:e,value:i,change:jQuery.proxy(this.__onChangeRooms,this),single:!1})},__onChangeRooms:function(e){this.model.set("rooms",e)},__changeFormatText:function(){this.ui.format.html(this.serializeData().codeformattext)}})},{"../../../common/count":345,"./template.hbs":223,"backbone.marionette":6}],223:[function(e,i,a){i.exports='<div class="x-flex x-fs-00 x-pointer" data-item="code_hold">\r\n    <div class="x-cell x-al-l">\r\n        <span class="x-fs-16 x-fc-azure x-di-v-m icon-icon_J007"></span>\r\n        {{#if isHotel}}\r\n            <span class="x-fs-14 x-fc-azure x-di-v-m x-ml-08 x-upper x-ff-mh x-none">{{local "booking.multiple"}}({{local "booking.maxroom" maxroom }})</span>\r\n        {{else}}\r\n            <span class="x-fs-14 x-fc-azure x-di-v-m x-ml-08 x-upper x-ff-mh x-none">{{local "booking.multiple"}}</span>\r\n        {{/if}}\r\n    </div>\r\n    <div class="x-cell x-al-r">\r\n        <span class="x-fs-00 x-nowrap x-pointer">\r\n            <span class="x-fs-12 x-fc-azure x-di x-di-v-m icon-icon_J006"></span>\r\n            <span class="x-fs-12 x-fc-azure x-di x-di-v-m x-ff-wm x-none x-ml-04 x-under">{{local "checkout.edit"}}</span>\r\n        </span>\r\n    </div>\r\n</div>\r\n\r\n<div class="x-pt-05 x-fs-15 x-ff-sm x-fc-black x-pointer" data-item="format" style="text-indent: 24px">\r\n    {{{codeformattext}}}\r\n</div>\r\n\r\n<div class="x-hide" data-item="code_body" {{#if expandAll}}style="display: block"{{/if}}>\r\n    <div class="x-mt-10 x-ml-23">\r\n        <span class="x-di x-di-v-m" data-item="rooms"></span>\r\n    </div>\r\n    {{#if errormessage}}\r\n        <div class="x-mt-20 x-ml-23 x-ff-sm x-fc-peach" style="font-weight: bold; font-size: 14px;">\r\n            {{{ errormessage }}}\r\n        </div>\r\n    {{/if}}\r\n</div>'},{}],222:[function(e,i,a){var t=e("backbone.marionette"),r=e("../../../common/count"),n=!1,o=["change:maxocc","change:adultocc","change:childocc"].join(" "),s=["change:adults","change:children"].join(" ");
i.exports=t.ItemView.extend({template:Handlebars.compile(e("./template.hbs")),ui:{code_hold:"[data-item='code_hold'],[data-item='format']",code_body:"[data-item='code_body']",format:"[data-item='format']",adult:"[data-item='adult']",child:"[data-item='child']",below:"[data-item='below']"},events:{"click @ui.code_hold":function(){(n=!n)?this.__showCodeInput():this.__hideCodeInput()},"mouseenter @ui.below":function(e){e.stopPropagation()}},serializeData:function(){var e=this,i="",a=e.model.toJSON(),t=e.options.rootState,r=a.adults||1,o=a.children||0;return i+=r+" "+i18n.t(1>=r?"booking.adult":"booking.adults"),i+=", ",i+=o+" "+i18n.t(1>=o?"booking.child":"booking.children"),{codeformattext:i,maxchildage:t.getMaxChildAge()||11,expandAll:n,childmessage:t.getChildMessage()||"",childmessagetitle:t.getChildMessageTitle()||""}},initialize:function(){var e=this;e.listenTo(e.model,o,e.render),e.listenTo(e.model,s,e.__changeFormatText)},onRender:function(){var e=this.__getOccupancy();this.__addAdultCount(e),this.__addChildCount(e)},__addAdultCount:function(e){r.autoCreate(this.ui.adult,{minValue:1,maxValue:e.adultocc,value:e.adults,change:jQuery.proxy(this.__onChangeAdult,this),single:!1})},__addChildCount:function(e){r.autoCreate(this.ui.child,{minValue:0,maxValue:e.childocc,value:e.children,change:jQuery.proxy(this.__onChangeChild,this),single:!1})},__onChangeAdult:function(e){var i=this,a=i.__getOccupancy();a.childocc=Math.min(a.childocc,a.maxocc-e),a.children=Math.min(a.children,a.childocc),i.model.set("adults",e),i.__addChildCount(a)},__onChangeChild:function(e){var i=this,a=i.__getOccupancy();a.adultocc=Math.min(a.adultocc,a.maxocc-e),a.adults=Math.min(a.adults,a.adultocc),i.model.set("children",e),i.__addAdultCount(a)},__getOccupancy:function(){var e=this,i=e.model.toJSON(),a=Math.max(i.maxocc,1),t=Math.max(1,Math.min(a,i.adultocc)),r=Math.max(0,Math.min(a-1,i.childocc)),n=i.adults||1,o=i.children||0;return{maxocc:a,adultocc:t,childocc:r,adults:n,children:o}},__showCodeInput:function(){this.ui.code_body.show()},__hideCodeInput:function(){this.ui.code_body.hide()},__changeFormatText:function(){this.ui.format.html(this.serializeData().codeformattext)}})},{"../../../common/count":345,"./template.hbs":221,"backbone.marionette":6}],221:[function(e,i,a){i.exports='<div class="x-flex x-fs-00 x-pointer" data-item="code_hold">\r\n    <div class="x-cell x-al-l">\r\n        <span class="x-fs-16 x-fc-azure x-di-v-m icon-icon_J007"></span>\r\n        <span class="x-fs-14 x-fc-azure x-di-v-m x-ml-08 x-upper x-ff-mh x-none">{{local "booking.guests_per_room"}}</span>\r\n    </div>\r\n    <div class="x-cell x-al-r">\r\n        <span class="x-fs-00 x-nowrap x-pointer">\r\n            <span class="x-fs-12 x-fc-azure x-di x-di-v-m icon-icon_J006"></span>\r\n            <span class="x-fs-12 x-fc-azure x-di x-di-v-m x-ff-wm x-none x-ml-04 x-under">{{local "checkout.edit"}}</span>\r\n        </span>\r\n    </div>\r\n</div>\r\n\r\n<div class="x-pt-05 x-fs-15 x-ff-sm x-fc-black x-pointer" data-item="format" style="text-indent: 24px">\r\n    {{{codeformattext}}}\r\n</div>\r\n\r\n<div class="x-hide" data-item="code_body" {{#if expandAll}}style="display: block"{{/if}}>\r\n    <div class="x-mt-10">\r\n        <span class="x-di x-di-v-m" style="width: 127px">\r\n            <div class="x-fs-15 x-ff-sm x-fc-black" style="text-indent: 24px">{{local "booking.adults"}}</div>\r\n        </span>\r\n        <span class="x-di x-di-v-m" data-item="adult"></span>\r\n    </div>\r\n    <div class="x-mt-10">\r\n        <span class="x-di x-di-v-m" style="width: 127px">\r\n            <div class="x-fs-15 x-ff-sm x-fc-black" style="display: inline-block;text-indent: 24px">{{local "booking.children"}}</div>\r\n            {{#if childmessage}}\r\n                <span class="x-di x-di-v-m x-fs-16 x-ml-06 x-default x-popup icon-icon_B008 down" data-item="below">\r\n                <div class="x-popup-wrap x-fs-00">\r\n                    <div class="x-popup-body x-fs-16 x-ff-sm" style="padding: 6px 10px;width: 17rem">\r\n                        <span class="x-fs-20 x-mt-04 x-pb-08  x-db">{{childmessagetitle}}</span>\r\n                        <span class="x-fs-15 x-pb-10 x-db x-lh-20" style="opacity: .7">{{childmessage}}</span>\r\n                    </div>\r\n                </div>\r\n            </span>\r\n            {{/if}}\r\n            <div class="x-fs-12 x-ff-sm x-fc-black" style="text-indent: 24px">{{local "booking.below_12" maxchildage }}</div>\r\n        </span>\r\n        <span class="x-di x-di-v-m" data-item="child"></span>\r\n    </div>\r\n</div>'},{}],218:[function(e,i,a){var t=(e("underscore"),e("backbone")),r=e("backbone.marionette"),n=e("./container/view"),o=e("../../../common/scroll"),s=["change:type","change:code","change:name","change:isAmerican","change:AccessibleRoom"].join(" ");i.exports=r.LayoutView.extend({template:Handlebars.compile(e("./template.hbs")),regions:{list:"[data-region='list']"},ui:{word:"[data-item='word']",edit:"[data-item='code_hold']"},events:{"focus @ui.word":function(){this.ui.word.val(""),this.ui.word.trigger("input"),this.__hideQueryListView()},"input @ui.word":function(e){if(e.originalEvent){var i=this,a=i.options.rootState,t=(i.ui.word.val()||"").trim();t.length>=2?a.trigger("changeSearchKey",t):this.__hideQueryListView()}},"enter @ui.word":function(){this.getRegion("list").hasView()&&this.getRegion("list").currentView.setCurrentItem()},"arrowup   @ui.word":function(){this.getRegion("list").hasView()&&this.getRegion("list").currentView.selectPrevItem()},"arrowdown @ui.word":function(){this.getRegion("list").hasView()&&this.getRegion("list").currentView.selectNextItem()},"click @ui.edit":function(e){e.stopPropagation(),this.__lockInput=!1,this.render(),this.ui.word.focus()}},serializeData:function(){var e=this,i=e.options.rootState,a=e.model.toJSON();return{type:a.type,name:a.name,lock:e.__lockInput,edit:"hotel"===a.type?i.getHotel().showdestinationeditbuttonfornewbookingflow:!0}},initialize:function(){var e=this,i=e.options.rootState;e.__lockInput=!0,e.__renderDeferred=jQuery.Deferred(),e.__globalEventHwd=jQuery.proxy(this.__globalEventHandle,this),e.listenTo(i,"expandQueryView",e.expandQueryView),e.listenTo(e.model,s,function(){e.__lockInput=!0,e.render()}),o.autoCreate(this)},onRender:function(){this.__renderDeferred.resolve()},onDestroy:function(){this.__detachGlobalEvent()},onBeforeRender:function(){this.__detachGlobalEvent()},expandQueryView:function(e){return this.__renderDeferred.then(jQuery.proxy(this.__expandQueryView,this,e))},__expandQueryView:function(e){this.__showQueryListView(e)},__showQueryListView:function(e){this.__attachGlobalEvent(),this.getRegion("list").show(new n({model:this.model,collection:new t.Collection(e)}))},__hideQueryListView:function(){this.__detachGlobalEvent(),this.getRegion("list").empty()},__attachGlobalEvent:function(){this.__detachGlobalEvent(),jQuery(document).on("click",this.__globalEventHwd)},__detachGlobalEvent:function(){jQuery(document).off("click",this.__globalEventHwd)},__globalEventHandle:function(e){0===this.$el.has(e.target).length&&(this.__detachGlobalEvent(),this.__lockInput=!0,this.render())}})},{"../../../common/scroll":349,"./container/view":216,"./template.hbs":217,backbone:8,"backbone.marionette":6,underscore:42}],217:[function(e,i,a){i.exports='<div class="x-flex x-fs-00">\r\n    <div class="x-cell x-al-l">\r\n        {{#equal type "hotel"}}\r\n            <span class="x-fs-16 x-fc-azure x-di x-di-v-m icon-icon_N010"></span>\r\n            <span class="x-fs-14 x-fc-azure x-di x-di-v-m x-ml-08 x-ff-mh x-upper">{{local "general.hotel"}}</span>\r\n        {{else}}\r\n            <span class="x-fs-16 x-fc-azure x-di x-di-v-m icon-icon_F0272"></span>\r\n            <span class="x-fs-14 x-fc-azure x-di x-di-v-m x-ml-08 x-ff-mh x-upper">{{local "booking.destination"}}</span>\r\n        {{/equal}}\r\n    </div>\r\n    <div class="x-cell x-al-r">\r\n        {{#if edit}}\r\n            <span class="x-fs-00 x-nowrap x-pointer" data-item="code_hold">\r\n            <span class="x-fs-12 x-fc-azure x-di x-di-v-m icon-icon_J006"></span>\r\n            <span class="x-fs-12 x-fc-azure x-di x-di-v-m x-ff-wm x-none x-ml-04 x-under">{{local "checkout.edit"}}</span>\r\n        </span>\r\n        {{/if}}\r\n    </div>\r\n</div>\r\n\r\n<div class="x-mt-04">\r\n    <div class="x-fs-00 x-nowrap">\r\n        {{#if name}}\r\n            <label class="x-fs-15 x-di x-di-v-m x-water">\r\n                <span>{{local "booking.where_go_to"}}</span>\r\n            </label>\r\n            {{#if lock}}\r\n                <div class="x-fs-16 x-ff-sm x-pt-10 x-pb-05 x-lh-14 x-normal x-ff-sm x-full">{{name}}</div>\r\n            {{else}}\r\n                {{#equal type "hotel"}}\r\n                    <input class="x-fs-15 x-ff-sm x-di x-di-v-m x-pt-05 x-pb-05 x-input x-input-blank x-ff-sm x-full" type="text" value="{{name}}" data-item="word">\r\n                {{else}}\r\n                    <input class="x-fs-15 x-ff-sm x-di x-di-v-m x-pt-05 x-pb-05 x-input x-input-blank x-ff-sm x-full" type="text" value="{{local "booking.hotelsincity" name}}" data-item="word">\r\n                {{/equal}}\r\n            {{/if}}\r\n        {{else}}\r\n            <label class="x-fs-15 x-di x-di-v-m x-water" style="display: inline-block">\r\n                <span>{{local "booking.where_go_to"}}</span>\r\n            </label>\r\n            <input class="x-fs-15 x-di x-di-v-m x-pt-05 x-pb-05 x-input x-input-blank x-ff-sm x-full" type="text" data-item="word">\r\n        {{/if}}\r\n    </div>\r\n</div>\r\n\r\n<div class="x-level">\r\n    <div class="x-scroll">\r\n        <div class="x-scroll-body">\r\n            <div data-region="list" class="x-list-scroll"></div>\r\n        </div>\r\n    </div>\r\n    <div class="x-runner">\r\n        <div class="x-slider"></div>\r\n    </div>\r\n</div>\r\n\r\n'},{}],216:[function(e,i,a){var t=e("backbone.marionette"),r=e("./child/view"),n=e("./empty/view");i.exports=t.CollectionView.extend({childView:r,emptyView:n,childEvents:{selectItemValue:function(e,i){this.__setQueryValues(i)},toggleItemStyle:function(e,i){this.children.forEach(function(a,t){a===e&&(this.__selectionIndex=t),a.toggleItemStyle(i)},this)}},initialize:function(){this.__selectionIndex=-1,this.__renderDeferred=jQuery.Deferred()},onRender:function(){this.__renderDeferred.resolve()},setCurrentItem:function(){-1!==this.__selectionIndex&&this.__setQueryValues(this.collection.at(this.__selectionIndex).toJSON())},selectPrevItem:function(e){return this.__renderDeferred.then(jQuery.proxy(this.__selectPrevItem,this,e))},selectNextItem:function(e){return this.__renderDeferred.then(jQuery.proxy(this.__selectNextItem,this,e))},__selectPrevItem:function(){var e=this.__selectionIndex,i=this.collection.length;i&&(--e<=-1&&(e=i-1),this.__selectionIndex=e,this.__toggleChildren(this.collection.at(e).toJSON()))},__selectNextItem:function(){var e=this.__selectionIndex,i=this.collection.length;i&&(++e>=i&&(e=0),this.__selectionIndex=e,this.__toggleChildren(this.collection.at(e).toJSON()))},__toggleChildren:function(e){this.children.forEach(function(i){i.toggleItemStyle(e)})},__setQueryValues:function(e){this.model.set({type:e.type,code:e.code,name:e.name,maxocc:e.maxocc,adultocc:e.adultocc,childocc:e.childocc,maxroom:e.maxselectroomscount||9,isAmerican:e.isAmerican,AccessibleRoom:e.accessibleroom},{silent:!0}),this.model.trigger("change change:type change:code change:name change:maxocc change:adultocc change:childocc change:isAmerican change:AccessibleRoom")}})},{"./child/view":213,"./empty/view":215,"backbone.marionette":6}],215:[function(e,i,a){var t=e("backbone.marionette");i.exports=t.ItemView.extend({template:Handlebars.compile(e("./template.hbs"))})},{"./template.hbs":214,"backbone.marionette":6}],214:[function(e,i,a){i.exports='<div class="book2-inquire-listing x-fs-14 x-lh-24 x-fc-black">{{local "booking.search_no_matches"}}</div>'},{}],213:[function(e,i,a){var t=e("backbone.marionette");i.exports=t.ItemView.extend({template:Handlebars.compile(e("./template.hbs")),ui:{item:".book2-inquire-listing"},events:{"click     @ui.item":function(e){e.stopPropagation(),this.trigger("selectItemValue",this.model.toJSON())},"mouseenter @ui.item":function(e){e.stopPropagation(),this.trigger("toggleItemStyle",this.model.toJSON())}},initialize:function(){this.__renderDeferred=jQuery.Deferred()},onRender:function(){this.__renderDeferred.resolve()},toggleItemStyle:function(e){return this.__renderDeferred.then(jQuery.proxy(this.__toggleItemStyle,this,e))},__toggleItemStyle:function(e){this.model.get("type")===e.type&&this.model.get("code")===e.code?this.__holdHighlight():this.__freeHighlight()},__holdHighlight:function(){this.ui.item.addClass("holds")},__freeHighlight:function(){this.ui.item.removeClass("holds")}})},{"./template.hbs":212,"backbone.marionette":6}],212:[function(e,i,a){i.exports='<div class="book2-inquire-listing x-fs-14 x-lh-24 x-pointer x-fc-black">{{name}}</div>'},{}]},{},[2169]);